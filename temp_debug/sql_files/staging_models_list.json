[
  {
    "node_id": "model.anthem_dev.stg_attribution",
    "name": "stg_attribution",
    "original_file_path": "models\\staging\\stg_attribution.sql",
    "compiled_code": "\n\nWITH active_attributions AS (\nSELECT\n\tmemberid,\n\tcancerdiagnosisgroupcode,\n\tcancertype,\n\tmemberkey,\n\ticsiteid,\n\tfileprocesseddatetime,\n\tattributedproviderid,\n\tattributednpiproviderid,\n\tattributedproviderfirstname,\n\tattributedproviderlastname,\n\tattributedproviderorganizationname,\n\tattributedproviderstreet1address,\n\tattributedproviderstreet2address,\n\tattributedprovidercityaddress,\n\tattributedproviderstateaddress,\n\tattributedproviderzipcodeaddress,\n\tattributionperiodbegindate,\n\tattributionperiodenddate,\n\tattributedprovidertaxid,\n\tproviderentityname,\n\tprogramidentifier,\n\tattributionrecordtype,\n\tperf_period_key,\n\tmemberageonattributedmonth,\n\tcustomcancercode,\n\tprincipalcancercode,\n\tlineofbusiness\nFROM dev_dtx_gc.staging.stg_attribution_all\nWHERE attributionrecordtype = 'ACT'\n)\n\nSELECT\n\tsa.*,\n\thm.ishospicemember,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tCONCAT(sa.memberid, '_', sa.attributedprovidertaxid)\n\t\tAS memberid_attributedtin,\n\tCONCAT(\n\t\tCOALESCE(sa.attributednpiproviderid, ''),\n\t\t'_',\n\t\tsa.attributedprovidertaxid\n\t) AS participatingnpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM active_attributions AS sa\n\tLEFT JOIN\n\t\tdev_dtx_gc.staging.stg_member_hospice_mapping AS hm\n\t\tON sa.memberid = hm.memberid AND sa.perf_period_key = hm.perf_period_key AND sa.lineofbusiness = hm.lineofbusiness\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON sa.attributedprovidertaxid = map.tin",
    "raw_code": "{{ config( alias = 'stg_attribution', schema = 'staging') }}\r\n\r\nWITH active_attributions AS (\r\nSELECT\r\n\tmemberid,\r\n\tcancerdiagnosisgroupcode,\r\n\tcancertype,\r\n\tmemberkey,\r\n\ticsiteid,\r\n\tfileprocesseddatetime,\r\n\tattributedproviderid,\r\n\tattributednpiproviderid,\r\n\tattributedproviderfirstname,\r\n\tattributedproviderlastname,\r\n\tattributedproviderorganizationname,\r\n\tattributedproviderstreet1address,\r\n\tattributedproviderstreet2address,\r\n\tattributedprovidercityaddress,\r\n\tattributedproviderstateaddress,\r\n\tattributedproviderzipcodeaddress,\r\n\tattributionperiodbegindate,\r\n\tattributionperiodenddate,\r\n\tattributedprovidertaxid,\r\n\tproviderentityname,\r\n\tprogramidentifier,\r\n\tattributionrecordtype,\r\n\tperf_period_key,\r\n\tmemberageonattributedmonth,\r\n\tcustomcancercode,\r\n\tprincipalcancercode,\r\n\tlineofbusiness\r\nFROM {{ ref('stg_attribution_all') }}\r\nWHERE attributionrecordtype = 'ACT'\r\n)\r\n\r\nSELECT\r\n\tsa.*,\r\n\thm.ishospicemember,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tCONCAT(sa.memberid, '_', sa.attributedprovidertaxid)\r\n\t\tAS memberid_attributedtin,\r\n\tCONCAT(\r\n\t\tCOALESCE(sa.attributednpiproviderid, ''),\r\n\t\t'_',\r\n\t\tsa.attributedprovidertaxid\r\n\t) AS participatingnpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM active_attributions AS sa\r\n\tLEFT JOIN\r\n\t\t{{ ref('stg_member_hospice_mapping') }} AS hm\r\n\t\tON sa.memberid = hm.memberid AND sa.perf_period_key = hm.perf_period_key AND sa.lineofbusiness = hm.lineofbusiness\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON sa.attributedprovidertaxid = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_attribution",
    "description": "All Attributed member details",
    "columns": {
      "FILEPROCESSEDDATETIME": {
        "name": "FILEPROCESSEDDATETIME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTEDNPIPROVIDERID": {
        "name": "ATTRIBUTEDNPIPROVIDERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTEDPROVIDERTAXID": {
        "name": "ATTRIBUTEDPROVIDERTAXID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTIONRECORDTYPE": {
        "name": "ATTRIBUTIONRECORDTYPE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LINEOFBUSINESS": {
        "name": "LINEOFBUSINESS",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ISHOSPICEMEMBER": {
        "name": "ISHOSPICEMEMBER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_attribution_all",
        "model.anthem_dev.stg_member_hospice_mapping",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_attribution_all",
    "name": "stg_attribution_all",
    "original_file_path": "models\\staging\\stg_attribution_all.sql",
    "compiled_code": "\n\n/**********************************************************************************************************\n\nIC-14282 | recentmemberdata is configured to fetch only one record per month regardless of attribution start date in a month | Selva\n\n**********************************************************************************************************/\n\nWITH latestrecordmember0 AS (\n\tSELECT DISTINCT\n\t\tmemberid,\n\t\tmemberkey,\n\t\ticsiteid,\n\t\tfileprocesseddatetime,\n\t\tattributedproviderid,\n\t\tattributednpiproviderid,\n\t\tattributedproviderfirstname,\n\t\tattributedproviderlastname,\n\t\tattributedproviderorganizationname,\n\t\tattributedproviderstreet1address,\n\t\tattributedproviderstreet2address,\n\t\tattributedprovidercityaddress,\n\t\tattributedproviderstateaddress,\n\t\tattributedproviderzipcodeaddress,\n\t\tattributedprovidertaxid,\n\t\tproviderentityname,\n\t\tprogramidentifier,\n\t\tattributionrecordtype,\n\t\tDATE_TRUNC(MONTH, attributionperiodbegindate)\n\t\t\tAS attributionperiodbegindate,\n\t\t-- This is used to identify the status of member\n\t\tLAST_DAY(attributionperiodenddate, MONTH) AS attributionperiodenddate,\n\t\tUPPER(lineofbusinessidentifier) AS lineofbusiness,\n\t\tROW_NUMBER()\n\t\t\tOVER (\n\t\t\t\tPARTITION BY\n\t\t\t\t\tmemberid, DATE_TRUNC(MONTH, attributionperiodbegindate)\n\t\t\t\tORDER BY\n\t\t\t\t\tfileprocesseddatetime ASC, attributionperiodenddate DESC\n\t\t\t)\n\t\t\tAS recentmemberdata\n\tFROM dev_dtx_gc.IC1.ATTRIBUTION\n),\n\nlatestrecordmember AS (\n\tSELECT * FROM latestrecordmember0\n\tWHERE recentmemberdata = 1\n),\n\nmember_cancer_info AS (\n\tSELECT\n\t\ta.memberid,\n\t\tCOALESCE(ct.icd10code, 'ZZZZZ') AS cancerdiagnosisgroupcode,\n\t\tCOALESCE(ct.cancer_type, 'Unknown') AS cancertype,\n\t\tCOALESCE(ct.icd10code, cl.claimlineprincipaldiagnosiscode, 'Unknown')\n\t\t\tAS customcancercode,\n\t\tCOALESCE(cl.claimlineprincipaldiagnosiscode, 'Unknown')\n\t\t\tAS principalcancercode,\n\t\tCASE\n\t\t\tWHEN ct.cancer_type IS NULL THEN 1 WHEN\n\t\t\t\tct.cancer_type LIKE 'Secondary%'\n\t\t\t\tTHEN 2\n\t\t\tWHEN ct.cancer_type LIKE '%other%' THEN 3 ELSE 4\n\t\tEND AS cancerorder,\n\t\tROW_NUMBER()\n\t\t\tOVER (\n\t\t\t\tPARTITION BY a.memberid\n\t\t\t\tORDER BY cancerorder DESC, cl.claimlineservicestartdate ASC\n\t\t\t)\n\t\t\tAS cancerorder_rn\n\tFROM latestrecordmember AS a\n\t\tLEFT JOIN dev_dtx_gc.IC1.CLAIM AS c\n\t\t\tON a.memberid = c.memberid\n\t\tLEFT JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\t\tON c.claimid = cl.claimid AND cl.claimlinestatuscode = 'APRVD'\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_seed_ocm_cancer_types AS ct\n\t\t\tON cl.claimlineprincipaldiagnosiscode LIKE (ct.icd10code || '%')\n)\n\nSELECT DISTINCT\n\ta.memberid,\n\tc.cancerdiagnosisgroupcode,\n\tc.cancertype,\n\ta.memberkey,\n\ta.icsiteid,\n\ta.fileprocesseddatetime,\n\ta.attributedproviderid,\n\ta.attributednpiproviderid,\n\ta.attributedproviderfirstname,\n\ta.attributedproviderlastname,\n\ta.attributedproviderorganizationname,\n\ta.attributedproviderstreet1address,\n\ta.attributedproviderstreet2address,\n\ta.attributedprovidercityaddress,\n\ta.attributedproviderstateaddress,\n\ta.attributedproviderzipcodeaddress,\n\ta.attributionperiodbegindate,\n\ta.attributionperiodenddate,\n\ta.attributedprovidertaxid,\n\ta.providerentityname,\n\ta.programidentifier,\n\ta.attributionrecordtype,\n\tpp.perf_period_key,\n\tc.customcancercode,\n\tc.principalcancercode,\n\tINITCAP(a.lineofbusiness) AS lineofbusiness,\n\tCASE\n\t\tWHEN m.memberbirthdate < CURRENT_DATE()\n\t\t\tTHEN FLOOR(\n\t\t\t\t\t(\n\t\t\t\t\t\tDATEDIFF(\n\t\t\t\t\t\t\tMONTH, m.memberbirthdate, a.attributionperiodbegindate\n\t\t\t\t\t\t)\n\t\t\t\t\t\t-\n\t\t\t\t\t\tTO_NUMERIC(\n\t\t\t\t\t\t\tDATE_PART(DAY, a.attributionperiodbegindate)\n\t\t\t\t\t\t\t< DATE_PART(DAY, m.memberbirthdate)\n\t\t\t\t\t\t)\n\t\t\t\t\t) / 12\n\t\t\t\t)\n\tEND AS memberageonattributedmonth\nFROM latestrecordmember AS a\n\tLEFT JOIN member_cancer_info AS c\n\t\tON a.memberid = c.memberid\n\tLEFT JOIN dev_dtx_gc.staging.STG_MEMBER AS m\n\t\tON a.memberid = m.memberid\n\tLEFT JOIN dev_dtx_gc.staging.stg_seed_performance_period AS pp\n\t\tON\n\t\t\ta.attributionperiodbegindate >= pp.perf_period_start_date\n\t\t\tAND a.attributionperiodbegindate <= pp.perf_period_end_date\nWHERE c.cancerorder_rn = 1",
    "raw_code": "{{ config( alias = 'stg_attribution_all', schema = 'staging') }}\r\n\r\n/**********************************************************************************************************\r\n\r\nIC-14282 | recentmemberdata is configured to fetch only one record per month regardless of attribution start date in a month | Selva\r\n\r\n**********************************************************************************************************/\r\n\r\nWITH latestrecordmember0 AS (\r\n\tSELECT DISTINCT\r\n\t\tmemberid,\r\n\t\tmemberkey,\r\n\t\ticsiteid,\r\n\t\tfileprocesseddatetime,\r\n\t\tattributedproviderid,\r\n\t\tattributednpiproviderid,\r\n\t\tattributedproviderfirstname,\r\n\t\tattributedproviderlastname,\r\n\t\tattributedproviderorganizationname,\r\n\t\tattributedproviderstreet1address,\r\n\t\tattributedproviderstreet2address,\r\n\t\tattributedprovidercityaddress,\r\n\t\tattributedproviderstateaddress,\r\n\t\tattributedproviderzipcodeaddress,\r\n\t\tattributedprovidertaxid,\r\n\t\tproviderentityname,\r\n\t\tprogramidentifier,\r\n\t\tattributionrecordtype,\r\n\t\tDATE_TRUNC(MONTH, attributionperiodbegindate)\r\n\t\t\tAS attributionperiodbegindate,\r\n\t\t-- This is used to identify the status of member\r\n\t\tLAST_DAY(attributionperiodenddate, MONTH) AS attributionperiodenddate,\r\n\t\tUPPER(lineofbusinessidentifier) AS lineofbusiness,\r\n\t\tROW_NUMBER()\r\n\t\t\tOVER (\r\n\t\t\t\tPARTITION BY\r\n\t\t\t\t\tmemberid, DATE_TRUNC(MONTH, attributionperiodbegindate)\r\n\t\t\t\tORDER BY\r\n\t\t\t\t\tfileprocesseddatetime ASC, attributionperiodenddate DESC\r\n\t\t\t)\r\n\t\t\tAS recentmemberdata\r\n\tFROM {{ source('IC1','ATTRIBUTION') }}\r\n),\r\n\r\nlatestrecordmember AS (\r\n\tSELECT * FROM latestrecordmember0\r\n\tWHERE recentmemberdata = 1\r\n),\r\n\r\nmember_cancer_info AS (\r\n\tSELECT\r\n\t\ta.memberid,\r\n\t\tCOALESCE(ct.icd10code, 'ZZZZZ') AS cancerdiagnosisgroupcode,\r\n\t\tCOALESCE(ct.cancer_type, 'Unknown') AS cancertype,\r\n\t\tCOALESCE(ct.icd10code, cl.claimlineprincipaldiagnosiscode, 'Unknown')\r\n\t\t\tAS customcancercode,\r\n\t\tCOALESCE(cl.claimlineprincipaldiagnosiscode, 'Unknown')\r\n\t\t\tAS principalcancercode,\r\n\t\tCASE\r\n\t\t\tWHEN ct.cancer_type IS NULL THEN 1 WHEN\r\n\t\t\t\tct.cancer_type LIKE 'Secondary%'\r\n\t\t\t\tTHEN 2\r\n\t\t\tWHEN ct.cancer_type LIKE '%other%' THEN 3 ELSE 4\r\n\t\tEND AS cancerorder,\r\n\t\tROW_NUMBER()\r\n\t\t\tOVER (\r\n\t\t\t\tPARTITION BY a.memberid\r\n\t\t\t\tORDER BY cancerorder DESC, cl.claimlineservicestartdate ASC\r\n\t\t\t)\r\n\t\t\tAS cancerorder_rn\r\n\tFROM latestrecordmember AS a\r\n\t\tLEFT JOIN {{ source('IC1','CLAIM') }} AS c\r\n\t\t\tON a.memberid = c.memberid\r\n\t\tLEFT JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\t\tON c.claimid = cl.claimid AND cl.claimlinestatuscode = 'APRVD'\r\n\t\tLEFT JOIN {{ ref('stg_seed_ocm_cancer_types') }} AS ct\r\n\t\t\tON cl.claimlineprincipaldiagnosiscode LIKE (ct.icd10code || '%')\r\n)\r\n\r\nSELECT DISTINCT\r\n\ta.memberid,\r\n\tc.cancerdiagnosisgroupcode,\r\n\tc.cancertype,\r\n\ta.memberkey,\r\n\ta.icsiteid,\r\n\ta.fileprocesseddatetime,\r\n\ta.attributedproviderid,\r\n\ta.attributednpiproviderid,\r\n\ta.attributedproviderfirstname,\r\n\ta.attributedproviderlastname,\r\n\ta.attributedproviderorganizationname,\r\n\ta.attributedproviderstreet1address,\r\n\ta.attributedproviderstreet2address,\r\n\ta.attributedprovidercityaddress,\r\n\ta.attributedproviderstateaddress,\r\n\ta.attributedproviderzipcodeaddress,\r\n\ta.attributionperiodbegindate,\r\n\ta.attributionperiodenddate,\r\n\ta.attributedprovidertaxid,\r\n\ta.providerentityname,\r\n\ta.programidentifier,\r\n\ta.attributionrecordtype,\r\n\tpp.perf_period_key,\r\n\tc.customcancercode,\r\n\tc.principalcancercode,\r\n\tINITCAP(a.lineofbusiness) AS lineofbusiness,\r\n\tCASE\r\n\t\tWHEN m.memberbirthdate < CURRENT_DATE()\r\n\t\t\tTHEN FLOOR(\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tDATEDIFF(\r\n\t\t\t\t\t\t\tMONTH, m.memberbirthdate, a.attributionperiodbegindate\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t-\r\n\t\t\t\t\t\tTO_NUMERIC(\r\n\t\t\t\t\t\t\tDATE_PART(DAY, a.attributionperiodbegindate)\r\n\t\t\t\t\t\t\t< DATE_PART(DAY, m.memberbirthdate)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t) / 12\r\n\t\t\t\t)\r\n\tEND AS memberageonattributedmonth\r\nFROM latestrecordmember AS a\r\n\tLEFT JOIN member_cancer_info AS c\r\n\t\tON a.memberid = c.memberid\r\n\tLEFT JOIN {{ ref('stg_member') }} AS m\r\n\t\tON a.memberid = m.memberid\r\n\tLEFT JOIN {{ ref('stg_seed_performance_period') }} AS pp\r\n\t\tON\r\n\t\t\ta.attributionperiodbegindate >= pp.perf_period_start_date\r\n\t\t\tAND a.attributionperiodbegindate <= pp.perf_period_end_date\r\nWHERE c.cancerorder_rn = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_attribution_all",
    "description": "All Attributed member details",
    "columns": {
      "FILEPROCESSEDDATETIME": {
        "name": "FILEPROCESSEDDATETIME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTEDNPIPROVIDERID": {
        "name": "ATTRIBUTEDNPIPROVIDERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTEDPROVIDERTAXID": {
        "name": "ATTRIBUTEDPROVIDERTAXID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTIONRECORDTYPE": {
        "name": "ATTRIBUTIONRECORDTYPE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LINEOFBUSINESS": {
        "name": "LINEOFBUSINESS",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.ATTRIBUTION",
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMLINE",
        "model.anthem_dev.stg_seed_ocm_cancer_types",
        "model.anthem_dev.stg_member",
        "model.anthem_dev.stg_seed_performance_period"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_avoidable_admissions",
    "name": "stg_avoidable_admissions",
    "original_file_path": "models\\staging\\stg_avoidable_admissions.sql",
    "compiled_code": "\n\nWITH ip_ed_admissions AS (\n\tSELECT\n\t\tma.memberid,\n\t\tma.claimid,\n\t\tma.claimlineid,\n\t\tma.claimlineprincipaldiagnosiscode,\n\t\tma.claimlineplaceofservicecode,\n\t\tma.claimlinehealthservicecode,\n\t\tma.dateofservice,\n\t\tma.claimlinerevenuecode,\n\t\tma.admission_type,\n\t\tma.admission_start_date,\n\t\tma.ipdateid\n\tFROM dev_dtx_gc.staging.stg_member_admissions AS ma\n\tWHERE ma.admission_type IN ('IP', 'ED')\n),\n\nprimary_avoidable_admissions AS (\n\tSELECT\n\t\tadm.*,\n\t\tavd.icd10code,\n\t\tavd.icd10description,\n\t\tavd.icd10group\n\tFROM ip_ed_admissions AS adm\n\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_qm_avoidable_diagnosis AS avd\n\t\t\tON adm.claimlineprincipaldiagnosiscode = avd.icd10code -- IC-20945 1. All pricipal diagnosis code that are avoidable diagnosis are to be considered as avoidable visits\n),\n\nsecondary_avoidable_admissions AS (\n\tSELECT\n\t\tadm.*,\n\t\tavd.icd10code,\n\t\tavd.icd10description,\n\t\tavd.icd10group\n\tFROM ip_ed_admissions AS adm\n\t\tLEFT JOIN dev_dtx_gc.IC1.CLAIMLINEDIAGNOSIS AS cld -- IC-20945 to fetch secondary diagnosis code for claims, The column \"diagnosiscode\" will contian the 25 secondary diagnosis as rows\n\t\t\tON adm.claimid = cld.claimid\n\t\t\t\tAND adm.claimlineid = cld.claimlineid\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_seed_ocm_cancer_types AS ct\n\t\t\tON adm.claimlineprincipaldiagnosiscode LIKE (ct.icd10code || '%')\n\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_qm_avoidable_diagnosis AS avd\n\t\t\tON cld.diagnosiscode = avd.icd10code -- IC-20945 2. IF pricipal diagnosis code are cancer codes and secondary diagnosis code are avoidable diagnosis the admissions are to be considered as avoidable visits\n\tWHERE NOT EXISTS (\n\t\t\tSELECT 1 FROM primary_avoidable_admissions AS paa\n\t\t\tWHERE paa.claimid = adm.claimid\n\t\t\t\tAND paa.claimlineid = adm.claimlineid\n\t\t\t\tAND paa.dateofservice = adm.dateofservice\n\t\t) -- IC-20945 To only look for admission that are not due to primary avoidable diagnosis\n\t\tAND ct.cancer_type IS NOT NULL -- IC-20945 to make sure the principal diagnosis is a cancer code\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY adm.memberid, adm.claimid, adm.dateofservice\n\t\t\tORDER BY avd.icd10code\n\t\t) = 1 -- To consider the only one avoidable diagnosis id there are multiple on same day based on alphabetical order\n)\n\nSELECT *\nFROM primary_avoidable_admissions\n\nUNION DISTINCT\n\nSELECT *\nFROM secondary_avoidable_admissions",
    "raw_code": "{{ config( alias = 'stg_avoidable_admissions', schema = 'staging') }}\r\n\r\nWITH ip_ed_admissions AS (\r\n\tSELECT\r\n\t\tma.memberid,\r\n\t\tma.claimid,\r\n\t\tma.claimlineid,\r\n\t\tma.claimlineprincipaldiagnosiscode,\r\n\t\tma.claimlineplaceofservicecode,\r\n\t\tma.claimlinehealthservicecode,\r\n\t\tma.dateofservice,\r\n\t\tma.claimlinerevenuecode,\r\n\t\tma.admission_type,\r\n\t\tma.admission_start_date,\r\n\t\tma.ipdateid\r\n\tFROM {{ ref('stg_member_admissions') }} AS ma\r\n\tWHERE ma.admission_type IN ('IP', 'ED')\r\n),\r\n\r\nprimary_avoidable_admissions AS (\r\n\tSELECT\r\n\t\tadm.*,\r\n\t\tavd.icd10code,\r\n\t\tavd.icd10description,\r\n\t\tavd.icd10group\r\n\tFROM ip_ed_admissions AS adm\r\n\t\tINNER JOIN {{ ref('stg_seed_qm_avoidable_diagnosis') }} AS avd\r\n\t\t\tON adm.claimlineprincipaldiagnosiscode = avd.icd10code -- IC-20945 1. All pricipal diagnosis code that are avoidable diagnosis are to be considered as avoidable visits\r\n),\r\n\r\nsecondary_avoidable_admissions AS (\r\n\tSELECT\r\n\t\tadm.*,\r\n\t\tavd.icd10code,\r\n\t\tavd.icd10description,\r\n\t\tavd.icd10group\r\n\tFROM ip_ed_admissions AS adm\r\n\t\tLEFT JOIN {{ source('IC1','CLAIMLINEDIAGNOSIS') }} AS cld -- IC-20945 to fetch secondary diagnosis code for claims, The column \"diagnosiscode\" will contian the 25 secondary diagnosis as rows\r\n\t\t\tON adm.claimid = cld.claimid\r\n\t\t\t\tAND adm.claimlineid = cld.claimlineid\r\n\t\tLEFT JOIN {{ ref('stg_seed_ocm_cancer_types') }} AS ct\r\n\t\t\tON adm.claimlineprincipaldiagnosiscode LIKE (ct.icd10code || '%')\r\n\t\tINNER JOIN {{ ref('stg_seed_qm_avoidable_diagnosis') }} AS avd\r\n\t\t\tON cld.diagnosiscode = avd.icd10code -- IC-20945 2. IF pricipal diagnosis code are cancer codes and secondary diagnosis code are avoidable diagnosis the admissions are to be considered as avoidable visits\r\n\tWHERE NOT EXISTS (\r\n\t\t\tSELECT 1 FROM primary_avoidable_admissions AS paa\r\n\t\t\tWHERE paa.claimid = adm.claimid\r\n\t\t\t\tAND paa.claimlineid = adm.claimlineid\r\n\t\t\t\tAND paa.dateofservice = adm.dateofservice\r\n\t\t) -- IC-20945 To only look for admission that are not due to primary avoidable diagnosis\r\n\t\tAND ct.cancer_type IS NOT NULL -- IC-20945 to make sure the principal diagnosis is a cancer code\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY adm.memberid, adm.claimid, adm.dateofservice\r\n\t\t\tORDER BY avd.icd10code\r\n\t\t) = 1 -- To consider the only one avoidable diagnosis id there are multiple on same day based on alphabetical order\r\n)\r\n\r\nSELECT *\r\nFROM primary_avoidable_admissions\r\n\r\nUNION DISTINCT\r\n\r\nSELECT *\r\nFROM secondary_avoidable_admissions",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_avoidable_admissions",
    "description": "All Avoidable inpatient and Emergency Department Visits",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMLINEPLACEOFSERVICECODE": {
        "name": "CLAIMLINEPLACEOFSERVICECODE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DATEOFSERVICE": {
        "name": "DATEOFSERVICE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ICD10CODE": {
        "name": "ICD10CODE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIMLINEDIAGNOSIS",
        "model.anthem_dev.stg_member_admissions",
        "model.anthem_dev.stg_seed_qm_avoidable_diagnosis",
        "model.anthem_dev.stg_seed_ocm_cancer_types"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_billing_provider",
    "name": "stg_billing_provider",
    "original_file_path": "models\\staging\\stg_billing_provider.sql",
    "compiled_code": "\n\nWITH distinctprovider AS (\n\tSELECT DISTINCT\n\t\tclaimbillingprovidernpinumber,\n\t\tmedicalfacilitytin\n\tFROM dev_dtx_gc.staging.stg_claims\n\tWHERE medicalfacilitytin IS NOT NULL\n)\n\nSELECT\n\tsp.npi,\n\tsp.provider_name,\n\tsp.provider_city_name,\n\tsp.provider_state_name,\n\tsp.taxonomy_code,\n\tsp.npi_deactivation_date,\n\tsp.provider_specialty,\n\tp.medicalfacilitytin,\n\tNULL AS region,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tCASE\n\t\tWHEN\n\t\t\tLEN(sp.provider_postal_code) > 5\n\t\t\tTHEN\n\t\t\t\tSUBSTR(sp.provider_postal_code, 1, 5)\n\t\t\t\t|| '-'\n\t\t\t\t|| SUBSTR(\n\t\t\t\t\tsp.provider_postal_code,\n\t\t\t\t\t6,\n\t\t\t\t\t(LEN(sp.provider_postal_code) - 5)\n\t\t\t\t)\n\t\tELSE sp.provider_postal_code\n\tEND AS provider_postal_code,\n\tCONCAT(\n\t\tCOALESCE(p.claimbillingprovidernpinumber, ''), '_', p.medicalfacilitytin\n\t) AS billingnpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM distinctprovider AS p\n\tLEFT JOIN dev_dtx_gc.staging.stg_provider AS sp\n\t\tON p.claimbillingprovidernpinumber = sp.npi\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON p.medicalfacilitytin = map.tin",
    "raw_code": "{{ config( alias = 'stg_billing_provider', schema = 'staging') }}\r\n\r\nWITH distinctprovider AS (\r\n\tSELECT DISTINCT\r\n\t\tclaimbillingprovidernpinumber,\r\n\t\tmedicalfacilitytin\r\n\tFROM {{ ref('stg_claims') }}\r\n\tWHERE medicalfacilitytin IS NOT NULL\r\n)\r\n\r\nSELECT\r\n\tsp.npi,\r\n\tsp.provider_name,\r\n\tsp.provider_city_name,\r\n\tsp.provider_state_name,\r\n\tsp.taxonomy_code,\r\n\tsp.npi_deactivation_date,\r\n\tsp.provider_specialty,\r\n\tp.medicalfacilitytin,\r\n\tNULL AS region,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tCASE\r\n\t\tWHEN\r\n\t\t\tLEN(sp.provider_postal_code) > 5\r\n\t\t\tTHEN\r\n\t\t\t\tSUBSTR(sp.provider_postal_code, 1, 5)\r\n\t\t\t\t|| '-'\r\n\t\t\t\t|| SUBSTR(\r\n\t\t\t\t\tsp.provider_postal_code,\r\n\t\t\t\t\t6,\r\n\t\t\t\t\t(LEN(sp.provider_postal_code) - 5)\r\n\t\t\t\t)\r\n\t\tELSE sp.provider_postal_code\r\n\tEND AS provider_postal_code,\r\n\tCONCAT(\r\n\t\tCOALESCE(p.claimbillingprovidernpinumber, ''), '_', p.medicalfacilitytin\r\n\t) AS billingnpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM distinctprovider AS p\r\n\tLEFT JOIN {{ ref('stg_provider') }} AS sp\r\n\t\tON p.claimbillingprovidernpinumber = sp.npi\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON p.medicalfacilitytin = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_billing_provider",
    "description": "Provider details",
    "columns": {
      "BillingNPI_AttributedTIN": {
        "name": "BillingNPI_AttributedTIN",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_claims",
        "model.anthem_dev.stg_provider",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_cancer_type",
    "name": "stg_cancer_type",
    "original_file_path": "models\\staging\\stg_cancer_type.sql",
    "compiled_code": "\n\nSELECT DISTINCT\n\tcancerdiagnosisgroupcode,\n\tcancertype,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM dev_dtx_gc.staging.stg_attribution",
    "raw_code": "{{ config( alias = 'stg_Cancer_Type', schema = 'staging') }}\r\n\r\nSELECT DISTINCT\r\n\tcancerdiagnosisgroupcode,\r\n\tcancertype,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM {{ ref('stg_attribution') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_Cancer_Type",
    "description": "LookUp table for Cancer Types based on GroupCode",
    "columns": {
      "CANCERDIAGNOSISGROUPCODE": {
        "name": "CANCERDIAGNOSISGROUPCODE",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_attribution"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_care_coordination_fee",
    "name": "stg_care_coordination_fee",
    "original_file_path": "models\\staging\\stg_care_coordination_fee.sql",
    "compiled_code": "\n\n/**********************************************************************************************************\n\nIC-15569 | Care Coordination Fee Dashboard Patient List DBT\n\n**********************************************************************************************************/\nWITH pg_id_status AS (\n\tSELECT DISTINCT\n\t\tpayer_program_id,\n\t\tcompleted_improvement_plan,\n\t\timprovement_plan_completion_date\n\tFROM dev_dtx_gc.staging.stg_seed_anthem_salesforce_apm_enrollees\n),\n\ntax_id_status AS (\n\tSELECT DISTINCT\n\t\ttax_id,\n\t\tcompleted_improvement_plan,\n\t\timprovement_plan_completion_date\n\tFROM dev_dtx_gc.staging.stg_seed_anthem_salesforce_apm_enrollees\n),\n\ncare_coordination_fee AS (\nSELECT DISTINCT\n\tcc.memberid,\n\tcc.providergroupid,\n\tcc.attributedprovidertaxid,\n\tUPPER(IFF(\n\t\tnd.entity_type_code = 2, nd.provider_organization_name_legal_business_name,\n\t\tCOALESCE(nd.provider_last_name_legal_name, '') || ', ' || COALESCE(nd.provider_first_name, '')\n\t)) AS provider_name,\n\tcc.payeenpinumber,\n\tcc.paymentbegindate,\n\tCASE\n\t\tWHEN pp.ccf_version = 0\n\t\t\tTHEN cc.payeepaymentamount\n\t\tWHEN pp.ccf_version = 1\n\t\t\tTHEN\n\t\t\t\tCASE WHEN pg.completed_improvement_plan IS NULL AND tax.completed_improvement_plan IS NULL\n\t\t\t\t\t\tTHEN cc.payeepaymentamount\n\t\t\t\t\tWHEN (cc.paymentbegindate >= pg.improvement_plan_completion_date AND pg.completed_improvement_plan = TRUE) \n\t\t\t\t\t\t\tor (cc.paymentbegindate >= tax.improvement_plan_completion_date AND tax.completed_improvement_plan = TRUE)\n\t\t\t\t\t\tTHEN (CASE WHEN cc.payeepaymentamount > 0 THEN 1 ELSE -1 end) * 130 \n\t\t\t\t\tELSE\n\t\t\t\t\t\t(CASE WHEN cc.payeepaymentamount > 0 THEN 1 ELSE -1 END) * 85\n\t\t\t\tEND\n\tEND AS ccfamount,\n\tTO_CHAR(cc.paymentbegindate, 'MON-YYYY') AS ccfmonth,\n\tcc.fileprocesseddatetime,\n\tcc.subscriberid,\n\tcc.cmsfiledate,\n    COALESCE(fa.lineofbusiness, INITCAP(cc.lineofbusinessidentifier), 'NA') AS lineofbusiness,\n\tCOALESCE(fa.cancerdiagnosisgroupcode, 'ZZZZZ') AS cancerdiagnosisgroupcode,\n\tpp.perf_period_key,\n    cc.programidentifier\nFROM dev_dtx_gc.IC1.CCF AS cc\n\tLEFT OUTER JOIN dev_dtx_gc.staging.stg_attribution_all AS fa\n\t\tON cc.memberid = fa.memberid\n\t\t\tAND TO_CHAR(cc.paymentbegindate, 'MON-YYYY') = TO_CHAR(fa.attributionperiodbegindate, 'MON-YYYY')\n\tLEFT OUTER JOIN dev_dtx_gc.staging.stg_seed_performance_period AS pp\n\t\tON cc.paymentbegindate >= pp.perf_period_start_date\n\t\t\tAND cc.paymentbegindate <= pp.perf_period_end_date\n\tLEFT JOIN pg_id_status AS pg\n\t\tON cc.programidentifier = pg.payer_program_id\n\tLEFT JOIN tax_id_status AS tax\n\t\tON cc.attributedprovidertaxid = tax.tax_id\n\tLEFT OUTER JOIN\n\t\t\n\t\t\tPROD_INTELLIGENCE_DTX.IC_TO_ANTHEM.NPIDATA AS nd\n\t\t\n\t\tON cc.payeenpinumber = nd.npi\n)\n\nSELECT\n\tcc.*,\n\thm.ishospicemember,\n\tCONCAT(cc.memberid, '_', COALESCE(cc.attributedprovidertaxid, ''))\n\t\tAS memberid_attributedtin,\n\tCONCAT(\n\t\tCOALESCE(cc.payeenpinumber, ''),\n\t\t'_',\n\t\tCOALESCE(cc.attributedprovidertaxid, '')\n\t) AS participatingnpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM care_coordination_fee AS cc\n\tLEFT JOIN\n\t\tdev_dtx_gc.staging.stg_member_hospice_mapping AS hm\n\t\tON cc.memberid = hm.memberid AND cc.perf_period_key = hm.perf_period_key AND cc.lineofbusiness = hm.lineofbusiness",
    "raw_code": "{{ config( alias = 'stg_care_coordination_fee', schema = 'staging') }}\r\n\r\n/**********************************************************************************************************\r\n\r\nIC-15569 | Care Coordination Fee Dashboard Patient List DBT\r\n\r\n**********************************************************************************************************/\r\nWITH pg_id_status AS (\r\n\tSELECT DISTINCT\r\n\t\tpayer_program_id,\r\n\t\tcompleted_improvement_plan,\r\n\t\timprovement_plan_completion_date\r\n\tFROM {{ ref('stg_seed_anthem_salesforce_apm_enrollees') }}\r\n),\r\n\r\ntax_id_status AS (\r\n\tSELECT DISTINCT\r\n\t\ttax_id,\r\n\t\tcompleted_improvement_plan,\r\n\t\timprovement_plan_completion_date\r\n\tFROM {{ ref('stg_seed_anthem_salesforce_apm_enrollees') }}\r\n),\r\n\r\ncare_coordination_fee AS (\r\nSELECT DISTINCT\r\n\tcc.memberid,\r\n\tcc.providergroupid,\r\n\tcc.attributedprovidertaxid,\r\n\tUPPER(IFF(\r\n\t\tnd.entity_type_code = 2, nd.provider_organization_name_legal_business_name,\r\n\t\tCOALESCE(nd.provider_last_name_legal_name, '') || ', ' || COALESCE(nd.provider_first_name, '')\r\n\t)) AS provider_name,\r\n\tcc.payeenpinumber,\r\n\tcc.paymentbegindate,\r\n\tCASE\r\n\t\tWHEN pp.ccf_version = 0\r\n\t\t\tTHEN cc.payeepaymentamount\r\n\t\tWHEN pp.ccf_version = 1\r\n\t\t\tTHEN\r\n\t\t\t\tCASE WHEN pg.completed_improvement_plan IS NULL AND tax.completed_improvement_plan IS NULL\r\n\t\t\t\t\t\tTHEN cc.payeepaymentamount\r\n\t\t\t\t\tWHEN (cc.paymentbegindate >= pg.improvement_plan_completion_date AND pg.completed_improvement_plan = TRUE) \r\n\t\t\t\t\t\t\tor (cc.paymentbegindate >= tax.improvement_plan_completion_date AND tax.completed_improvement_plan = TRUE)\r\n\t\t\t\t\t\tTHEN (CASE WHEN cc.payeepaymentamount > 0 THEN 1 ELSE -1 end) * 130 \r\n\t\t\t\t\tELSE\r\n\t\t\t\t\t\t(CASE WHEN cc.payeepaymentamount > 0 THEN 1 ELSE -1 END) * 85\r\n\t\t\t\tEND\r\n\tEND AS ccfamount,\r\n\tTO_CHAR(cc.paymentbegindate, 'MON-YYYY') AS ccfmonth,\r\n\tcc.fileprocesseddatetime,\r\n\tcc.subscriberid,\r\n\tcc.cmsfiledate,\r\n    COALESCE(fa.lineofbusiness, INITCAP(cc.lineofbusinessidentifier), 'NA') AS lineofbusiness,\r\n\tCOALESCE(fa.cancerdiagnosisgroupcode, 'ZZZZZ') AS cancerdiagnosisgroupcode,\r\n\tpp.perf_period_key,\r\n    cc.programidentifier\r\nFROM {{ source('IC1','CCF') }} AS cc\r\n\tLEFT OUTER JOIN {{ ref('stg_attribution_all') }} AS fa\r\n\t\tON cc.memberid = fa.memberid\r\n\t\t\tAND TO_CHAR(cc.paymentbegindate, 'MON-YYYY') = TO_CHAR(fa.attributionperiodbegindate, 'MON-YYYY')\r\n\tLEFT OUTER JOIN {{ ref('stg_seed_performance_period') }} AS pp\r\n\t\tON cc.paymentbegindate >= pp.perf_period_start_date\r\n\t\t\tAND cc.paymentbegindate <= pp.perf_period_end_date\r\n\tLEFT JOIN pg_id_status AS pg\r\n\t\tON cc.programidentifier = pg.payer_program_id\r\n\tLEFT JOIN tax_id_status AS tax\r\n\t\tON cc.attributedprovidertaxid = tax.tax_id\r\n\tLEFT OUTER JOIN\r\n\t\t{% if '_DEMO' in target.database %}\r\n        {{ source('IC1','LKP_NPIDATA') }} nd\r\n        {% else %}\r\n\t\t\t{{ source('IC_TO_ANTHEM','NPIDATA') }} AS nd\r\n\t\t{% endif %}\r\n\t\tON cc.payeenpinumber = nd.npi\r\n)\r\n\r\nSELECT\r\n\tcc.*,\r\n\thm.ishospicemember,\r\n\tCONCAT(cc.memberid, '_', COALESCE(cc.attributedprovidertaxid, ''))\r\n\t\tAS memberid_attributedtin,\r\n\tCONCAT(\r\n\t\tCOALESCE(cc.payeenpinumber, ''),\r\n\t\t'_',\r\n\t\tCOALESCE(cc.attributedprovidertaxid, '')\r\n\t) AS participatingnpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM care_coordination_fee AS cc\r\n\tLEFT JOIN\r\n\t\t{{ ref('stg_member_hospice_mapping') }} AS hm\r\n\t\tON cc.memberid = hm.memberid AND cc.perf_period_key = hm.perf_period_key AND cc.lineofbusiness = hm.lineofbusiness",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_care_coordination_fee",
    "description": "",
    "columns": {
      "memberid": {
        "name": "memberid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "paymentbegindate": {
        "name": "paymentbegindate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "perf_period_key": {
        "name": "perf_period_key",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "cancerdiagnosisgroupcode": {
        "name": "cancerdiagnosisgroupcode",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "cmsfiledate": {
        "name": "cmsfiledate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "lineofbusiness": {
        "name": "lineofbusiness",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "isHospiceMember": {
        "name": "isHospiceMember",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CCF",
        "source.anthem_dev.IC_TO_ANTHEM.NPIDATA",
        "model.anthem_dev.stg_seed_anthem_salesforce_apm_enrollees",
        "model.anthem_dev.stg_attribution_all",
        "model.anthem_dev.stg_seed_performance_period",
        "model.anthem_dev.stg_member_hospice_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_claimline",
    "name": "stg_claimline",
    "original_file_path": "models\\staging\\stg_claimline.sql",
    "compiled_code": "\n\n\nWITH stg_claimline AS (\n\tSELECT DISTINCT\n\t\tc.memberid,\n\t\tep.perf_period_key,\n\t\tep.episode_start_date,\n\t\tep.episode_end_date,\n\t\tc.claimid,\n\t\tTO_NUMBER(cl.claimlinenumber) AS claimlinenumber,\n\t\tCOALESCE(ep.tin, c.claimbillingproviderfederaltaxidnumber) AS medicalfacilitytin,\n\t\tCOALESCE(ep.participatingprovidernpi, c.claimrenderingprovidernpinumber, claimbillingprovidernpinumber) AS participatingprovidernpi,\n\t\tc.claimbillingprovidernpinumber,\n\t\tc.claimrenderingprovidernpinumber,\n\t\tc.claimextractadjudicationdate,\n\t\tCOALESCE(c.claimlengthofinpatientstaynumber, 0) AS claimlengthofinpatientstaynumber,\n\t\tc.claimtypeofbillcode,\n\t\tcl.claimlinerevenuecode,\n\t\tcl.claimlineservicestartdate,\n\t\tcl.claimlineserviceenddate,\n\t\tcl.claimlinehealthservicecode,\n\t\tcl.claimlineproceduremodifier1code,\n\t\tcl.claimlineproviderrenderingprovidernetworkidentifier,\n\t\tcl.claimlinepatientdischargestatuscode,\n\t\tcl.claimlinehealthservicetypecode,\n\t\tcl.claimlineplaceofservicecode,\n\t\tcl.claimlineprincipaldiagnosiscode,\n\t\tCONCAT(ad.icd10code, ' - ', ad.icd10description) AS avoidablediagnosis,\n\t\tCASE WHEN ad.icd10code IS NULL THEN 0 ELSE 1 END AS avoidableadmissionflag,\n\t\tUPPER(ad.icd10group) AS avoidablediagnosisgroup,\n\t\tNULL AS chemotherapytype,\n\t\tCASE \n\t\t\tWHEN mad.admission_type = 'IP' THEN 'Inpatient'\n\t\t\tWHEN mad.admission_type = 'ED' THEN 'ED'                         -- IC-14456: Only spefic codes are eligible for ED\n\t\t\tWHEN che.code IS NOT NULL THEN 'Chemo & Drugs (Medical)'   -- Independen of POS, it depends on chemocodes\n\t\t\tWHEN cl.claimlineplaceofservicecode IN (21,23)  THEN 'All other medicals' -- Rest of ED,IP POS will fall under Other\n\t\t\tELSE cms.place_of_service_name\n\t\tEND AS utilizationcategory,\n\t\tCOALESCE(utilizationcategory, 'All other medicals') AS costcategory,\n\t\tcl.claimlinepaidamount,\n\t\tcl.claimlineallowedamountvalue,\n\t\tCASE WHEN cl.claimlineinnetworkcode = 'IN' THEN 'In Network'\n\t\t\tWHEN cl.claimlineinnetworkcode = 'OUT' THEN 'Out of Network' ELSE 'UnKnown'\n\t\tEND AS inoutnetwork,\n\t\tep.cancerdiagnosisgroupcode,\n\t\tNULL AS claimpharmacyndccode,\n\t\tNULL AS claimpharmacygenericproductidentifier,\n\t\tNULL AS claimpharmacydrugmetricstrengthnumber,\n\t\tNULL AS claimpharmacydrugmetricunitnumber,\n\t\tNULL AS claimprescriptionfilleddate,\n\t\tNULL AS claimpharmacyfilledrefillsnumber,\n\t\tNULL AS claimpharmacysupplydaysnumber,\n\t\tNULL AS claimpharmacynationalprovideridentifier,\n\t\tNULL AS claimprescribingprovidernpinumber,\n\t\t0 AS drgpaymentamount, -- until field mapping is identified, defaulted to 0\n\t\tCASE WHEN mad.admission_type IS NULL AND che.code IS NOT NULL THEN 'Chemo & Drugs (Medical)' ELSE 'Medical' END AS sourcename,\n\t\tCOALESCE(ep.lineofbusiness, c.claimpayerlineofbusinessdescription) AS lineofbusiness,\n\t\tmad.admission_group AS ipadmissiongroup,\n\t\tmad.admission_start_date,\n\t\tmad.ipdateid,\n\t\tmad.eddateid,\n\t\tCASE WHEN qm3.numerator = 1 OR qm4.numerator = 1 THEN 'Y' ELSE 'N' END AS  qualitymeasureindicator\n\tFROM dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\tINNER JOIN dev_dtx_gc.IC1.CLAIM AS c\n\t\t\tON cl.claimid = c.claimid\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_member_admissions AS mad\n\t\t\tON c.memberid = mad.memberid\n\t\t\t\tAND cl.claimid = mad.claimid\n\t\t\t\tAND cl.claimlineid = mad.claimlineid\n\t\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS ep\n\t\t\tON c.memberid = ep.memberid\n\t\t\t\tAND coalesce(mad.admission_start_date, cl.claimlineservicestartdate) >= ep.episode_start_date\n\t\t\t\tAND coalesce(mad.admission_start_date, cl.claimlineservicestartdate) <= ep.episode_end_date\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_seed_place_of_service_mapping AS cms\n\t\t\tON cl.claimlineplaceofservicecode = cms.place_of_service_code\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_seed_chemo_codes AS che\n\t\t\tON cl.claimlinehealthservicecode = che.code AND che.code_type = 'HCPCS'\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_avoidable_admissions AS ad\n\t\t\tON ep.memberid = ad.memberid\n\t\t\t\tAND cl.claimid = ad.claimid\n\t\t\t\tAND cl.claimlineid = ad.claimlineid\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_qm3_4 AS qm3\n            ON (mad.admission_type = 'IP' AND mad.ipdateid = qm3.ipdateid AND qm3.qm_name = 'QM3')\n\t\t\tAND qm3.numerator = 1\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_qm3_4 AS qm4\n            ON (mad.admission_type = 'ED' AND mad.memberid = qm4.memberid AND mad.admission_start_date = qm4.admission_start_date AND qm4.qm_name = 'QM4')\n\t\t\tAND qm4.numerator = 1\n\tWHERE cl.claimlinestatuscode = 'APRVD'\n)\n\nSELECT\n\tcl.*\nFROM stg_claimline AS cl\nQUALIFY ROW_NUMBER() OVER (\n\t\tPARTITION BY claimid, claimlinenumber\n\t\tORDER BY episode_start_date DESC\n\t) = 1",
    "raw_code": "{{ config( alias = 'stg_claimline', schema = 'staging') }}\r\n\r\n\r\nWITH stg_claimline AS (\r\n\tSELECT DISTINCT\r\n\t\tc.memberid,\r\n\t\tep.perf_period_key,\r\n\t\tep.episode_start_date,\r\n\t\tep.episode_end_date,\r\n\t\tc.claimid,\r\n\t\tTO_NUMBER(cl.claimlinenumber) AS claimlinenumber,\r\n\t\tCOALESCE(ep.tin, c.claimbillingproviderfederaltaxidnumber) AS medicalfacilitytin,\r\n\t\tCOALESCE(ep.participatingprovidernpi, c.claimrenderingprovidernpinumber, claimbillingprovidernpinumber) AS participatingprovidernpi,\r\n\t\tc.claimbillingprovidernpinumber,\r\n\t\tc.claimrenderingprovidernpinumber,\r\n\t\tc.claimextractadjudicationdate,\r\n\t\tCOALESCE(c.claimlengthofinpatientstaynumber, 0) AS claimlengthofinpatientstaynumber,\r\n\t\tc.claimtypeofbillcode,\r\n\t\tcl.claimlinerevenuecode,\r\n\t\tcl.claimlineservicestartdate,\r\n\t\tcl.claimlineserviceenddate,\r\n\t\tcl.claimlinehealthservicecode,\r\n\t\tcl.claimlineproceduremodifier1code,\r\n\t\tcl.claimlineproviderrenderingprovidernetworkidentifier,\r\n\t\tcl.claimlinepatientdischargestatuscode,\r\n\t\tcl.claimlinehealthservicetypecode,\r\n\t\tcl.claimlineplaceofservicecode,\r\n\t\tcl.claimlineprincipaldiagnosiscode,\r\n\t\tCONCAT(ad.icd10code, ' - ', ad.icd10description) AS avoidablediagnosis,\r\n\t\tCASE WHEN ad.icd10code IS NULL THEN 0 ELSE 1 END AS avoidableadmissionflag,\r\n\t\tUPPER(ad.icd10group) AS avoidablediagnosisgroup,\r\n\t\tNULL AS chemotherapytype,\r\n\t\tCASE \r\n\t\t\tWHEN mad.admission_type = 'IP' THEN 'Inpatient'\r\n\t\t\tWHEN mad.admission_type = 'ED' THEN 'ED'                         -- IC-14456: Only spefic codes are eligible for ED\r\n\t\t\tWHEN che.code IS NOT NULL THEN 'Chemo & Drugs (Medical)'   -- Independen of POS, it depends on chemocodes\r\n\t\t\tWHEN cl.claimlineplaceofservicecode IN (21,23)  THEN 'All other medicals' -- Rest of ED,IP POS will fall under Other\r\n\t\t\tELSE cms.place_of_service_name\r\n\t\tEND AS utilizationcategory,\r\n\t\tCOALESCE(utilizationcategory, 'All other medicals') AS costcategory,\r\n\t\tcl.claimlinepaidamount,\r\n\t\tcl.claimlineallowedamountvalue,\r\n\t\tCASE WHEN cl.claimlineinnetworkcode = 'IN' THEN 'In Network'\r\n\t\t\tWHEN cl.claimlineinnetworkcode = 'OUT' THEN 'Out of Network' ELSE 'UnKnown'\r\n\t\tEND AS inoutnetwork,\r\n\t\tep.cancerdiagnosisgroupcode,\r\n\t\tNULL AS claimpharmacyndccode,\r\n\t\tNULL AS claimpharmacygenericproductidentifier,\r\n\t\tNULL AS claimpharmacydrugmetricstrengthnumber,\r\n\t\tNULL AS claimpharmacydrugmetricunitnumber,\r\n\t\tNULL AS claimprescriptionfilleddate,\r\n\t\tNULL AS claimpharmacyfilledrefillsnumber,\r\n\t\tNULL AS claimpharmacysupplydaysnumber,\r\n\t\tNULL AS claimpharmacynationalprovideridentifier,\r\n\t\tNULL AS claimprescribingprovidernpinumber,\r\n\t\t0 AS drgpaymentamount, -- until field mapping is identified, defaulted to 0\r\n\t\tCASE WHEN mad.admission_type IS NULL AND che.code IS NOT NULL THEN 'Chemo & Drugs (Medical)' ELSE 'Medical' END AS sourcename,\r\n\t\tCOALESCE(ep.lineofbusiness, c.claimpayerlineofbusinessdescription) AS lineofbusiness,\r\n\t\tmad.admission_group AS ipadmissiongroup,\r\n\t\tmad.admission_start_date,\r\n\t\tmad.ipdateid,\r\n\t\tmad.eddateid,\r\n\t\tCASE WHEN qm3.numerator = 1 OR qm4.numerator = 1 THEN 'Y' ELSE 'N' END AS  qualitymeasureindicator\r\n\tFROM {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\tINNER JOIN {{ source('IC1','CLAIM') }} AS c\r\n\t\t\tON cl.claimid = c.claimid\r\n\t\tLEFT JOIN {{ ref('stg_member_admissions') }} AS mad\r\n\t\t\tON c.memberid = mad.memberid\r\n\t\t\t\tAND cl.claimid = mad.claimid\r\n\t\t\t\tAND cl.claimlineid = mad.claimlineid\r\n\t\tINNER JOIN {{ ref('stg_episodes') }} AS ep\r\n\t\t\tON c.memberid = ep.memberid\r\n\t\t\t\tAND coalesce(mad.admission_start_date, cl.claimlineservicestartdate) >= ep.episode_start_date\r\n\t\t\t\tAND coalesce(mad.admission_start_date, cl.claimlineservicestartdate) <= ep.episode_end_date\r\n\t\tLEFT JOIN {{ ref('stg_seed_place_of_service_mapping') }} AS cms\r\n\t\t\tON cl.claimlineplaceofservicecode = cms.place_of_service_code\r\n\t\tLEFT JOIN {{ ref('stg_seed_chemo_codes') }} AS che\r\n\t\t\tON cl.claimlinehealthservicecode = che.code AND che.code_type = 'HCPCS'\r\n\t\tLEFT JOIN {{ ref('stg_avoidable_admissions') }} AS ad\r\n\t\t\tON ep.memberid = ad.memberid\r\n\t\t\t\tAND cl.claimid = ad.claimid\r\n\t\t\t\tAND cl.claimlineid = ad.claimlineid\r\n\t\tLEFT JOIN {{ ref('stg_qm3_4')}} AS qm3\r\n            ON (mad.admission_type = 'IP' AND mad.ipdateid = qm3.ipdateid AND qm3.qm_name = 'QM3')\r\n\t\t\tAND qm3.numerator = 1\r\n\t\tLEFT JOIN {{ ref('stg_qm3_4')}} AS qm4\r\n            ON (mad.admission_type = 'ED' AND mad.memberid = qm4.memberid AND mad.admission_start_date = qm4.admission_start_date AND qm4.qm_name = 'QM4')\r\n\t\t\tAND qm4.numerator = 1\r\n\tWHERE cl.claimlinestatuscode = 'APRVD'\r\n)\r\n\r\nSELECT\r\n\tcl.*\r\nFROM stg_claimline AS cl\r\nQUALIFY ROW_NUMBER() OVER (\r\n\t\tPARTITION BY claimid, claimlinenumber\r\n\t\tORDER BY episode_start_date DESC\r\n\t) = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_claimline",
    "description": "Staging model for claim line data with episode-based filtering and healthcare-specific categorization",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMLINESERVICESTARTDATE": {
        "name": "CLAIMLINESERVICESTARTDATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMLINESERVICEENDDATE": {
        "name": "CLAIMLINESERVICEENDDATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MEDICALFACILITYTIN": {
        "name": "MEDICALFACILITYTIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "COSTCATEGORY": {
        "name": "COSTCATEGORY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "SOURCENAME": {
        "name": "SOURCENAME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LINEOFBUSINESS": {
        "name": "LINEOFBUSINESS",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMLINE",
        "model.anthem_dev.stg_member_admissions",
        "model.anthem_dev.stg_episodes",
        "model.anthem_dev.stg_seed_place_of_service_mapping",
        "model.anthem_dev.stg_seed_chemo_codes",
        "model.anthem_dev.stg_avoidable_admissions",
        "model.anthem_dev.stg_qm3_4"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_claimpharmacy",
    "name": "stg_claimpharmacy",
    "original_file_path": "models\\staging\\stg_claimpharmacy.sql",
    "compiled_code": "\n\n\nSELECT DISTINCT\n\tcp.memberid,\n\tep.perf_period_key,\n\tep.episode_start_date,\n\tep.episode_end_date,\n\tcp.claimid,\n\tTO_NUMBER(cp.claimpharmacylinenumber) AS claimlinenumber,\n\tep.tin AS medicalfacilitytin,\n\tCOALESCE(ep.participatingprovidernpi, cp.claimpharmacynationalprovideridentifier, cp.claimpharmacyfacilitynpinumber) AS participatingprovidernpi,\n\tcp.claimpharmacyfacilitynpinumber AS claimbillingprovidernpinumber,\n\tcp.claimpharmacynationalprovideridentifier AS claimrenderingprovidernpinumber,\n\tNULL AS claimextractadjudicationdate,\n\t0 AS claimlengthofinpatientstaynumber,\n\tNULL AS claimtypeofbillcode,\n\tNULL AS claimlinerevenuecode,\n\tcp.claimprescriptionfilleddate AS claimlineservicestartdate,\n\tNULL AS claimlineserviceenddate,\n\tNULL AS claimlinehealthservicecode,\n\tNULL AS claimlineproceduremodifier1code,\n\tNULL AS claimlineproviderrenderingprovidernetworkidentifier,\n\tNULL AS claimlinepatientdischargestatuscode,\n\tNULL AS claimlinehealthservicetypecode,\n\tNULL AS claimlineplaceofservicecode,\n\tNULL AS claimlineprincipaldiagnosiscode,\n\tNULL AS avoidablediagnosis,\n\tNULL AS avoidableadmissionflag,\n\tNULL AS avoidablediagnosisgroup,\n\tNULL AS chemotherapytype,\n\t'Retail Pharmacy' AS costcategory,\n\tNULL AS utilizationcategory,\n\tcp.claimpharmacypaidamount AS claimlinepaidamount,\n\tcp.claimpharmacyallowedamount AS claimlineallowedamountvalue,\n\tCASE WHEN cp.claimpharmacyinnetworkcode = 'IN' THEN 'In Network'\n\t\tWHEN cp.claimpharmacyinnetworkcode = 'OUT' THEN 'Out of Network' ELSE 'UnKnown'\n\tEND AS inoutnetwork,\n\tep.cancerdiagnosisgroupcode,\n\tcp.claimpharmacyndccode,\n\tcp.claimpharmacygenericproductidentifier,\n\tcp.claimpharmacydrugmetricstrengthnumber,\n\tcp.claimpharmacydrugmetricunitnumber,\n\tcp.claimprescriptionfilleddate,\n\tcp.claimpharmacyfilledrefillsnumber,\n\tcp.claimpharmacysupplydaysnumber,\n\tcp.claimpharmacynationalprovideridentifier,\n\tcp.claimprescribingprovidernpinumber,\n\t0 AS drgpaymentamount, -- until field mapping is identified, defaulted to 0\n\t'Retail Pharmacy' AS sourcename,\n\tep.lineofbusiness\nFROM dev_dtx_gc.IC1.CLAIMPHARMACY AS cp\n\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS ep\n\t\tON cp.memberid = ep.memberid\n\t\t\tAND cp.claimprescriptionfilleddate >= ep.episode_start_date\n\t\t\tAND cp.claimprescriptionfilleddate <= ep.episode_end_date\nWHERE cp.claimpharmacylinestatuscode = 'APRVD'\nQUALIFY ROW_NUMBER() OVER (\n\t\tPARTITION BY claimid, claimlinenumber\n\t\tORDER BY episode_start_date DESC\n\t) = 1",
    "raw_code": "{{ config( alias = 'stg_claimpharmacy', schema = 'staging') }}\r\n\r\n\r\nSELECT DISTINCT\r\n\tcp.memberid,\r\n\tep.perf_period_key,\r\n\tep.episode_start_date,\r\n\tep.episode_end_date,\r\n\tcp.claimid,\r\n\tTO_NUMBER(cp.claimpharmacylinenumber) AS claimlinenumber,\r\n\tep.tin AS medicalfacilitytin,\r\n\tCOALESCE(ep.participatingprovidernpi, cp.claimpharmacynationalprovideridentifier, cp.claimpharmacyfacilitynpinumber) AS participatingprovidernpi,\r\n\tcp.claimpharmacyfacilitynpinumber AS claimbillingprovidernpinumber,\r\n\tcp.claimpharmacynationalprovideridentifier AS claimrenderingprovidernpinumber,\r\n\tNULL AS claimextractadjudicationdate,\r\n\t0 AS claimlengthofinpatientstaynumber,\r\n\tNULL AS claimtypeofbillcode,\r\n\tNULL AS claimlinerevenuecode,\r\n\tcp.claimprescriptionfilleddate AS claimlineservicestartdate,\r\n\tNULL AS claimlineserviceenddate,\r\n\tNULL AS claimlinehealthservicecode,\r\n\tNULL AS claimlineproceduremodifier1code,\r\n\tNULL AS claimlineproviderrenderingprovidernetworkidentifier,\r\n\tNULL AS claimlinepatientdischargestatuscode,\r\n\tNULL AS claimlinehealthservicetypecode,\r\n\tNULL AS claimlineplaceofservicecode,\r\n\tNULL AS claimlineprincipaldiagnosiscode,\r\n\tNULL AS avoidablediagnosis,\r\n\tNULL AS avoidableadmissionflag,\r\n\tNULL AS avoidablediagnosisgroup,\r\n\tNULL AS chemotherapytype,\r\n\t'Retail Pharmacy' AS costcategory,\r\n\tNULL AS utilizationcategory,\r\n\tcp.claimpharmacypaidamount AS claimlinepaidamount,\r\n\tcp.claimpharmacyallowedamount AS claimlineallowedamountvalue,\r\n\tCASE WHEN cp.claimpharmacyinnetworkcode = 'IN' THEN 'In Network'\r\n\t\tWHEN cp.claimpharmacyinnetworkcode = 'OUT' THEN 'Out of Network' ELSE 'UnKnown'\r\n\tEND AS inoutnetwork,\r\n\tep.cancerdiagnosisgroupcode,\r\n\tcp.claimpharmacyndccode,\r\n\tcp.claimpharmacygenericproductidentifier,\r\n\tcp.claimpharmacydrugmetricstrengthnumber,\r\n\tcp.claimpharmacydrugmetricunitnumber,\r\n\tcp.claimprescriptionfilleddate,\r\n\tcp.claimpharmacyfilledrefillsnumber,\r\n\tcp.claimpharmacysupplydaysnumber,\r\n\tcp.claimpharmacynationalprovideridentifier,\r\n\tcp.claimprescribingprovidernpinumber,\r\n\t0 AS drgpaymentamount, -- until field mapping is identified, defaulted to 0\r\n\t'Retail Pharmacy' AS sourcename,\r\n\tep.lineofbusiness\r\nFROM {{ source('IC1','CLAIMPHARMACY') }} AS cp\r\n\tINNER JOIN {{ ref('stg_episodes') }} AS ep\r\n\t\tON cp.memberid = ep.memberid\r\n\t\t\tAND cp.claimprescriptionfilleddate >= ep.episode_start_date\r\n\t\t\tAND cp.claimprescriptionfilleddate <= ep.episode_end_date\r\nWHERE cp.claimpharmacylinestatuscode = 'APRVD'\r\nQUALIFY ROW_NUMBER() OVER (\r\n\t\tPARTITION BY claimid, claimlinenumber\r\n\t\tORDER BY episode_start_date DESC\r\n\t) = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_claimpharmacy",
    "description": "All Pharmacy claims",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMLINESERVICESTARTDATE": {
        "name": "CLAIMLINESERVICESTARTDATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MEDICALFACILITYTIN": {
        "name": "MEDICALFACILITYTIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMID": {
        "name": "CLAIMID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMLINENUMBER": {
        "name": "CLAIMLINENUMBER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "COSTCATEGORY": {
        "name": "COSTCATEGORY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "SOURCENAME": {
        "name": "SOURCENAME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LINEOFBUSINESS": {
        "name": "LINEOFBUSINESS",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIMPHARMACY",
        "model.anthem_dev.stg_episodes"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_claims",
    "name": "stg_claims",
    "original_file_path": "models\\staging\\stg_claims.sql",
    "compiled_code": "\n\nWITH fact_claims AS (\n\tSELECT\n\t\tscl.memberid,\n\t\tscl.perf_period_key,\n\t\tscl.episode_start_date,\n\t\tscl.episode_end_date,\n\t\tscl.claimid,\n\t\tscl.claimlinenumber,\n\t\tscl.medicalfacilitytin,\n\t\tscl.participatingprovidernpi,\n\t\tscl.claimbillingprovidernpinumber,\n\t\tscl.claimrenderingprovidernpinumber,\n\t\tscl.claimextractadjudicationdate,\n\t\tscl.claimlengthofinpatientstaynumber,\n\t\tscl.claimtypeofbillcode,\n\t\tscl.claimlinerevenuecode,\n\t\tscl.claimlineservicestartdate,\n\t\tscl.claimlineserviceenddate,\n\t\tscl.claimlinehealthservicecode,\n\t\tscl.claimlineproceduremodifier1code,\n\t\tscl.claimlineproviderrenderingprovidernetworkidentifier,\n\t\tscl.claimlinepatientdischargestatuscode,\n\t\tscl.claimlinehealthservicetypecode,\n\t\tscl.claimlineplaceofservicecode,\n\t\tscl.claimlineprincipaldiagnosiscode,\n\t\tscl.avoidablediagnosis,\n\t\tscl.avoidableadmissionflag,\n\t\tscl.avoidablediagnosisgroup,\n\t\tscl.chemotherapytype,\n\t\tscl.costcategory,\n\t\tscl.utilizationcategory,\n\t\tscl.claimlinepaidamount,\n\t\tscl.claimlineallowedamountvalue,\n\t\tscl.inoutnetwork,\n\t\tscl.cancerdiagnosisgroupcode,\n\t\tscl.claimpharmacyndccode,\n\t\tscl.claimpharmacygenericproductidentifier,\n\t\tscl.claimpharmacydrugmetricstrengthnumber,\n\t\tscl.claimpharmacydrugmetricunitnumber,\n\t\tscl.claimprescriptionfilleddate,\n\t\tscl.claimpharmacyfilledrefillsnumber,\n\t\tscl.claimpharmacysupplydaysnumber,\n\t\tscl.claimpharmacynationalprovideridentifier,\n\t\tscl.claimprescribingprovidernpinumber,\n\t\tscl.drgpaymentamount, -- until field mapping is identified, defaulted to 0\n\t\tscl.sourcename,\n\t\tCONCAT(scl.memberid, '_', scl.medicalfacilitytin) AS memberid_attributedtin,\n\t\tCONCAT(COALESCE(scl.participatingprovidernpi, ''), '_', scl.medicalfacilitytin) AS participatingnpi_attributedtin,\n\t\tCONCAT(COALESCE(scl.claimbillingprovidernpinumber, ''), '_', scl.medicalfacilitytin) AS billingnpi_attributedtin,\n\t\tCONCAT(COALESCE(scl.claimrenderingprovidernpinumber, ''), '_', scl.medicalfacilitytin) AS renderingnpi_attributedtin,\n\t\tCONCAT(COALESCE(scl.claimprescribingprovidernpinumber, ''), '_', scl.medicalfacilitytin) AS prescribingnpi_attributedtin,\n\t\tCONCAT(COALESCE(scl.claimpharmacynationalprovideridentifier, ''), '_', scl.medicalfacilitytin) AS pharmacynpi_attributedtin,\n\t\tCASE WHEN scl.utilizationcategory = 'ED' THEN MIN(scl.claimlineservicestartdate) OVER (PARTITION BY scl.claimid ORDER BY scl.claimlineservicestartdate ASC ) END AS emergencydeptvisitdate,\n\t\tCASE WHEN scl.utilizationcategory = 'ED' AND scl.avoidableadmissionflag = 1 THEN scl.avoidablediagnosis END AS emergencydeptvisitsbyavoidabledx,\n\t\tCASE WHEN scl.utilizationcategory = 'ED' THEN dpp.provider_name END AS emergencydeptvisitsbyattributedoncologist,\n\t\tCASE WHEN scl.utilizationcategory = 'ED' THEN 'Y' ELSE 'N' END AS edutilizationflag,\n\t\tCASE WHEN scl.utilizationcategory = 'ED' AND scl.avoidableadmissionflag = 1 THEN 'Y' ELSE 'N' END AS edavoidableutilizationflag,\n\t\tCASE WHEN scl.utilizationcategory = 'ED' THEN dct.cancertype END AS emergencydeptvisitscancertype,\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' AND scl.avoidableadmissionflag = 1 THEN scl.avoidablediagnosis END AS inpatientadmissionsbyavoidablediagnosis,\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' THEN dpp.provider_name END AS inpatientadmissionsbyattributedoncologist,\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' THEN 'Y' ELSE 'N' END AS iputilizationflag,\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' AND scl.avoidableadmissionflag = 1 THEN 'Y' ELSE 'N' END AS ipavoidableutilizationflag,\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' THEN scl.admission_start_date END AS ipadmitdate,\n\t\tCASE WHEN scl.utilizationcategory IN ('ED', 'Inpatient') THEN 1 ELSE 0 END AS util_pl_flag,\n\t\tscl.lineofbusiness,\n\t\tscl.ipadmissiongroup,\n\t\tCASE \n\t\t\tWHEN icd.concept_code = scl.claimlineprincipaldiagnosiscode THEN icd.concept_code || ' - ' || icd.concept_name\n            WHEN scl.avoidablediagnosis LIKE '%' || scl.claimlineprincipaldiagnosiscode || '%' THEN scl.avoidablediagnosis \n            WHEN scl.claimlineprincipaldiagnosiscode = ssh.code THEN ssh.code || ' - ' || ssh.procedure_description \n            ELSE NULL \n\t\tEND AS diagnosiscodedescription,\n\t\tscl.ipdateid,\n\t\tscl.eddateid,\n\t\tscl.admission_start_date,\n\t\tscl.qualitymeasureindicator\n\tFROM dev_dtx_gc.staging.stg_claimline AS scl\n\tLEFT JOIN dev_dtx_gc.staging.stg_participating_provider AS dpp\n\t\tON CONCAT(COALESCE(scl.participatingprovidernpi, ''), '_', scl.medicalfacilitytin) = dpp.participatingnpi_attributedtin\n\tLEFT JOIN dev_dtx_gc.staging.stg_Cancer_Type AS dct\n\t\tON scl.cancerdiagnosisgroupcode = dct.cancerdiagnosisgroupcode\n\tLEFT JOIN dev_dtx_gc.staging.stg_seed_hcpcs AS ssh ON scl.claimlineprincipaldiagnosiscode = ssh.code\n\tLEFT JOIN dev_dtx_gc.staging.stg_seed_icd10cm_codes AS icd ON scl.claimlineprincipaldiagnosiscode = icd.concept_code\n\n\tUNION ALL\n\n\tSELECT\n\t\tmemberid,\n\t\tperf_period_key,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\tclaimid,\n\t\tclaimlinenumber,\n\t\tmedicalfacilitytin,\n\t\tparticipatingprovidernpi,\n\t\tclaimbillingprovidernpinumber,\n\t\tclaimrenderingprovidernpinumber,\n\t\tclaimextractadjudicationdate,\n\t\tclaimlengthofinpatientstaynumber,\n\t\tclaimtypeofbillcode,\n\t\tclaimlinerevenuecode,\n\t\tclaimlineservicestartdate,\n\t\tclaimlineserviceenddate,\n\t\tclaimlinehealthservicecode,\n\t\tclaimlineproceduremodifier1code,\n\t\tclaimlineproviderrenderingprovidernetworkidentifier,\n\t\tclaimlinepatientdischargestatuscode,\n\t\tclaimlinehealthservicetypecode,\n\t\tclaimlineplaceofservicecode,\n\t\tclaimlineprincipaldiagnosiscode,\n\t\tavoidablediagnosis,\n\t\tavoidableadmissionflag,\n\t\tavoidablediagnosisgroup,\n\t\tchemotherapytype,\n\t\tcostcategory,\n\t\tutilizationcategory,\n\t\tclaimlinepaidamount,\n\t\tclaimlineallowedamountvalue,\n\t\tinoutnetwork,\n\t\tcancerdiagnosisgroupcode,\n\t\tclaimpharmacyndccode,\n\t\tclaimpharmacygenericproductidentifier,\n\t\tclaimpharmacydrugmetricstrengthnumber,\n\t\tclaimpharmacydrugmetricunitnumber,\n\t\tclaimprescriptionfilleddate,\n\t\tclaimpharmacyfilledrefillsnumber,\n\t\tclaimpharmacysupplydaysnumber,\n\t\tclaimpharmacynationalprovideridentifier,\n\t\tclaimprescribingprovidernpinumber,\n\t\tdrgpaymentamount, -- until field mapping is identified, defaulted to 0\n\t\tsourcename,\n\t\tCONCAT(memberid, '_', medicalfacilitytin) AS memberid_attributedtin,\n\t\tCONCAT(COALESCE(participatingprovidernpi, ''), '_', medicalfacilitytin) AS participatingnpi_attributedtin,\n\t\tCONCAT(COALESCE(claimbillingprovidernpinumber, ''), '_', medicalfacilitytin) AS billingnpi_attributedtin,\n\t\tCONCAT(COALESCE(claimrenderingprovidernpinumber, ''), '_', medicalfacilitytin) AS renderingnpi_attributedtin,\n\t\tCONCAT(COALESCE(claimprescribingprovidernpinumber, ''), '_', medicalfacilitytin) AS prescribingnpi_attributedtin,\n\t\tCONCAT(COALESCE(claimpharmacynationalprovideridentifier, ''), '_', medicalfacilitytin) AS pharmacynpi_attributedtin,\n\t\tNULL AS emergencydeptvisitdate,\n\t\tNULL AS emergencydeptvisitsbyavoidabledx,\n\t\tNULL AS emergencydeptvisitsbyattributedoncologist,\n\t\tNULL AS edutilizationflag,\n\t\tNULL AS edavoidableutilizationflag,\n\t\tNULL AS emergencydeptvisitscancertype,\n\t\tNULL AS inpatientadmissionsbyavoidablediagnosis,\n\t\tNULL AS inpatientadmissionsbyattributedoncologist,\n\t\tNULL AS iputilizationflag,\n\t\tNULL AS ipavoidableutilizationflag,\n\t\tNULL AS ipadmitdate,\n\t\t0 AS util_pl_flag,\n\t\tlineofbusiness,\n\t\tNULL AS ipadmissiongroup,\n\t\tNULL AS diagnosiscodedescription,\n\t\tNULL AS ipdateid,\n\t\tNULL AS qualitymeasureindicator,\n\t\tNULL AS eddateid,\n\t\tNULL AS admission_start_date\n\tFROM dev_dtx_gc.staging.stg_claimpharmacy\n\n),\n\npostchemo AS (\n\tSELECT\n\t\tfc.memberid,\n\t\tfc.claimlineservicestartdate,\n\t\tMAX(cs.chemodate) AS recentchemodate,\n\t\tCASE\n\t\t\tWHEN\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\t\t<= 3\n\t\t\t\tTHEN '<=3 days'\n\t\t\t--Only days greater than 3 will pass here\n\t\t\tWHEN\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\t\t<= 7\n\t\t\t\tTHEN '4-7 days'\n\t\t\t--Only days greater than 7 will pass here\n\t\t\tWHEN\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\t\t<= 15\n\t\t\t\tTHEN '8-15 days'\n\t\t\t--Only days greater than 15 will pass here\n\t\t\tWHEN\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\t\t<= 30\n\t\t\t\tTHEN '16-30 days'\n\t\tEND AS postchemodaysbucket,\n\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\tAS postchemodays,\n\t\tCASE\n\t\t\tWHEN\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\t\t<= 3\n\t\t\t\tTHEN 0\n\t\t\t--Only days greater than 3 will pass here\n\t\t\tWHEN\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\t\t<= 7\n\t\t\t\tTHEN 1\n\t\t\t--Only days greater than 7 will pass here\n\t\t\tWHEN\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\t\t<= 15\n\t\t\t\tTHEN 2\n\t\t\t--Only days greater than 15 will pass here\n\t\t\tWHEN\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\n\t\t\t\t<= 30\n\t\t\t\tTHEN 3\n\t\tEND AS postchemodaysbucketsort\n\tFROM fact_claims AS fc\n\t\tINNER JOIN dev_dtx_gc.staging.stg_member_chemotherapy AS cs\n\t\t\tON\n\t\t\t\tfc.memberid = cs.memberid\n\t\t\t\tAND fc.claimlineservicestartdate > cs.chemodate\n\tGROUP BY fc.memberid, fc.claimlineservicestartdate\n),\ngroupon  AS (          -- grouped continuous dates to each admission\n\n\tSELECT\n\t\tmemberid,\n\t\tdateofservice,\n\t\tdateofserviceend,\n\t\tperf_period_key,\n\t\tlineofbusiness,\n\t\tDATEDIFF(\n\t\t\tDAY,\n\t\t\tMIN(dateofservice) OVER (PARTITION BY memberid),\n\t\t\tdateofservice\n\t\t)\n\t\t- ROW_NUMBER() OVER (\n\t\t\tPARTITION BY memberid\n\t\t\tORDER BY dateofservice ASC\n\t\t) AS admissiongroup\n\tFROM dev_dtx_gc.staging.stg_hospice_members \n),\n\nlatesthospiceadmission  AS (            -- picking latest admission\n\n\tSELECT\n\t\tmemberid,\n\t\tperf_period_key,\n\t\tlineofbusiness,\n\t\tadmissiongroup,\n\t\tMIN(dateofservice) AS hospicestart,\n\t\tMAX(dateofserviceend) AS hospiceend,\n\t\tRANK() OVER (\n\t\t\tPARTITION BY memberid\n\t\t\tORDER BY admissiongroup DESC\n\t\t) AS rank\n\tFROM groupon\n\tGROUP BY memberid,\t\n\t\tperf_period_key,\n\t\tlineofbusiness,\n\t\tadmissiongroup\n\tQUALIFY rank=1\n)\n\nSELECT\n\tfc.*,\n\tpc.postchemodaysbucket,\n\tpc.postchemodays,\n\tpc.postchemodaysbucketsort,\n\thm.ishospicemember, --IC:16451 : Used this field in UI filter, To pick only one record per patient per Date. Sorting based on flag respective to ED or IP. \n\thsp.hospicestart,\n\thsp.hospiceend,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tCAST(CASE\n\t\tWHEN fc.costcategory = 'Chemo & Drugs (Medical)' THEN 1\n\t\tWHEN fc.costcategory = 'Retail Pharmacy' THEN 2\n\t\tWHEN fc.costcategory = 'Outpatient' THEN 3\n\t\tWHEN fc.costcategory = 'Inpatient' THEN 4\n\t\tWHEN fc.costcategory = 'Professional' THEN 5\n\t\tWHEN fc.costcategory = 'All other medicals' THEN 6\n\t\tWHEN fc.costcategory = 'Home' THEN 7\n\t\tWHEN fc.costcategory = 'ED' THEN 8\n\t\tWHEN fc.costcategory = 'Ambulatory surgery' THEN 9\n\t\tWHEN fc.costcategory = 'Lab' THEN 10\n\t\tWHEN fc.costcategory = 'Transportation' THEN 11\n\t\tWHEN fc.costcategory = 'Skilled nursing' THEN 12\n\tEND AS number(38, 0)) AS static_costcategory_order,\t\n\tNULL AS ip_rank,\n\tNULL AS ed_rank, --for sorting\t\n\tCOALESCE(ipdateid, eddateid) AS edipdateid,\n\tCASE WHEN edipdateid IS NOT NULL THEN\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY\n\t\t\t\tedipdateid\n\t\t\tORDER BY\n\t\t\t\tfc.util_pl_flag DESC,\n\t\t\t\tCOALESCE(fc.ipavoidableutilizationflag, fc.edavoidableutilizationflag) DESC,\n\t\t\t\tfc.claimlengthofinpatientstaynumber DESC,\n\t\t\t\tadmission_start_date ASC\n\t\t) \n\tEND AS ed_ip_rank,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\n\tCASE WHEN fc.ipdateid IS NOT NULL THEN SUM(fc.claimlineallowedamountvalue) OVER(PARTITION BY fc.ipdateid) ELSE 0 END AS totalipvisitcost,\n\tCASE WHEN fc.eddateid IS NOT NULL THEN SUM(fc.claimlineallowedamountvalue) OVER(PARTITION BY fc.eddateid) ELSE 0 END AS totaledvisitcost,\n\tCASE WHEN fc.ipdateid IS NOT NULL THEN totalipvisitcost WHEN fc.eddateid IS NOT NULL THEN  totaledvisitcost END AS totalvisitcost\nFROM fact_claims AS fc\n\tLEFT JOIN postchemo AS pc\n\t\tON\n\t\t\tfc.memberid = pc.memberid\n\t\t\tAND fc.claimlineservicestartdate = pc.claimlineservicestartdate\n\tLEFT JOIN\n\t\tdev_dtx_gc.staging.stg_member_hospice_mapping AS hm\n\t\tON fc.memberid = hm.memberid AND fc.perf_period_key = hm.perf_period_key AND fc.lineofbusiness = hm.lineofbusiness\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON fc.medicalfacilitytin = map.tin\n\t-- pull latest hospice information\n\tLEFT JOIN latesthospiceadmission as hsp\n\t\tON fc.memberid = hsp.memberid AND fc.perf_period_key = hsp.perf_period_key AND fc.lineofbusiness = hsp.lineofbusiness",
    "raw_code": "{{ config( alias = 'stg_claims', schema = 'staging') }}\r\n\r\nWITH fact_claims AS (\r\n\tSELECT\r\n\t\tscl.memberid,\r\n\t\tscl.perf_period_key,\r\n\t\tscl.episode_start_date,\r\n\t\tscl.episode_end_date,\r\n\t\tscl.claimid,\r\n\t\tscl.claimlinenumber,\r\n\t\tscl.medicalfacilitytin,\r\n\t\tscl.participatingprovidernpi,\r\n\t\tscl.claimbillingprovidernpinumber,\r\n\t\tscl.claimrenderingprovidernpinumber,\r\n\t\tscl.claimextractadjudicationdate,\r\n\t\tscl.claimlengthofinpatientstaynumber,\r\n\t\tscl.claimtypeofbillcode,\r\n\t\tscl.claimlinerevenuecode,\r\n\t\tscl.claimlineservicestartdate,\r\n\t\tscl.claimlineserviceenddate,\r\n\t\tscl.claimlinehealthservicecode,\r\n\t\tscl.claimlineproceduremodifier1code,\r\n\t\tscl.claimlineproviderrenderingprovidernetworkidentifier,\r\n\t\tscl.claimlinepatientdischargestatuscode,\r\n\t\tscl.claimlinehealthservicetypecode,\r\n\t\tscl.claimlineplaceofservicecode,\r\n\t\tscl.claimlineprincipaldiagnosiscode,\r\n\t\tscl.avoidablediagnosis,\r\n\t\tscl.avoidableadmissionflag,\r\n\t\tscl.avoidablediagnosisgroup,\r\n\t\tscl.chemotherapytype,\r\n\t\tscl.costcategory,\r\n\t\tscl.utilizationcategory,\r\n\t\tscl.claimlinepaidamount,\r\n\t\tscl.claimlineallowedamountvalue,\r\n\t\tscl.inoutnetwork,\r\n\t\tscl.cancerdiagnosisgroupcode,\r\n\t\tscl.claimpharmacyndccode,\r\n\t\tscl.claimpharmacygenericproductidentifier,\r\n\t\tscl.claimpharmacydrugmetricstrengthnumber,\r\n\t\tscl.claimpharmacydrugmetricunitnumber,\r\n\t\tscl.claimprescriptionfilleddate,\r\n\t\tscl.claimpharmacyfilledrefillsnumber,\r\n\t\tscl.claimpharmacysupplydaysnumber,\r\n\t\tscl.claimpharmacynationalprovideridentifier,\r\n\t\tscl.claimprescribingprovidernpinumber,\r\n\t\tscl.drgpaymentamount, -- until field mapping is identified, defaulted to 0\r\n\t\tscl.sourcename,\r\n\t\tCONCAT(scl.memberid, '_', scl.medicalfacilitytin) AS memberid_attributedtin,\r\n\t\tCONCAT(COALESCE(scl.participatingprovidernpi, ''), '_', scl.medicalfacilitytin) AS participatingnpi_attributedtin,\r\n\t\tCONCAT(COALESCE(scl.claimbillingprovidernpinumber, ''), '_', scl.medicalfacilitytin) AS billingnpi_attributedtin,\r\n\t\tCONCAT(COALESCE(scl.claimrenderingprovidernpinumber, ''), '_', scl.medicalfacilitytin) AS renderingnpi_attributedtin,\r\n\t\tCONCAT(COALESCE(scl.claimprescribingprovidernpinumber, ''), '_', scl.medicalfacilitytin) AS prescribingnpi_attributedtin,\r\n\t\tCONCAT(COALESCE(scl.claimpharmacynationalprovideridentifier, ''), '_', scl.medicalfacilitytin) AS pharmacynpi_attributedtin,\r\n\t\tCASE WHEN scl.utilizationcategory = 'ED' THEN MIN(scl.claimlineservicestartdate) OVER (PARTITION BY scl.claimid ORDER BY scl.claimlineservicestartdate ASC ) END AS emergencydeptvisitdate,\r\n\t\tCASE WHEN scl.utilizationcategory = 'ED' AND scl.avoidableadmissionflag = 1 THEN scl.avoidablediagnosis END AS emergencydeptvisitsbyavoidabledx,\r\n\t\tCASE WHEN scl.utilizationcategory = 'ED' THEN dpp.provider_name END AS emergencydeptvisitsbyattributedoncologist,\r\n\t\tCASE WHEN scl.utilizationcategory = 'ED' THEN 'Y' ELSE 'N' END AS edutilizationflag,\r\n\t\tCASE WHEN scl.utilizationcategory = 'ED' AND scl.avoidableadmissionflag = 1 THEN 'Y' ELSE 'N' END AS edavoidableutilizationflag,\r\n\t\tCASE WHEN scl.utilizationcategory = 'ED' THEN dct.cancertype END AS emergencydeptvisitscancertype,\r\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' AND scl.avoidableadmissionflag = 1 THEN scl.avoidablediagnosis END AS inpatientadmissionsbyavoidablediagnosis,\r\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' THEN dpp.provider_name END AS inpatientadmissionsbyattributedoncologist,\r\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' THEN 'Y' ELSE 'N' END AS iputilizationflag,\r\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' AND scl.avoidableadmissionflag = 1 THEN 'Y' ELSE 'N' END AS ipavoidableutilizationflag,\r\n\t\tCASE WHEN scl.utilizationcategory = 'Inpatient' THEN scl.admission_start_date END AS ipadmitdate,\r\n\t\tCASE WHEN scl.utilizationcategory IN ('ED', 'Inpatient') THEN 1 ELSE 0 END AS util_pl_flag,\r\n\t\tscl.lineofbusiness,\r\n\t\tscl.ipadmissiongroup,\r\n\t\tCASE \r\n\t\t\tWHEN icd.concept_code = scl.claimlineprincipaldiagnosiscode THEN icd.concept_code || ' - ' || icd.concept_name\r\n            WHEN scl.avoidablediagnosis LIKE '%' || scl.claimlineprincipaldiagnosiscode || '%' THEN scl.avoidablediagnosis \r\n            WHEN scl.claimlineprincipaldiagnosiscode = ssh.code THEN ssh.code || ' - ' || ssh.procedure_description \r\n            ELSE NULL \r\n\t\tEND AS diagnosiscodedescription,\r\n\t\tscl.ipdateid,\r\n\t\tscl.eddateid,\r\n\t\tscl.admission_start_date,\r\n\t\tscl.qualitymeasureindicator\r\n\tFROM {{ ref('stg_claimline') }} AS scl\r\n\tLEFT JOIN {{ ref('stg_participating_provider') }} AS dpp\r\n\t\tON CONCAT(COALESCE(scl.participatingprovidernpi, ''), '_', scl.medicalfacilitytin) = dpp.participatingnpi_attributedtin\r\n\tLEFT JOIN {{ ref('stg_cancer_type') }} AS dct\r\n\t\tON scl.cancerdiagnosisgroupcode = dct.cancerdiagnosisgroupcode\r\n\tLEFT JOIN {{ ref('stg_seed_hcpcs') }} AS ssh ON scl.claimlineprincipaldiagnosiscode = ssh.code\r\n\tLEFT JOIN {{ ref('stg_seed_icd10cm_codes') }} AS icd ON scl.claimlineprincipaldiagnosiscode = icd.concept_code\r\n\r\n\tUNION ALL\r\n\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\tperf_period_key,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\tclaimid,\r\n\t\tclaimlinenumber,\r\n\t\tmedicalfacilitytin,\r\n\t\tparticipatingprovidernpi,\r\n\t\tclaimbillingprovidernpinumber,\r\n\t\tclaimrenderingprovidernpinumber,\r\n\t\tclaimextractadjudicationdate,\r\n\t\tclaimlengthofinpatientstaynumber,\r\n\t\tclaimtypeofbillcode,\r\n\t\tclaimlinerevenuecode,\r\n\t\tclaimlineservicestartdate,\r\n\t\tclaimlineserviceenddate,\r\n\t\tclaimlinehealthservicecode,\r\n\t\tclaimlineproceduremodifier1code,\r\n\t\tclaimlineproviderrenderingprovidernetworkidentifier,\r\n\t\tclaimlinepatientdischargestatuscode,\r\n\t\tclaimlinehealthservicetypecode,\r\n\t\tclaimlineplaceofservicecode,\r\n\t\tclaimlineprincipaldiagnosiscode,\r\n\t\tavoidablediagnosis,\r\n\t\tavoidableadmissionflag,\r\n\t\tavoidablediagnosisgroup,\r\n\t\tchemotherapytype,\r\n\t\tcostcategory,\r\n\t\tutilizationcategory,\r\n\t\tclaimlinepaidamount,\r\n\t\tclaimlineallowedamountvalue,\r\n\t\tinoutnetwork,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tclaimpharmacyndccode,\r\n\t\tclaimpharmacygenericproductidentifier,\r\n\t\tclaimpharmacydrugmetricstrengthnumber,\r\n\t\tclaimpharmacydrugmetricunitnumber,\r\n\t\tclaimprescriptionfilleddate,\r\n\t\tclaimpharmacyfilledrefillsnumber,\r\n\t\tclaimpharmacysupplydaysnumber,\r\n\t\tclaimpharmacynationalprovideridentifier,\r\n\t\tclaimprescribingprovidernpinumber,\r\n\t\tdrgpaymentamount, -- until field mapping is identified, defaulted to 0\r\n\t\tsourcename,\r\n\t\tCONCAT(memberid, '_', medicalfacilitytin) AS memberid_attributedtin,\r\n\t\tCONCAT(COALESCE(participatingprovidernpi, ''), '_', medicalfacilitytin) AS participatingnpi_attributedtin,\r\n\t\tCONCAT(COALESCE(claimbillingprovidernpinumber, ''), '_', medicalfacilitytin) AS billingnpi_attributedtin,\r\n\t\tCONCAT(COALESCE(claimrenderingprovidernpinumber, ''), '_', medicalfacilitytin) AS renderingnpi_attributedtin,\r\n\t\tCONCAT(COALESCE(claimprescribingprovidernpinumber, ''), '_', medicalfacilitytin) AS prescribingnpi_attributedtin,\r\n\t\tCONCAT(COALESCE(claimpharmacynationalprovideridentifier, ''), '_', medicalfacilitytin) AS pharmacynpi_attributedtin,\r\n\t\tNULL AS emergencydeptvisitdate,\r\n\t\tNULL AS emergencydeptvisitsbyavoidabledx,\r\n\t\tNULL AS emergencydeptvisitsbyattributedoncologist,\r\n\t\tNULL AS edutilizationflag,\r\n\t\tNULL AS edavoidableutilizationflag,\r\n\t\tNULL AS emergencydeptvisitscancertype,\r\n\t\tNULL AS inpatientadmissionsbyavoidablediagnosis,\r\n\t\tNULL AS inpatientadmissionsbyattributedoncologist,\r\n\t\tNULL AS iputilizationflag,\r\n\t\tNULL AS ipavoidableutilizationflag,\r\n\t\tNULL AS ipadmitdate,\r\n\t\t0 AS util_pl_flag,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS ipadmissiongroup,\r\n\t\tNULL AS diagnosiscodedescription,\r\n\t\tNULL AS ipdateid,\r\n\t\tNULL AS qualitymeasureindicator,\r\n\t\tNULL AS eddateid,\r\n\t\tNULL AS admission_start_date\r\n\tFROM {{ ref('stg_claimpharmacy') }}\r\n\r\n),\r\n\r\npostchemo AS (\r\n\tSELECT\r\n\t\tfc.memberid,\r\n\t\tfc.claimlineservicestartdate,\r\n\t\tMAX(cs.chemodate) AS recentchemodate,\r\n\t\tCASE\r\n\t\t\tWHEN\r\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\t\t<= 3\r\n\t\t\t\tTHEN '<=3 days'\r\n\t\t\t--Only days greater than 3 will pass here\r\n\t\t\tWHEN\r\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\t\t<= 7\r\n\t\t\t\tTHEN '4-7 days'\r\n\t\t\t--Only days greater than 7 will pass here\r\n\t\t\tWHEN\r\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\t\t<= 15\r\n\t\t\t\tTHEN '8-15 days'\r\n\t\t\t--Only days greater than 15 will pass here\r\n\t\t\tWHEN\r\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\t\t<= 30\r\n\t\t\t\tTHEN '16-30 days'\r\n\t\tEND AS postchemodaysbucket,\r\n\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\tAS postchemodays,\r\n\t\tCASE\r\n\t\t\tWHEN\r\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\t\t<= 3\r\n\t\t\t\tTHEN 0\r\n\t\t\t--Only days greater than 3 will pass here\r\n\t\t\tWHEN\r\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\t\t<= 7\r\n\t\t\t\tTHEN 1\r\n\t\t\t--Only days greater than 7 will pass here\r\n\t\t\tWHEN\r\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\t\t<= 15\r\n\t\t\t\tTHEN 2\r\n\t\t\t--Only days greater than 15 will pass here\r\n\t\t\tWHEN\r\n\t\t\t\tDATEDIFF(DAY, MAX(cs.chemodate), fc.claimlineservicestartdate)\r\n\t\t\t\t<= 30\r\n\t\t\t\tTHEN 3\r\n\t\tEND AS postchemodaysbucketsort\r\n\tFROM fact_claims AS fc\r\n\t\tINNER JOIN {{ ref('stg_member_chemotherapy') }} AS cs\r\n\t\t\tON\r\n\t\t\t\tfc.memberid = cs.memberid\r\n\t\t\t\tAND fc.claimlineservicestartdate > cs.chemodate\r\n\tGROUP BY fc.memberid, fc.claimlineservicestartdate\r\n),\r\ngroupon  AS (          -- grouped continuous dates to each admission\r\n\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\tdateofservice,\r\n\t\tdateofserviceend,\r\n\t\tperf_period_key,\r\n\t\tlineofbusiness,\r\n\t\tDATEDIFF(\r\n\t\t\tDAY,\r\n\t\t\tMIN(dateofservice) OVER (PARTITION BY memberid),\r\n\t\t\tdateofservice\r\n\t\t)\r\n\t\t- ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY memberid\r\n\t\t\tORDER BY dateofservice ASC\r\n\t\t) AS admissiongroup\r\n\tFROM {{ ref('stg_hospice_members') }} \r\n),\r\n\r\nlatesthospiceadmission  AS (            -- picking latest admission\r\n\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\tperf_period_key,\r\n\t\tlineofbusiness,\r\n\t\tadmissiongroup,\r\n\t\tMIN(dateofservice) AS hospicestart,\r\n\t\tMAX(dateofserviceend) AS hospiceend,\r\n\t\tRANK() OVER (\r\n\t\t\tPARTITION BY memberid\r\n\t\t\tORDER BY admissiongroup DESC\r\n\t\t) AS rank\r\n\tFROM groupon\r\n\tGROUP BY memberid,\t\r\n\t\tperf_period_key,\r\n\t\tlineofbusiness,\r\n\t\tadmissiongroup\r\n\tQUALIFY rank=1\r\n)\r\n\r\nSELECT\r\n\tfc.*,\r\n\tpc.postchemodaysbucket,\r\n\tpc.postchemodays,\r\n\tpc.postchemodaysbucketsort,\r\n\thm.ishospicemember, --IC:16451 : Used this field in UI filter, To pick only one record per patient per Date. Sorting based on flag respective to ED or IP. \r\n\thsp.hospicestart,\r\n\thsp.hospiceend,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tCAST(CASE\r\n\t\tWHEN fc.costcategory = 'Chemo & Drugs (Medical)' THEN 1\r\n\t\tWHEN fc.costcategory = 'Retail Pharmacy' THEN 2\r\n\t\tWHEN fc.costcategory = 'Outpatient' THEN 3\r\n\t\tWHEN fc.costcategory = 'Inpatient' THEN 4\r\n\t\tWHEN fc.costcategory = 'Professional' THEN 5\r\n\t\tWHEN fc.costcategory = 'All other medicals' THEN 6\r\n\t\tWHEN fc.costcategory = 'Home' THEN 7\r\n\t\tWHEN fc.costcategory = 'ED' THEN 8\r\n\t\tWHEN fc.costcategory = 'Ambulatory surgery' THEN 9\r\n\t\tWHEN fc.costcategory = 'Lab' THEN 10\r\n\t\tWHEN fc.costcategory = 'Transportation' THEN 11\r\n\t\tWHEN fc.costcategory = 'Skilled nursing' THEN 12\r\n\tEND AS number(38, 0)) AS static_costcategory_order,\t\r\n\tNULL AS ip_rank,\r\n\tNULL AS ed_rank, --for sorting\t\r\n\tCOALESCE(ipdateid, eddateid) AS edipdateid,\r\n\tCASE WHEN edipdateid IS NOT NULL THEN\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY\r\n\t\t\t\tedipdateid\r\n\t\t\tORDER BY\r\n\t\t\t\tfc.util_pl_flag DESC,\r\n\t\t\t\tCOALESCE(fc.ipavoidableutilizationflag, fc.edavoidableutilizationflag) DESC,\r\n\t\t\t\tfc.claimlengthofinpatientstaynumber DESC,\r\n\t\t\t\tadmission_start_date ASC\r\n\t\t) \r\n\tEND AS ed_ip_rank,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\r\n\tCASE WHEN fc.ipdateid IS NOT NULL THEN SUM(fc.claimlineallowedamountvalue) OVER(PARTITION BY fc.ipdateid) ELSE 0 END AS totalipvisitcost,\r\n\tCASE WHEN fc.eddateid IS NOT NULL THEN SUM(fc.claimlineallowedamountvalue) OVER(PARTITION BY fc.eddateid) ELSE 0 END AS totaledvisitcost,\r\n\tCASE WHEN fc.ipdateid IS NOT NULL THEN totalipvisitcost WHEN fc.eddateid IS NOT NULL THEN  totaledvisitcost END AS totalvisitcost\r\nFROM fact_claims AS fc\r\n\tLEFT JOIN postchemo AS pc\r\n\t\tON\r\n\t\t\tfc.memberid = pc.memberid\r\n\t\t\tAND fc.claimlineservicestartdate = pc.claimlineservicestartdate\r\n\tLEFT JOIN\r\n\t\t{{ ref('stg_member_hospice_mapping') }} AS hm\r\n\t\tON fc.memberid = hm.memberid AND fc.perf_period_key = hm.perf_period_key AND fc.lineofbusiness = hm.lineofbusiness\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON fc.medicalfacilitytin = map.tin\r\n\t-- pull latest hospice information\r\n\tLEFT JOIN latesthospiceadmission as hsp\r\n\t\tON fc.memberid = hsp.memberid AND fc.perf_period_key = hsp.perf_period_key AND fc.lineofbusiness = hsp.lineofbusiness",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_claims",
    "description": "Fact Member Quality Measures",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMID": {
        "name": "CLAIMID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMLINENUMBER": {
        "name": "CLAIMLINENUMBER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLAIMLINESERVICESTARTDATE": {
        "name": "CLAIMLINESERVICESTARTDATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "COSTCATEGORY": {
        "name": "COSTCATEGORY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "STATIC_COSTCATEGORY_ORDER": {
        "name": "STATIC_COSTCATEGORY_ORDER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "SOURCENAME": {
        "name": "SOURCENAME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LINEOFBUSINESS": {
        "name": "LINEOFBUSINESS",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ISHOSPICEMEMBER": {
        "name": "ISHOSPICEMEMBER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_claimline",
        "model.anthem_dev.stg_participating_provider",
        "model.anthem_dev.stg_cancer_type",
        "model.anthem_dev.stg_seed_hcpcs",
        "model.anthem_dev.stg_seed_icd10cm_codes",
        "model.anthem_dev.stg_claimpharmacy",
        "model.anthem_dev.stg_member_chemotherapy",
        "model.anthem_dev.stg_hospice_members",
        "model.anthem_dev.stg_member_hospice_mapping",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_claims_ed_to_ip",
    "name": "stg_claims_ed_to_ip",
    "original_file_path": "models\\staging\\stg_claims_ed_to_ip.sql",
    "compiled_code": "\n\n\nWITH transedtoip AS (\n\tSELECT DISTINCT\n\t\tcl.claimlineservicestartdate,\n\t\tc.memberid\n\tFROM dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\tINNER JOIN dev_dtx_gc.IC1.CLAIM AS c\n\t\t\tON cl.claimid = c.claimid\n\tWHERE cl.claimlinerevenuecode between '0100' AND '0249'\n)\n\nSELECT DISTINCT\n\tc.claimid,\n\tc.memberid,\n\tcl.claimlineid\nFROM dev_dtx_gc.IC1.CLAIMLINE AS cl\n\tINNER JOIN dev_dtx_gc.IC1.CLAIM AS c\n\t\tON cl.claimid = c.claimid\n\tINNER JOIN transedtoip AS edtoip\n\t\tON\n\t\t\tc.memberid = edtoip.memberid\n\t\t\tAND cl.claimlineservicestartdate = edtoip.claimlineservicestartdate\nWHERE\n\tcl.claimlineplaceofservicecode IN (22, 23)\n\tAND (\n\t\tcl.claimlinerevenuecode\n\t\tIN (\n\t\t\t'0450',\n\t\t\t'0451',\n\t\t\t'0452',\n\t\t\t'0453',\n\t\t\t'0454',\n\t\t\t'0455',\n\t\t\t'0457',\n\t\t\t'0458',\n\t\t\t'0459'\n\t\t)\n\t\tOR (\n\t\t\tcl.claimlinerevenuecode = '0456'\n\t\t\tAND cl.claimlinehealthservicecode IN (\n\t\t\t\t'99281', '99282', '99283', '99284', '99285'\n\t\t\t)\n\t\t)\n\t)",
    "raw_code": "{{ config( alias = 'stg_claims_ed_to_ip', schema = 'staging') }}\r\n\r\n\r\nWITH transedtoip AS (\r\n\tSELECT DISTINCT\r\n\t\tcl.claimlineservicestartdate,\r\n\t\tc.memberid\r\n\tFROM {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\tINNER JOIN {{ source('IC1','CLAIM') }} AS c\r\n\t\t\tON cl.claimid = c.claimid\r\n\tWHERE cl.claimlinerevenuecode between '0100' AND '0249'\r\n)\r\n\r\nSELECT DISTINCT\r\n\tc.claimid,\r\n\tc.memberid,\r\n\tcl.claimlineid\r\nFROM {{ source('IC1','CLAIMLINE') }} AS cl\r\n\tINNER JOIN {{ source('IC1','CLAIM') }} AS c\r\n\t\tON cl.claimid = c.claimid\r\n\tINNER JOIN transedtoip AS edtoip\r\n\t\tON\r\n\t\t\tc.memberid = edtoip.memberid\r\n\t\t\tAND cl.claimlineservicestartdate = edtoip.claimlineservicestartdate\r\nWHERE\r\n\tcl.claimlineplaceofservicecode IN (22, 23)\r\n\tAND (\r\n\t\tcl.claimlinerevenuecode\r\n\t\tIN (\r\n\t\t\t'0450',\r\n\t\t\t'0451',\r\n\t\t\t'0452',\r\n\t\t\t'0453',\r\n\t\t\t'0454',\r\n\t\t\t'0455',\r\n\t\t\t'0457',\r\n\t\t\t'0458',\r\n\t\t\t'0459'\r\n\t\t)\r\n\t\tOR (\r\n\t\t\tcl.claimlinerevenuecode = '0456'\r\n\t\t\tAND cl.claimlinehealthservicecode IN (\r\n\t\t\t\t'99281', '99282', '99283', '99284', '99285'\r\n\t\t\t)\r\n\t\t)\r\n\t)",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_claims_ed_to_ip",
    "description": "Derive claims which move from ED to IP with in 24 hrs",
    "columns": {
      "memberid": {
        "name": "memberid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "claimid": {
        "name": "claimid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "claimlineid": {
        "name": "claimlineid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMLINE"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_client_tin_mapping",
    "name": "stg_client_tin_mapping",
    "original_file_path": "models\\staging\\stg_client_tin_mapping.sql",
    "compiled_code": "\n\nWITH group_tin AS (\n\tSELECT\n\t\tmap.groupid AS role,\n\t\tmap.individualid AS tin,\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY tin\n\t\t\tORDER BY role\n\t\t) AS group_number,\n\t\tCASE WHEN group_number = 1 THEN role END AS tin_group_1,\n\t\tCASE WHEN group_number = 2 THEN role END AS tin_group_2,\n\t\tCASE WHEN group_number = 3 THEN role END AS tin_group_3\n\tFROM DEV_INTELLIGENCE_WEB.IC_TO_ANTHEM.ANTHEM_CLIENT_TIN_MAPPING AS map\n)\n\nSELECT\n\tgt.tin,\n\tMAX(gt.tin_group_1) AS tin_group_1,\n\tMAX(gt.tin_group_2) AS tin_group_2,\n\tMAX(gt.tin_group_3) AS tin_group_3\nFROM group_tin AS gt\nGROUP BY gt.tin",
    "raw_code": "{{ config( alias = 'stg_client_tin_mapping', schema = 'staging') }}\r\n\r\nWITH group_tin AS (\r\n\tSELECT\r\n\t\tmap.groupid AS role,\r\n\t\tmap.individualid AS tin,\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY tin\r\n\t\t\tORDER BY role\r\n\t\t) AS group_number,\r\n\t\tCASE WHEN group_number = 1 THEN role END AS tin_group_1,\r\n\t\tCASE WHEN group_number = 2 THEN role END AS tin_group_2,\r\n\t\tCASE WHEN group_number = 3 THEN role END AS tin_group_3\r\n\tFROM {{ source('INTELLIGENCE_WEB','ANTHEM_CLIENT_TIN_MAPPING') }} AS map\r\n)\r\n\r\nSELECT\r\n\tgt.tin,\r\n\tMAX(gt.tin_group_1) AS tin_group_1,\r\n\tMAX(gt.tin_group_2) AS tin_group_2,\r\n\tMAX(gt.tin_group_3) AS tin_group_3\r\nFROM group_tin AS gt\r\nGROUP BY gt.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_client_tin_mapping",
    "description": "",
    "columns": {},
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.INTELLIGENCE_WEB.ANTHEM_CLIENT_TIN_MAPPING"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_comorbidity",
    "name": "stg_comorbidity",
    "original_file_path": "models\\staging\\stg_comorbidity.sql",
    "compiled_code": "\n-- get base population - any member who has a diagnosis on \n\nWITH comorbidity AS (\n\nSELECT DISTINCT\n\tc.memberid,\n\te.perf_period_key,\n\te.episode_start_date,\n\te.episode_end_date,\n\tDATE_TRUNC(MONTH, cl.claimlineservicestartdate) AS contextdate,\n\tc.claimid,\n\tTO_NUMBER(cl.claimlinenumber) AS claimlinenumber,\n\tcld.diagnosiscode,\n\te.tin AS attributedprovidertaxid,\n\te.participatingprovidernpi,\n\tcl.claimlineservicestartdate,\n\te.customcancercode,\n\te.cancerdiagnosisgroupcode,\n\te.lineofbusiness,\n\tcdh.comorbidity_diagnosis_code,\n\tcdh.comorbidity || cdh.comorbidity_diagnosis_code || COALESCE(cdh.hcc_code, '') || COALESCE(cdh.rxhcc_code, '') AS comorbidity_key\nFROM dev_dtx_gc.IC1.CLAIMLINE AS cl\n\tINNER JOIN dev_dtx_gc.IC1.CLAIM AS c\n\t\tON cl.claimid = c.claimid\n\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS e\n\t\tON c.memberid = e.memberid\n\t\t\tAND cl.claimlineservicestartdate >= e.episode_start_date\n\t\t\tAND cl.claimlineservicestartdate <= e.episode_end_date\n\tINNER JOIN dev_dtx_gc.IC1.CLAIMLINEDIAGNOSIS AS cld\n\t\tON cl.claimid = cld.claimid\n\t\t\tAND cl.claimlineid = cld.claimlineid\n\tINNER JOIN dev_dtx_gc.staging.stg_comorbidtiy_diagnosis_hcc AS cdh\n\t\tON cld.diagnosiscode = cdh.comorbidity_diagnosis_code\n)\n\nSELECT\n\tsc.*,\n\thm.ishospicemember,\n\tCONCAT(sc.memberid, '_', sc.attributedprovidertaxid) AS memberid_attributedtin,\n\tCONCAT(COALESCE(sc.participatingprovidernpi, ''), '_', sc.attributedprovidertaxid) AS participatingnpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3\nFROM comorbidity AS sc\n\tLEFT JOIN dev_dtx_gc.staging.stg_member_hospice_mapping AS hm\n\t\tON sc.memberid = hm.memberid AND sc.perf_period_key = hm.perf_period_key AND sc.lineofbusiness = hm.lineofbusiness\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON sc.attributedprovidertaxid = map.tin",
    "raw_code": "{{ config( alias = 'stg_comorbidity', schema = 'staging') }}\r\n-- get base population - any member who has a diagnosis on \r\n\r\nWITH comorbidity AS (\r\n\r\nSELECT DISTINCT\r\n\tc.memberid,\r\n\te.perf_period_key,\r\n\te.episode_start_date,\r\n\te.episode_end_date,\r\n\tDATE_TRUNC(MONTH, cl.claimlineservicestartdate) AS contextdate,\r\n\tc.claimid,\r\n\tTO_NUMBER(cl.claimlinenumber) AS claimlinenumber,\r\n\tcld.diagnosiscode,\r\n\te.tin AS attributedprovidertaxid,\r\n\te.participatingprovidernpi,\r\n\tcl.claimlineservicestartdate,\r\n\te.customcancercode,\r\n\te.cancerdiagnosisgroupcode,\r\n\te.lineofbusiness,\r\n\tcdh.comorbidity_diagnosis_code,\r\n\tcdh.comorbidity || cdh.comorbidity_diagnosis_code || COALESCE(cdh.hcc_code, '') || COALESCE(cdh.rxhcc_code, '') AS comorbidity_key\r\nFROM {{ source('IC1','CLAIMLINE') }} AS cl\r\n\tINNER JOIN {{ source('IC1','CLAIM') }} AS c\r\n\t\tON cl.claimid = c.claimid\r\n\tINNER JOIN {{ ref('stg_episodes') }} AS e\r\n\t\tON c.memberid = e.memberid\r\n\t\t\tAND cl.claimlineservicestartdate >= e.episode_start_date\r\n\t\t\tAND cl.claimlineservicestartdate <= e.episode_end_date\r\n\tINNER JOIN {{ source('IC1','CLAIMLINEDIAGNOSIS') }} AS cld\r\n\t\tON cl.claimid = cld.claimid\r\n\t\t\tAND cl.claimlineid = cld.claimlineid\r\n\tINNER JOIN {{ ref('stg_comorbidtiy_diagnosis_hcc') }} AS cdh\r\n\t\tON cld.diagnosiscode = cdh.comorbidity_diagnosis_code\r\n)\r\n\r\nSELECT\r\n\tsc.*,\r\n\thm.ishospicemember,\r\n\tCONCAT(sc.memberid, '_', sc.attributedprovidertaxid) AS memberid_attributedtin,\r\n\tCONCAT(COALESCE(sc.participatingprovidernpi, ''), '_', sc.attributedprovidertaxid) AS participatingnpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3\r\nFROM comorbidity AS sc\r\n\tLEFT JOIN {{ ref('stg_member_hospice_mapping') }} AS hm\r\n\t\tON sc.memberid = hm.memberid AND sc.perf_period_key = hm.perf_period_key AND sc.lineofbusiness = hm.lineofbusiness\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON sc.attributedprovidertaxid = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_comorbidity",
    "description": "",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "perf_period_key": {
        "name": "perf_period_key",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "claimid": {
        "name": "claimid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "claimlinenumber": {
        "name": "claimlinenumber",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": [],
        "test": [
          "not_null"
        ]
      },
      "diagnosiscode": {
        "name": "diagnosiscode",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": [],
        "test": [
          "not_null"
        ]
      },
      "attributedprovidertaxid": {
        "name": "attributedprovidertaxid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "participatingprovidernpi": {
        "name": "participatingprovidernpi",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "claimlineservicestartdate": {
        "name": "claimlineservicestartdate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episode_start_date": {
        "name": "episode_start_date",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episode_end_date": {
        "name": "episode_end_date",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "customcancercode": {
        "name": "customcancercode",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "cancerdiagnosisgroupcode": {
        "name": "cancerdiagnosisgroupcode",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "COMORBIDITY_key": {
        "name": "COMORBIDITY_key",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LINEOFBUSINESS": {
        "name": "LINEOFBUSINESS",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ISHOSPICEMEMBER": {
        "name": "ISHOSPICEMEMBER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMLINEDIAGNOSIS",
        "source.anthem_dev.IC1.CLAIMLINE",
        "model.anthem_dev.stg_episodes",
        "model.anthem_dev.stg_comorbidtiy_diagnosis_hcc",
        "model.anthem_dev.stg_member_hospice_mapping",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_comorbidtiy_diagnosis_hcc",
    "name": "stg_comorbidtiy_diagnosis_hcc",
    "original_file_path": "models\\staging\\stg_comorbidtiy_diagnosis_hcc.sql",
    "compiled_code": "\n/*\n    The result of this transform will provide a table, with structure:\n        COMORBIDITY\n        ,COMORBIDITY_DIAGNOSIS_CODE\n        ,HCC_CODEs AS HCC_CODE\n        ,HCC_CODES AS RxHCC_CODE,\n        ,EFFECTIVE_START_DATE\n        ,Effective_End_Date\n\n    Any Cormbidity/Diagnosis pairs that have both HCC and RxHCC will be in one row.\n    All Others will have a blank HHC code or blank RxHCC code\n\n*/\n\n-- first get the all the diagnosis and comorbidities that match up\n\nWITH comorbidity_diagnosis_matches AS (\n\tSELECT DISTINCT\n\t\tc.comorbidity,\n\t\th.description,\n\t\th.diagnosis_code AS comorbidity_diagnosis_code,\n\t\th.hcc_codes\n\tFROM dev_dtx_gc.staging.stg_seed_comorbidtiy_hcc AS c\n\t\tINNER JOIN dev_dtx_gc.staging.stg_hcc_mapping AS h\n\t\t\tON c.hcc_codes = h.hcc_codes\n),\n-- find by Comorbidity the Diagnosis that have both HCC codes and RxHcc codes so they can be deplayed together\n-- Comorbidity_Diagnosis_has_HCC_and has the structure we want to end up with\n\ncomorbidity_diagnosis_has_hcc_and_rxhcc AS (\n\tSELECT DISTINCT\n\t\th.comorbidity,\n\t\th.description,\n\t\th.comorbidity_diagnosis_code,\n\t\th.hcc_codes AS hcc_code,\n\t\tr.hcc_codes AS rxhcc_code\n\tFROM dev_dtx_gc.staging.stg_seed_hcc_mapping_hcc_and_rxhcc AS s\n\t\tINNER JOIN comorbidity_diagnosis_matches AS h\n\t\t\tON\n\t\t\t\ts.diagnosis_code = h.comorbidity_diagnosis_code\n\t\t\t\tAND s.hcc_code = h.hcc_codes\n\t\tINNER JOIN\n\t\t\tcomorbidity_diagnosis_matches\n\t\t\t\tAS r\n\t\t\tON s.diagnosis_code = r.comorbidity_diagnosis_code\n\t\t\t\tAND s.rxhcc_code = r.hcc_codes\n\t\t\t\tAND h.comorbidity = r.comorbidity\n),\n\n-- now we need to get the rest of the \"Comorbidity_Diagnosis_Matches\" that did not have both HCC and RxHCC code\n-- this is done but putting Comorbidity_Diagnosis_has_HCC_and_RxHCC back into the form of Comorbidity_Diagnosis_Matches\n-- then do an except\nhcc_and_rxhcc AS (\n\n\tSELECT\n\t\tcomorbidity,\n\t\tdescription,\n\t\tcomorbidity_diagnosis_code,\n\t\thcc_code\n\tFROM comorbidity_diagnosis_has_hcc_and_rxhcc\n\tUNION DISTINCT\n\tSELECT\n\t\tcomorbidity,\n\t\tdescription,\n\t\tcomorbidity_diagnosis_code,\n\t\trxhcc_code AS hcc_code\n\tFROM comorbidity_diagnosis_has_hcc_and_rxhcc\n),\n\n-- now an except is done to remove the matches with both HCC and RXHCC\ncomorbidity_diagnosis_single_hcc_or_rxhcc AS (\n\tSELECT\n\t\tcomorbidity,\n\t\tdescription,\n\t\tcomorbidity_diagnosis_code,\n\t\thcc_codes\n\tFROM comorbidity_diagnosis_matches\n\tEXCEPT\n\tSELECT\n\t\tcomorbidity,\n\t\tdescription,\n\t\tcomorbidity_diagnosis_code,\n\t\thcc_code\n\tFROM hcc_and_rxhcc\n\n),\n\nalltogether AS (\n\tSELECT\n\t\tcomorbidity,\n\t\tdescription,\n\t\tcomorbidity_diagnosis_code,\n\t\tIFF(hcc_codes LIKE 'HCC%', hcc_codes,NULL) AS hcc_code,\n\t\tIFF(hcc_codes LIKE 'RxHCC%', hcc_codes,NULL) AS rxhcc_code\n\tFROM comorbidity_diagnosis_single_hcc_or_rxhcc\n\tUNION DISTINCT\n\tSELECT\n\t\tcomorbidity,\n\t\tdescription,\n\t\tcomorbidity_diagnosis_code,\n\t\thcc_code,\n\t\trxhcc_code\n\tFROM comorbidity_diagnosis_has_hcc_and_rxhcc\n\n)\n\nSELECT *,\n\tcomorbidity\n\t|| comorbidity_diagnosis_code\n\t|| COALESCE(hcc_code, '')\n\t|| COALESCE(rxhcc_code, '') AS comorbidity_key\nFROM alltogether",
    "raw_code": "{{ config( alias = 'stg_comorbidtiy_diagnosis_hcc', schema = 'staging') }}\r\n/*\r\n    The result of this transform will provide a table, with structure:\r\n        COMORBIDITY\r\n        ,COMORBIDITY_DIAGNOSIS_CODE\r\n        ,HCC_CODEs AS HCC_CODE\r\n        ,HCC_CODES AS RxHCC_CODE,\r\n        ,EFFECTIVE_START_DATE\r\n        ,Effective_End_Date\r\n\r\n    Any Cormbidity/Diagnosis pairs that have both HCC and RxHCC will be in one row.\r\n    All Others will have a blank HHC code or blank RxHCC code\r\n\r\n*/\r\n\r\n-- first get the all the diagnosis and comorbidities that match up\r\n\r\nWITH comorbidity_diagnosis_matches AS (\r\n\tSELECT DISTINCT\r\n\t\tc.comorbidity,\r\n\t\th.description,\r\n\t\th.diagnosis_code AS comorbidity_diagnosis_code,\r\n\t\th.hcc_codes\r\n\tFROM {{ ref('stg_seed_comorbidtiy_hcc') }} AS c\r\n\t\tINNER JOIN {{ ref('stg_hcc_mapping') }} AS h\r\n\t\t\tON c.hcc_codes = h.hcc_codes\r\n),\r\n-- find by Comorbidity the Diagnosis that have both HCC codes and RxHcc codes so they can be deplayed together\r\n-- Comorbidity_Diagnosis_has_HCC_and has the structure we want to end up with\r\n\r\ncomorbidity_diagnosis_has_hcc_and_rxhcc AS (\r\n\tSELECT DISTINCT\r\n\t\th.comorbidity,\r\n\t\th.description,\r\n\t\th.comorbidity_diagnosis_code,\r\n\t\th.hcc_codes AS hcc_code,\r\n\t\tr.hcc_codes AS rxhcc_code\r\n\tFROM {{ ref('stg_seed_hcc_mapping_hcc_and_rxhcc') }} AS s\r\n\t\tINNER JOIN comorbidity_diagnosis_matches AS h\r\n\t\t\tON\r\n\t\t\t\ts.diagnosis_code = h.comorbidity_diagnosis_code\r\n\t\t\t\tAND s.hcc_code = h.hcc_codes\r\n\t\tINNER JOIN\r\n\t\t\tcomorbidity_diagnosis_matches\r\n\t\t\t\tAS r\r\n\t\t\tON s.diagnosis_code = r.comorbidity_diagnosis_code\r\n\t\t\t\tAND s.rxhcc_code = r.hcc_codes\r\n\t\t\t\tAND h.comorbidity = r.comorbidity\r\n),\r\n\r\n-- now we need to get the rest of the \"Comorbidity_Diagnosis_Matches\" that did not have both HCC and RxHCC code\r\n-- this is done but putting Comorbidity_Diagnosis_has_HCC_and_RxHCC back into the form of Comorbidity_Diagnosis_Matches\r\n-- then do an except\r\nhcc_and_rxhcc AS (\r\n\r\n\tSELECT\r\n\t\tcomorbidity,\r\n\t\tdescription,\r\n\t\tcomorbidity_diagnosis_code,\r\n\t\thcc_code\r\n\tFROM comorbidity_diagnosis_has_hcc_and_rxhcc\r\n\tUNION DISTINCT\r\n\tSELECT\r\n\t\tcomorbidity,\r\n\t\tdescription,\r\n\t\tcomorbidity_diagnosis_code,\r\n\t\trxhcc_code AS hcc_code\r\n\tFROM comorbidity_diagnosis_has_hcc_and_rxhcc\r\n),\r\n\r\n-- now an except is done to remove the matches with both HCC and RXHCC\r\ncomorbidity_diagnosis_single_hcc_or_rxhcc AS (\r\n\tSELECT\r\n\t\tcomorbidity,\r\n\t\tdescription,\r\n\t\tcomorbidity_diagnosis_code,\r\n\t\thcc_codes\r\n\tFROM comorbidity_diagnosis_matches\r\n\tEXCEPT\r\n\tSELECT\r\n\t\tcomorbidity,\r\n\t\tdescription,\r\n\t\tcomorbidity_diagnosis_code,\r\n\t\thcc_code\r\n\tFROM hcc_and_rxhcc\r\n\r\n),\r\n\r\nalltogether AS (\r\n\tSELECT\r\n\t\tcomorbidity,\r\n\t\tdescription,\r\n\t\tcomorbidity_diagnosis_code,\r\n\t\tIFF(hcc_codes LIKE 'HCC%', hcc_codes,NULL) AS hcc_code,\r\n\t\tIFF(hcc_codes LIKE 'RxHCC%', hcc_codes,NULL) AS rxhcc_code\r\n\tFROM comorbidity_diagnosis_single_hcc_or_rxhcc\r\n\tUNION DISTINCT\r\n\tSELECT\r\n\t\tcomorbidity,\r\n\t\tdescription,\r\n\t\tcomorbidity_diagnosis_code,\r\n\t\thcc_code,\r\n\t\trxhcc_code\r\n\tFROM comorbidity_diagnosis_has_hcc_and_rxhcc\r\n\r\n)\r\n\r\nSELECT *,\r\n\tcomorbidity\r\n\t|| comorbidity_diagnosis_code\r\n\t|| COALESCE(hcc_code, '')\r\n\t|| COALESCE(rxhcc_code, '') AS comorbidity_key\r\nFROM alltogether",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_comorbidtiy_diagnosis_hcc",
    "description": "Dimension table for Comorbidity",
    "columns": {
      "Comorbidity_key": {
        "name": "Comorbidity_key",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "COMORBIDITY": {
        "name": "COMORBIDITY",
        "description": "COMORBIDITY name",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "COMORBIDITY_DIAGNOSIS_CODE": {
        "name": "COMORBIDITY_DIAGNOSIS_CODE",
        "description": "Diagnosis code for comorbidity ",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_seed_comorbidtiy_hcc",
        "model.anthem_dev.stg_hcc_mapping",
        "model.anthem_dev.stg_seed_hcc_mapping_hcc_and_rxhcc"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_dates",
    "name": "stg_dates",
    "original_file_path": "models\\staging\\stg_dates.sql",
    "compiled_code": "\n\nWITH seq (n) AS (\n\tSELECT DATEADD(DAY, 1 * SEQ4(), '1/1/2018')\n\tFROM TABLE(GENERATOR(ROWCOUNT => (3288)))\n),\n\nd (d) AS (\n\tSELECT n FROM seq\n),\n\nsrc AS (\n\tSELECT\n\t\tDATE(d) AS thedate,\n\t\tDAY(d) AS theday,\n\t\tDAYNAME(d) AS thedayname,\n\t\tWEEK(d) AS theweek,\n\t\tWEEKISO(d) AS theisoweek,\n\t\tDAYOFWEEK(d) AS thedayofweek,\n\t\tMONTH(d) AS themonth,\n\t\tMONTHNAME(d) AS themonthname,\n\t\tQUARTER(d) AS thequarter,\n\t\tYEAR(d) AS theyear,\n\t\tDATE_TRUNC('month', D) AS thefirstofmonth,\n\t\tDATEADD(\n\t\t\t'day', -1,\n\t\t\tDATEADD(\n\t\t\t\t'year', 1,\n\t\t\t\tDATE_TRUNC('year', D)\n\t\t\t)\n\t\t) AS thelastofyear,\n\t\tDAYOFYEAR(d) AS thedayofyear\n\tFROM d\n),\n\ndim AS (\n\tSELECT\n\t\tthedate AS date,\n\t\tthedayname AS dayofweek,\n\t\tthedayofweek,\n\t\tthedayofyear AS dayofyear,\n\t\ttheweek AS weekofyear,\n\t\tthemonth AS month,\n\t\tthemonthname AS monthname,\n\t\tthequarter AS quarter,\n\t\ttheyear AS year,\n\t\tTO_CHAR(thedate, 'YYYYMMDD') AS dimdatekey,\n\t\tRIGHT('0' + TO_VARCHAR(theday), 2) AS day,\n\t\tTO_VARCHAR(CASE\n\t\t\tWHEN theday / 10 = 1 THEN 'th' ELSE\n\t\t\t\tCASE RIGHT(\n\t\t\t\t\ttheday, 1)\n\t\t\t\t\tWHEN '1' THEN 'st' WHEN '2' THEN 'nd'\n\t\t\t\t\tWHEN '3' THEN 'rd' ELSE 'th'\n\t\t\t\tEND\n\t\tEND) AS daysuffix,\n\t\tTO_NUMERIC(\n\t\t\tROW_NUMBER()\n\t\t\t\tOVER\n\t\t\t\t(\n\t\t\t\t\tPARTITION BY thefirstofmonth, thedayofweek\n\t\t\t\t\tORDER BY thedate\n\t\t\t\t)\n\t\t) AS dowinmonth,\n\t\tTO_NUMERIC(\n\t\t\tDENSE_RANK()\n\t\t\t\tOVER\n\t\t\t\t(\n\t\t\t\t\tPARTITION BY theyear, themonth\n\t\t\t\t\tORDER BY theweek\n\t\t\t\t)\n\t\t) AS weekofmonth,\n\t\tCASE thequarter\n\t\t\tWHEN 1 THEN 'First' WHEN 2 THEN 'Second'\n\t\t\tWHEN 3 THEN 'Third' WHEN 4 THEN 'Fourth'\n\t\tEND AS quartername,\n\t\tTO_CHAR(thedate, 'MM/DD/YYYY') AS standarddate,\n\t\tTO_CHAR(thedate, 'MON-YYYY') AS monthyear,\n\t\tTO_NUMERIC(TO_CHAR(thedate, 'YYYYMM')) AS monthyearkey\n\tFROM src\n)\n\nSELECT\n\t*,\n\tCONVERT_TIMEZONE('UTC', 'US/Eastern', SYSDATE()) AS last_refresh_date\nFROM dim",
    "raw_code": "{{ config( alias = 'stg_dates', schema = 'staging', MATERIALIZED = 'TABLE' , transient = false) }}\r\n\r\nWITH seq (n) AS (\r\n\tSELECT DATEADD(DAY, 1 * SEQ4(), '1/1/2018')\r\n\tFROM TABLE(GENERATOR(ROWCOUNT => (3288)))\r\n),\r\n\r\nd (d) AS (\r\n\tSELECT n FROM seq\r\n),\r\n\r\nsrc AS (\r\n\tSELECT\r\n\t\tDATE(d) AS thedate,\r\n\t\tDAY(d) AS theday,\r\n\t\tDAYNAME(d) AS thedayname,\r\n\t\tWEEK(d) AS theweek,\r\n\t\tWEEKISO(d) AS theisoweek,\r\n\t\tDAYOFWEEK(d) AS thedayofweek,\r\n\t\tMONTH(d) AS themonth,\r\n\t\tMONTHNAME(d) AS themonthname,\r\n\t\tQUARTER(d) AS thequarter,\r\n\t\tYEAR(d) AS theyear,\r\n\t\tDATE_TRUNC('month', D) AS thefirstofmonth,\r\n\t\tDATEADD(\r\n\t\t\t'day', -1,\r\n\t\t\tDATEADD(\r\n\t\t\t\t'year', 1,\r\n\t\t\t\tDATE_TRUNC('year', D)\r\n\t\t\t)\r\n\t\t) AS thelastofyear,\r\n\t\tDAYOFYEAR(d) AS thedayofyear\r\n\tFROM d\r\n),\r\n\r\ndim AS (\r\n\tSELECT\r\n\t\tthedate AS date,\r\n\t\tthedayname AS dayofweek,\r\n\t\tthedayofweek,\r\n\t\tthedayofyear AS dayofyear,\r\n\t\ttheweek AS weekofyear,\r\n\t\tthemonth AS month,\r\n\t\tthemonthname AS monthname,\r\n\t\tthequarter AS quarter,\r\n\t\ttheyear AS year,\r\n\t\tTO_CHAR(thedate, 'YYYYMMDD') AS dimdatekey,\r\n\t\tRIGHT('0' + TO_VARCHAR(theday), 2) AS day,\r\n\t\tTO_VARCHAR(CASE\r\n\t\t\tWHEN theday / 10 = 1 THEN 'th' ELSE\r\n\t\t\t\tCASE RIGHT(\r\n\t\t\t\t\ttheday, 1)\r\n\t\t\t\t\tWHEN '1' THEN 'st' WHEN '2' THEN 'nd'\r\n\t\t\t\t\tWHEN '3' THEN 'rd' ELSE 'th'\r\n\t\t\t\tEND\r\n\t\tEND) AS daysuffix,\r\n\t\tTO_NUMERIC(\r\n\t\t\tROW_NUMBER()\r\n\t\t\t\tOVER\r\n\t\t\t\t(\r\n\t\t\t\t\tPARTITION BY thefirstofmonth, thedayofweek\r\n\t\t\t\t\tORDER BY thedate\r\n\t\t\t\t)\r\n\t\t) AS dowinmonth,\r\n\t\tTO_NUMERIC(\r\n\t\t\tDENSE_RANK()\r\n\t\t\t\tOVER\r\n\t\t\t\t(\r\n\t\t\t\t\tPARTITION BY theyear, themonth\r\n\t\t\t\t\tORDER BY theweek\r\n\t\t\t\t)\r\n\t\t) AS weekofmonth,\r\n\t\tCASE thequarter\r\n\t\t\tWHEN 1 THEN 'First' WHEN 2 THEN 'Second'\r\n\t\t\tWHEN 3 THEN 'Third' WHEN 4 THEN 'Fourth'\r\n\t\tEND AS quartername,\r\n\t\tTO_CHAR(thedate, 'MM/DD/YYYY') AS standarddate,\r\n\t\tTO_CHAR(thedate, 'MON-YYYY') AS monthyear,\r\n\t\tTO_NUMERIC(TO_CHAR(thedate, 'YYYYMM')) AS monthyearkey\r\n\tFROM src\r\n)\r\n\r\nSELECT\r\n\t*,\r\n\tCONVERT_TIMEZONE('UTC', 'US/Eastern', SYSDATE()) AS last_refresh_date\r\nFROM dim",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_dates",
    "description": "Dimension table for Dates",
    "columns": {
      "DATE": {
        "name": "DATE",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DIMDATEKEY": {
        "name": "DIMDATEKEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DAY": {
        "name": "DAY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DAYSUFFIX": {
        "name": "DAYSUFFIX",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DAYOFWEEK": {
        "name": "DAYOFWEEK",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "THEDAYOFWEEK": {
        "name": "THEDAYOFWEEK",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DOWINMONTH": {
        "name": "DOWINMONTH",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DAYOFYEAR": {
        "name": "DAYOFYEAR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "WEEKOFYEAR": {
        "name": "WEEKOFYEAR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "WEEKOFMONTH": {
        "name": "WEEKOFMONTH",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MONTH": {
        "name": "MONTH",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MONTHNAME": {
        "name": "MONTHNAME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QUARTER": {
        "name": "QUARTER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QUARTERNAME": {
        "name": "QUARTERNAME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "YEAR": {
        "name": "YEAR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "STANDARDDATE": {
        "name": "STANDARDDATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MONTHYEAR": {
        "name": "MONTHYEAR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MONTHYEARKEY": {
        "name": "MONTHYEARKEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LAST_REFRESH_DATE": {
        "name": "LAST_REFRESH_DATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": []
    }
  },
  {
    "node_id": "model.anthem_dev.stg_discontinued_attribution",
    "name": "stg_discontinued_attribution",
    "original_file_path": "models\\staging\\stg_discontinued_attribution.sql",
    "compiled_code": "\n\nWITH discontinued_attribution AS (\nSELECT\n\tmemberid,\n\tcancerdiagnosisgroupcode,\n\tcancertype,\n\tmemberkey,\n\ticsiteid,\n\tfileprocesseddatetime,\n\tattributedproviderid,\n\tattributednpiproviderid,\n\tattributedproviderfirstname,\n\tattributedproviderlastname,\n\tattributedproviderorganizationname,\n\tattributedproviderstreet1address,\n\tattributedproviderstreet2address,\n\tattributedprovidercityaddress,\n\tattributedproviderstateaddress,\n\tattributedproviderzipcodeaddress,\n\tattributionperiodbegindate,\n\tattributionperiodenddate,\n\tattributedprovidertaxid,\n\tproviderentityname,\n\tprogramidentifier,\n\tattributionrecordtype,\n\tperf_period_key,\n\tmemberageonattributedmonth,\n\tcustomcancercode,\n\tlineofbusiness\nFROM dev_dtx_gc.staging.stg_attribution_all\nWHERE attributionrecordtype = 'DEL'\n)\nSELECT \n\tda.*,\n\thm.ishospicemember,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tCONCAT(da.memberid, '_', da.attributedprovidertaxid)\n\t\tAS memberid_attributedtin,\n\tCONCAT(\n\t\tCOALESCE(da.attributednpiproviderid, ''),\n\t\t'_',\n\t\tda.attributedprovidertaxid\n\t) AS participatingnpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM discontinued_attribution AS da\n\tLEFT JOIN\n\t\tdev_dtx_gc.staging.stg_member_hospice_mapping AS hm\n\t\tON da.memberid = hm.memberid AND da.perf_period_key = hm.perf_period_key AND da.lineofbusiness = hm.lineofbusiness\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON da.attributedprovidertaxid = map.tin",
    "raw_code": "{{ config( alias = 'stg_discontinued_attribution', schema = 'staging') }}\r\n\r\nWITH discontinued_attribution AS (\r\nSELECT\r\n\tmemberid,\r\n\tcancerdiagnosisgroupcode,\r\n\tcancertype,\r\n\tmemberkey,\r\n\ticsiteid,\r\n\tfileprocesseddatetime,\r\n\tattributedproviderid,\r\n\tattributednpiproviderid,\r\n\tattributedproviderfirstname,\r\n\tattributedproviderlastname,\r\n\tattributedproviderorganizationname,\r\n\tattributedproviderstreet1address,\r\n\tattributedproviderstreet2address,\r\n\tattributedprovidercityaddress,\r\n\tattributedproviderstateaddress,\r\n\tattributedproviderzipcodeaddress,\r\n\tattributionperiodbegindate,\r\n\tattributionperiodenddate,\r\n\tattributedprovidertaxid,\r\n\tproviderentityname,\r\n\tprogramidentifier,\r\n\tattributionrecordtype,\r\n\tperf_period_key,\r\n\tmemberageonattributedmonth,\r\n\tcustomcancercode,\r\n\tlineofbusiness\r\nFROM {{ ref('stg_attribution_all') }}\r\nWHERE attributionrecordtype = 'DEL'\r\n)\r\nSELECT \r\n\tda.*,\r\n\thm.ishospicemember,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tCONCAT(da.memberid, '_', da.attributedprovidertaxid)\r\n\t\tAS memberid_attributedtin,\r\n\tCONCAT(\r\n\t\tCOALESCE(da.attributednpiproviderid, ''),\r\n\t\t'_',\r\n\t\tda.attributedprovidertaxid\r\n\t) AS participatingnpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM discontinued_attribution AS da\r\n\tLEFT JOIN\r\n\t\t{{ ref('stg_member_hospice_mapping') }} AS hm\r\n\t\tON da.memberid = hm.memberid AND da.perf_period_key = hm.perf_period_key AND da.lineofbusiness = hm.lineofbusiness\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON da.attributedprovidertaxid = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_discontinued_attribution",
    "description": "All discontinued Attribution member details",
    "columns": {
      "FILEPROCESSEDDATETIME": {
        "name": "FILEPROCESSEDDATETIME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTEDNPIPROVIDERID": {
        "name": "ATTRIBUTEDNPIPROVIDERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTEDPROVIDERTAXID": {
        "name": "ATTRIBUTEDPROVIDERTAXID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIBUTIONRECORDTYPE": {
        "name": "ATTRIBUTIONRECORDTYPE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LINEOFBUSINESS": {
        "name": "LINEOFBUSINESS",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ISHOSPICEMEMBER": {
        "name": "ISHOSPICEMEMBER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_attribution_all",
        "model.anthem_dev.stg_member_hospice_mapping",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_emcodes_per_attributionmonth",
    "name": "stg_emcodes_per_attributionmonth",
    "original_file_path": "models\\staging\\stg_emcodes_per_attributionmonth.sql",
    "compiled_code": "\n\nSELECT\n\tmemberid,\n\tLISTAGG(DISTINCT claimlinehealthservicecode, ', ') WITHIN GROUP (\n\t\tORDER BY claimlinehealthservicecode\n\t) AS emcodes,\n\tDATE_TRUNC('month', claimlineservicestartdate) AS attributionmonth\nFROM dev_dtx_gc.staging.stg_claimline\nWHERE (\n\tclaimlinehealthservicecode LIKE '992%'\n\tOR claimlinehealthservicecode LIKE '993%'\n\tOR claimlinehealthservicecode LIKE '994%'\n)\nGROUP BY\n\tmemberid,\n\tDATE_TRUNC('month', claimlineservicestartdate)",
    "raw_code": "{{ config( alias = 'stg_emcodes_per_attributionmonth', schema = 'staging') }}\r\n\r\nSELECT\r\n\tmemberid,\r\n\tLISTAGG(DISTINCT claimlinehealthservicecode, ', ') WITHIN GROUP (\r\n\t\tORDER BY claimlinehealthservicecode\r\n\t) AS emcodes,\r\n\tDATE_TRUNC('month', claimlineservicestartdate) AS attributionmonth\r\nFROM {{ ref('stg_claimline') }}\r\nWHERE (\r\n\tclaimlinehealthservicecode LIKE '992%'\r\n\tOR claimlinehealthservicecode LIKE '993%'\r\n\tOR claimlinehealthservicecode LIKE '994%'\r\n)\r\nGROUP BY\r\n\tmemberid,\r\n\tDATE_TRUNC('month', claimlineservicestartdate)",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_emcodes_per_attributionmonth",
    "description": "Derive EM codes for each patient for all attributed months",
    "columns": {},
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_claimline"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_eol_members",
    "name": "stg_eol_members",
    "original_file_path": "models\\staging\\stg_eol_members.sql",
    "compiled_code": "\n\nSELECT\n\tep.memberid,\n\tep.episode_start_date,\n\tep.episode_end_date,\n\tep.participatingprovidernpi,\n\tep.principalcancercode,\n\tep.cancerdiagnosisgroupcode,\n\tep.tin,\n\tep.lineofbusiness,\n\tep.perf_period_key,\n\tm.memberdeathdate\nFROM dev_dtx_gc.staging.stg_episodes AS ep\n\tINNER JOIN dev_dtx_gc.staging.STG_MEMBER AS m\n\t\tON ep.memberid = m.memberid\n\t\t\tAND ep.episode_start_date <= m.memberdeathdate\n\t\t\tAND ep.episode_end_date >= m.memberdeathdate\nQUALIFY ROW_NUMBER() \n\tOVER (PARTITION BY ep.memberid \n\t\t\tORDER BY m.memberdeathdate ASC\n\t\t\t, ep.episode_start_date ASC) = 1",
    "raw_code": "{{ config( alias = 'stg_eol_members', schema = 'staging') }}\r\n\r\nSELECT\r\n\tep.memberid,\r\n\tep.episode_start_date,\r\n\tep.episode_end_date,\r\n\tep.participatingprovidernpi,\r\n\tep.principalcancercode,\r\n\tep.cancerdiagnosisgroupcode,\r\n\tep.tin,\r\n\tep.lineofbusiness,\r\n\tep.perf_period_key,\r\n\tm.memberdeathdate\r\nFROM {{ ref('stg_episodes') }} AS ep\r\n\tINNER JOIN {{ ref('stg_member') }} AS m\r\n\t\tON ep.memberid = m.memberid\r\n\t\t\tAND ep.episode_start_date <= m.memberdeathdate\r\n\t\t\tAND ep.episode_end_date >= m.memberdeathdate\r\nQUALIFY ROW_NUMBER() \r\n\tOVER (PARTITION BY ep.memberid \r\n\t\t\tORDER BY m.memberdeathdate ASC\r\n\t\t\t, ep.episode_start_date ASC) = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_eol_members",
    "description": "All Members who has date of death entry",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episode_start_date": {
        "name": "episode_start_date",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episode_end_date": {
        "name": "episode_end_date",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TIN": {
        "name": "TIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MEMBERDEATHDATE": {
        "name": "MEMBERDEATHDATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_episodes",
        "model.anthem_dev.stg_member"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_episodes",
    "name": "stg_episodes",
    "original_file_path": "models\\staging\\stg_episodes.sql",
    "compiled_code": "\n\nWITH episodes AS (\n\t\n\t-- removed code becauae dbt test was using as code\n\tSELECT\n\t\tme.memberid,\n\t\tme.episode_start_date,\n\t\tme.episode_end_date,\n\t\tme.oncologist_tin,\n\t\tme.oncologist_npi,\n\t\tme.performanceperiodstartdate,\n\t\tme.performanceperiodenddate,\n\t\tme.contractname,\n\t\tme.lineofbusinessidentifier AS lineofbusiness\n\tFROM dev_dtx_gc.IC1.MASTEREPISODE AS me\n),\n\nepisode_attributed_tin AS (\n\tSELECT\n\t\te.memberid,\n\t\te.episode_start_date,\n\t\te.episode_end_date,\n\t\ta.attributedprovidertaxid,\n\t\ta.attributedproviderorganizationname,\n\t\ta.attributednpiproviderid\n\tFROM episodes AS e\n\t\tLEFT JOIN dev_dtx_gc.IC1.ATTRIBUTION AS a\n\t\t\tON e.memberid = a.memberid AND a.attributionperiodbegindate BETWEEN e.episode_start_date AND e.episode_end_date\n\tWHERE a.attributedprovidertaxid IS NOT NULL\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY e.memberid, e.episode_start_date\n\t\t\tORDER BY a.attributionperiodbegindate DESC\n\t\t) = 1\n),\n\nmax_attributed_tin AS (\n\tSELECT\n\t\te.memberid,\n\t\ta.attributedprovidertaxid,\n\t\ta.attributedproviderorganizationname,\n\t\ta.attributednpiproviderid\n\tFROM episodes AS e\n\t\tLEFT JOIN dev_dtx_gc.IC1.ATTRIBUTION AS a\n\t\t\tON e.memberid = a.memberid\n\tWHERE a.attributedprovidertaxid IS NOT NULL\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY e.memberid\n\t\t\tORDER BY a.attributionperiodbegindate DESC\n\t\t) = 1\n),\n\nmember_cancer_info AS (\n\tSELECT\n\t\te.memberid,\n\t\tCOALESCE(ct.icd10code, 'ZZZZZ') AS cancerdiagnosisgroupcode,\n\t\tCOALESCE(ct.cancer_type, 'Unknown') AS cancertype,\n\t\tCOALESCE(ct.icd10code, cl.claimlineprincipaldiagnosiscode, 'Unknown') AS customcancercode,\n\t\tCOALESCE(cl.claimlineprincipaldiagnosiscode, 'Unknown') AS principalcancercode,\n\t\tCASE WHEN ct.cancer_type IS NULL THEN 1 WHEN ct.cancer_type LIKE 'Secondary%' THEN 2 WHEN ct.cancer_type LIKE '%other%' THEN 3 ELSE 4 END AS cancerorder,\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY e.memberid\n\t\t\tORDER BY cancerorder DESC, cl.claimlineservicestartdate ASC\n\t\t) AS cancerorder_rn\n\tFROM episodes AS e\n\t\tLEFT JOIN dev_dtx_gc.IC1.CLAIM AS c\n\t\t\tON e.memberid = c.memberid\n\t\tLEFT JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\t\tON c.claimid = cl.claimid AND cl.claimlinestatuscode = 'APRVD'\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_seed_ocm_cancer_types AS ct\n\t\t\tON cl.claimlineprincipaldiagnosiscode LIKE (ct.icd10code || '%')\n)\n\nSELECT\n\te.memberid,\n\te.episode_start_date,\n\te.episode_end_date,\n\tCOALESCE(e.oncologist_tin, et.attributedprovidertaxid, mt.attributedprovidertaxid) AS tin,\n\tCOALESCE(e.oncologist_npi, et.attributednpiproviderid, mt.attributednpiproviderid) AS participatingprovidernpi,\n\tCOALESCE(e.contractname, et.attributedproviderorganizationname, mt.attributedproviderorganizationname) AS contractname,\n\te.lineofbusiness,\n\tpp.perf_period_key,\n\tpp.perf_period_start_date,\n\tpp.perf_period_end_date,\n\tc.cancerdiagnosisgroupcode,\n\tc.cancertype,\n\tc.customcancercode,\n\tc.principalcancercode\nFROM episodes AS e\n\tINNER JOIN dev_dtx_gc.staging.stg_seed_performance_period AS pp\n\t\tON e.episode_start_date BETWEEN pp.perf_period_start_date AND pp.perf_period_end_date\n\tLEFT JOIN member_cancer_info AS c\n\t\tON e.memberid = c.memberid\n\tLEFT JOIN episode_attributed_tin AS et\n\t\tON e.memberid = et.memberid AND e.episode_start_date = et.episode_start_date\n\tLEFT JOIN max_attributed_tin AS mt\n\t\tON e.memberid = mt.memberid\nWHERE c.cancerorder_rn = 1",
    "raw_code": "{{ config( alias = 'stg_episodes', schema = 'staging') }}\r\n\r\nWITH episodes AS (\r\n\t\r\n\t-- removed code becauae dbt test was using as code\r\n\tSELECT\r\n\t\tme.memberid,\r\n\t\tme.episode_start_date,\r\n\t\tme.episode_end_date,\r\n\t\tme.oncologist_tin,\r\n\t\tme.oncologist_npi,\r\n\t\tme.performanceperiodstartdate,\r\n\t\tme.performanceperiodenddate,\r\n\t\tme.contractname,\r\n\t\tme.lineofbusinessidentifier AS lineofbusiness\r\n\tFROM {{ source('IC1','MASTEREPISODE') }} AS me\r\n),\r\n\r\nepisode_attributed_tin AS (\r\n\tSELECT\r\n\t\te.memberid,\r\n\t\te.episode_start_date,\r\n\t\te.episode_end_date,\r\n\t\ta.attributedprovidertaxid,\r\n\t\ta.attributedproviderorganizationname,\r\n\t\ta.attributednpiproviderid\r\n\tFROM episodes AS e\r\n\t\tLEFT JOIN {{ source('IC1','ATTRIBUTION') }} AS a\r\n\t\t\tON e.memberid = a.memberid AND a.attributionperiodbegindate BETWEEN e.episode_start_date AND e.episode_end_date\r\n\tWHERE a.attributedprovidertaxid IS NOT NULL\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY e.memberid, e.episode_start_date\r\n\t\t\tORDER BY a.attributionperiodbegindate DESC\r\n\t\t) = 1\r\n),\r\n\r\nmax_attributed_tin AS (\r\n\tSELECT\r\n\t\te.memberid,\r\n\t\ta.attributedprovidertaxid,\r\n\t\ta.attributedproviderorganizationname,\r\n\t\ta.attributednpiproviderid\r\n\tFROM episodes AS e\r\n\t\tLEFT JOIN {{ source('IC1','ATTRIBUTION') }} AS a\r\n\t\t\tON e.memberid = a.memberid\r\n\tWHERE a.attributedprovidertaxid IS NOT NULL\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY e.memberid\r\n\t\t\tORDER BY a.attributionperiodbegindate DESC\r\n\t\t) = 1\r\n),\r\n\r\nmember_cancer_info AS (\r\n\tSELECT\r\n\t\te.memberid,\r\n\t\tCOALESCE(ct.icd10code, 'ZZZZZ') AS cancerdiagnosisgroupcode,\r\n\t\tCOALESCE(ct.cancer_type, 'Unknown') AS cancertype,\r\n\t\tCOALESCE(ct.icd10code, cl.claimlineprincipaldiagnosiscode, 'Unknown') AS customcancercode,\r\n\t\tCOALESCE(cl.claimlineprincipaldiagnosiscode, 'Unknown') AS principalcancercode,\r\n\t\tCASE WHEN ct.cancer_type IS NULL THEN 1 WHEN ct.cancer_type LIKE 'Secondary%' THEN 2 WHEN ct.cancer_type LIKE '%other%' THEN 3 ELSE 4 END AS cancerorder,\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY e.memberid\r\n\t\t\tORDER BY cancerorder DESC, cl.claimlineservicestartdate ASC\r\n\t\t) AS cancerorder_rn\r\n\tFROM episodes AS e\r\n\t\tLEFT JOIN {{ source('IC1','CLAIM') }} AS c\r\n\t\t\tON e.memberid = c.memberid\r\n\t\tLEFT JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\t\tON c.claimid = cl.claimid AND cl.claimlinestatuscode = 'APRVD'\r\n\t\tLEFT JOIN {{ ref('stg_seed_ocm_cancer_types') }} AS ct\r\n\t\t\tON cl.claimlineprincipaldiagnosiscode LIKE (ct.icd10code || '%')\r\n)\r\n\r\nSELECT\r\n\te.memberid,\r\n\te.episode_start_date,\r\n\te.episode_end_date,\r\n\tCOALESCE(e.oncologist_tin, et.attributedprovidertaxid, mt.attributedprovidertaxid) AS tin,\r\n\tCOALESCE(e.oncologist_npi, et.attributednpiproviderid, mt.attributednpiproviderid) AS participatingprovidernpi,\r\n\tCOALESCE(e.contractname, et.attributedproviderorganizationname, mt.attributedproviderorganizationname) AS contractname,\r\n\te.lineofbusiness,\r\n\tpp.perf_period_key,\r\n\tpp.perf_period_start_date,\r\n\tpp.perf_period_end_date,\r\n\tc.cancerdiagnosisgroupcode,\r\n\tc.cancertype,\r\n\tc.customcancercode,\r\n\tc.principalcancercode\r\nFROM episodes AS e\r\n\tINNER JOIN {{ ref('stg_seed_performance_period') }} AS pp\r\n\t\tON e.episode_start_date BETWEEN pp.perf_period_start_date AND pp.perf_period_end_date\r\n\tLEFT JOIN member_cancer_info AS c\r\n\t\tON e.memberid = c.memberid\r\n\tLEFT JOIN episode_attributed_tin AS et\r\n\t\tON e.memberid = et.memberid AND e.episode_start_date = et.episode_start_date\r\n\tLEFT JOIN max_attributed_tin AS mt\r\n\t\tON e.memberid = mt.memberid\r\nWHERE c.cancerorder_rn = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_episodes",
    "description": "Holds the Episodes for a member",
    "columns": {
      "memberid": {
        "name": "memberid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episode_start_date": {
        "name": "episode_start_date",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episode_end_date": {
        "name": "episode_end_date",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "tin": {
        "name": "tin",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.MASTEREPISODE",
        "source.anthem_dev.IC1.ATTRIBUTION",
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMLINE",
        "model.anthem_dev.stg_seed_ocm_cancer_types",
        "model.anthem_dev.stg_seed_performance_period"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_hcc_mapping",
    "name": "stg_hcc_mapping",
    "original_file_path": "models\\staging\\stg_hcc_mapping.sql",
    "compiled_code": "\n\n-- this process the HCCMappingFY2021FY2022.csv file to fix into  the REFERENCE.HCC_MAPPING table\n--REFERENCE.HCC_MAPPING\n--      DIAGNOSIS_CODE VARCHAR(10) NOT NULL COLLATE 'en-ci',\n--      DESCRIPTION  VARCHAR(300) NOT NULL COLLATE 'en-ci',\n--      HCC_CODES CHAR(10) NOT NULL COLLATE 'en-ci',\n--\t    Model_Version VARCHAR(10) NOT NULL COLLATE 'en-ci',\n--\t    EFFECTIVE_START_DATE DATE NOT NULL 'en-ci','\n--\t    EFFECTIVE_END_DATE DATE NOT NULL 'en-ci'\n-- Assume all the EFFECTIVE_START_DATE and EFFECTIVE_End_DATE are teh same\n--\n\nWITH hcc_mapping_transform AS (\nSELECT\n\tdiagnosis_code,\n\tdescription,\n\thcc_code AS hcc_codes,\n\t'CMS HCC V24 2022' AS model_version\nFROM dev_dtx_gc.staging.stg_seed_hcc_mapping_hcc_and_rxhcc\nWHERE cms_hcc_v24_2022 = 'Yes'\n\nUNION DISTINCT\n\nSELECT\n\tdiagnosis_code,\n\tdescription,\n\trxhcc_code AS hcc_codes,\n\t'RxHCC V08 2022' AS model_version\nFROM dev_dtx_gc.staging.stg_seed_hcc_mapping_hcc_and_rxhcc\nWHERE rxhcc_v08_2022 = 'Yes'\n)\n\nSELECT\n\tdiagnosis_code,\n\tdescription,\n\thcc_codes,\n\tmodel_version\nFROM hcc_mapping_transform",
    "raw_code": "{{ config( alias = 'stg_hcc_mapping', schema = 'staging') }}\r\n\r\n-- this process the HCCMappingFY2021FY2022.csv file to fix into  the REFERENCE.HCC_MAPPING table\r\n--REFERENCE.HCC_MAPPING\r\n--      DIAGNOSIS_CODE VARCHAR(10) NOT NULL COLLATE 'en-ci',\r\n--      DESCRIPTION  VARCHAR(300) NOT NULL COLLATE 'en-ci',\r\n--      HCC_CODES CHAR(10) NOT NULL COLLATE 'en-ci',\r\n--\t    Model_Version VARCHAR(10) NOT NULL COLLATE 'en-ci',\r\n--\t    EFFECTIVE_START_DATE DATE NOT NULL 'en-ci','\r\n--\t    EFFECTIVE_END_DATE DATE NOT NULL 'en-ci'\r\n-- Assume all the EFFECTIVE_START_DATE and EFFECTIVE_End_DATE are teh same\r\n--\r\n\r\nWITH hcc_mapping_transform AS (\r\nSELECT\r\n\tdiagnosis_code,\r\n\tdescription,\r\n\thcc_code AS hcc_codes,\r\n\t'CMS HCC V24 2022' AS model_version\r\nFROM {{ ref('stg_seed_hcc_mapping_hcc_and_rxhcc') }}\r\nWHERE cms_hcc_v24_2022 = 'Yes'\r\n\r\nUNION DISTINCT\r\n\r\nSELECT\r\n\tdiagnosis_code,\r\n\tdescription,\r\n\trxhcc_code AS hcc_codes,\r\n\t'RxHCC V08 2022' AS model_version\r\nFROM {{ ref('stg_seed_hcc_mapping_hcc_and_rxhcc') }}\r\nWHERE rxhcc_v08_2022 = 'Yes'\r\n)\r\n\r\nSELECT\r\n\tdiagnosis_code,\r\n\tdescription,\r\n\thcc_codes,\r\n\tmodel_version\r\nFROM hcc_mapping_transform",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_hcc_mapping",
    "description": "Mapping stg_seed_hcc_mapping_hcc_and_rxhcc  for cms_hcc_v24_2022 and rxhcc_v08_2022 ",
    "columns": {
      "DIAGNOSIS_CODE": {
        "name": "DIAGNOSIS_CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DESCRIPTION": {
        "name": "DESCRIPTION",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "HCC_CODES": {
        "name": "HCC_CODES",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MODEL_VERSION": {
        "name": "MODEL_VERSION",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_seed_hcc_mapping_hcc_and_rxhcc"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_hospice_members",
    "name": "stg_hospice_members",
    "original_file_path": "models\\staging\\stg_hospice_members.sql",
    "compiled_code": "\nSELECT DISTINCT\n\tad.memberid,\n\tad.dateofservice,\n\tad.dateofserviceend,\n\te.perf_period_key,\n\te.lineofbusiness\nFROM dev_dtx_gc.staging.stg_member_admissions AS ad\n\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS e\n\t\tON ad.memberid = e.memberid\n\t\t\tAND ad.dateofservice >= e.episode_start_date AND  ad.dateofservice <= e.episode_end_date\nWHERE UPPER(e.lineofbusiness) = 'COMMERCIAL' AND (\n\t(\n\t\tad.claimlinerevenuecode >= 650\n\t\tAND ad.claimlinerevenuecode <= 659\n\t)\n\tOR ad.claimlineplaceofservicecode = 34\n)\n\nUNION\n\nSELECT DISTINCT\n\tad.memberid,\n\tad.hspcelectiondate AS dateofservice,\n\tad.hspcdischargedate AS dateofserviceend,\n\te.perf_period_key,\n\te.lineofbusiness\nFROM dev_dtx_gc.IC1.HOSPICE AS ad\n\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS e\n\t\tON ad.memberid = e.memberid\n\t\t\tAND ad.hspcelectiondate >= e.episode_start_date AND ad.hspcelectiondate <= e.episode_end_date\nWHERE UPPER(e.lineofbusiness) = 'MEDICARE'",
    "raw_code": "{{ config( alias = 'stg_hospice_members', schema = 'staging') }}\r\nSELECT DISTINCT\r\n\tad.memberid,\r\n\tad.dateofservice,\r\n\tad.dateofserviceend,\r\n\te.perf_period_key,\r\n\te.lineofbusiness\r\nFROM {{ ref('stg_member_admissions') }} AS ad\r\n\tINNER JOIN {{ ref('stg_episodes') }} AS e\r\n\t\tON ad.memberid = e.memberid\r\n\t\t\tAND ad.dateofservice >= e.episode_start_date AND  ad.dateofservice <= e.episode_end_date\r\nWHERE UPPER(e.lineofbusiness) = 'COMMERCIAL' AND (\r\n\t(\r\n\t\tad.claimlinerevenuecode >= 650\r\n\t\tAND ad.claimlinerevenuecode <= 659\r\n\t)\r\n\tOR ad.claimlineplaceofservicecode = 34\r\n)\r\n\r\nUNION\r\n\r\nSELECT DISTINCT\r\n\tad.memberid,\r\n\tad.hspcelectiondate AS dateofservice,\r\n\tad.hspcdischargedate AS dateofserviceend,\r\n\te.perf_period_key,\r\n\te.lineofbusiness\r\nFROM {{ source('IC1','HOSPICE') }} AS ad\r\n\tINNER JOIN {{ ref('stg_episodes') }} AS e\r\n\t\tON ad.memberid = e.memberid\r\n\t\t\tAND ad.hspcelectiondate >= e.episode_start_date AND ad.hspcelectiondate <= e.episode_end_date\r\nWHERE UPPER(e.lineofbusiness) = 'MEDICARE'",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_hospice_members",
    "description": "",
    "columns": {},
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.HOSPICE",
        "model.anthem_dev.stg_member_admissions",
        "model.anthem_dev.stg_episodes"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_ic1_recon_source",
    "name": "stg_ic1_recon_source",
    "original_file_path": "models\\staging\\stg_ic1_recon_source.sql",
    "compiled_code": "\n\n\nWITH ic_payorrecon AS (\n\n\tSELECT * FROM dev_dtx_gc.IC1.PAYORICRECON\n),\n\nic_masterepisode AS (\n\n\tSELECT * FROM dev_dtx_gc.IC1.MASTEREPISODE\n),\n\nic_masterepisode_perfperiod AS (\n\n\tSELECT DISTINCT\n\t\tic.*,\n\t\tpp.perf_period_name,\n\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\t\tpp.perf_period_name_range, pp.perf_period_name || ' : ', ''\n\t\t\t),\n\t\t\t' ',\n\t\t\t''\n\t\t) AS timeperioddates\n\tFROM ic_masterepisode AS ic\n\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_performance_period AS pp\n\t\t\tON\n\t\t\t\tic.performanceperiodstartdate BETWEEN pp.perf_period_start_date AND pp.perf_period_end_date\n\t\t\t\tAND ic.performanceperiodenddate < DATEADD(YEAR, -1, TO_DATE(SYSDATE())) -- no future Perfperiods, based on the next PP will be a year from when this runs\n),\n\npayoricrecon_tin AS (\n\tSELECT DISTINCT\n\t\tp.*,\n\t\tm.tin AS attributedprovidertaxid\n\tFROM ic_payorrecon AS p\n\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_reconpp2_name_tin_mapping AS m\n\t\t\tON p.contractname = m.contractname\n\tWHERE\n\t\tp.performanceperiodstartdate NOT IN (\n\t\t\tSELECT DISTINCT mp.performanceperiodstartdate\n\t\t\tFROM ic_masterepisode_perfperiod AS mp\n\t\t)\n\t\tAND p.performanceperiodenddate < DATEADD(YEAR, -1, TO_DATE(SYSDATE())) -- no future Perfperiods, based on the next PP will be a year from when this runs\n\tQUALIFY\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY p.memberid, p.performanceperiodstartdate\n\t\t\tORDER BY m.tin\n\t\t) = 1\n),\n\npayoricrecon AS (\n\tSELECT\n\t\tp.memberid,\n\t\tp.filerunid,\n\t\tp.contractid,\n\t\tp.lineofbusinessidentifier,\n\t\tp.administrativetaxidnumber,\n\t\tp.attributedprovidertaxid,\n\t\tp.participatingprovidernpinumber,\n\t\tp.contractstatecode,\n\t\tp.performanceperiodstartdate,\n\t\tp.performanceperiodenddate,\n\t\tp.contractperiodstartdate,\n\t\tp.contractperiodenddate,\n\t\tp.programid,\n\t\tp.providergroupingidentifier,\n\t\tp.contractname,\n\t\tp.episodecount,\n\t\tp.budgetamount,\n\t\tp.trenddescription,\n\t\tp.noveladjustmentdescription,\n\t\tp.benchmarkpriceamount,\n\t\tp.administrativediscountpercent,\n\t\tp.targetpriceamount,\n\t\tp.totalallowedactualcostamount,\n\t\tp.episodeactualtotargetdifferenceamount,\n\t\tp.sharedsavingspercent,\n\t\tp.savingspoolamount,\n\t\tp.sharedsavingsmultipliervalue,\n\t\tp.sharedsavingsexpenseamount,\n\t\tp.episodeid,\n\t\tp.patientstatename,\n\t\tp.timeperioddates,\n\t\tp.episodename,\n\t\tp.qm1code,\n\t\tCOALESCE(p.qm1pointsvalue, 0) AS qm1pointsvalue,\n\t\tp.qm1performanceratevalue,\n\t\tp.qm1numeratorvalue,\n\t\tp.qm1denominatorvalue,\n\t\tp.qm2code,\n\t\tCOALESCE(p.qm2pointsvalue, 0) AS qm2pointsvalue,\n\t\tp.qm2performanceratevalue,\n\t\tp.qm2numeratorvalue,\n\t\tp.qm2denominatorvalue,\n\t\tp.qm3code,\n\t\tCOALESCE(p.qm3pointsvalue, 0) AS qm3pointsvalue,\n\t\tp.qm3performanceratevalue,\n\t\tp.qm3numeratorvalue,\n\t\tp.qm3denominatorvalue,\n\t\tp.qm4code,\n\t\tCOALESCE(p.qm4pointsvalue, 0) AS qm4pointsvalue,\n\t\tp.qm4performanceratevalue,\n\t\tp.qm4numeratorvalue,\n\t\tp.qm4denominatorvalue,\n\t\tp.qm5code,\n\t\tCOALESCE(p.qm5pointsvalue, 0) AS qm5pointsvalue,\n\t\tp.qm5performanceratevalue,\n\t\tp.qm5numeratorvalue,\n\t\tp.qm5denominatorvalue,\n\t\tp.qm6code,\n\t\tCOALESCE(p.qm6pointsvalue, 0) AS qm6pointsvalue,\n\t\tp.qm6performanceratevalue,\n\t\tp.qm6numeratorvalue,\n\t\tp.qm6denominatorvalue,\n\t\tp.qm7code,\n\t\tCOALESCE(p.qm7pointsvalue, 0) AS qm7pointsvalue,\n\t\tp.qm7performanceratevalue,\n\t\tp.qm7numeratorvalue,\n\t\tp.qm7denominatorvalue,\n\t\tp.qm8code,\n\t\tCOALESCE(p.qm8pointsvalue, 0) AS qm8pointsvalue,\n\t\tp.qm8performanceratevalue,\n\t\tp.qm8numeratorvalue,\n\t\tp.qm8denominatorvalue,\n\t\tp.qm9code,\n\t\tCOALESCE(p.qm9pointsvalue, 0) AS qm9pointsvalue,\n\t\tp.qm9performanceratevalue,\n\t\tp.qm9numeratorvalue,\n\t\tp.qm9denominatorvalue,\n\t\tp.qm10code,\n\t\tCOALESCE(p.qm10pointsvalue, 0) AS qm10pointsvalue,\n\t\tp.qm10performanceratevalue,\n\t\tp.qm10numeratorvalue,\n\t\tp.qm10denominatorvalue,\n\t\tp.qm11code,\n\t\tCOALESCE(p.qm11pointsvalue, 0) AS qm11pointsvalue,\n\t\tp.qm11performanceratevalue,\n\t\tp.qm11numeratorvalue,\n\t\tp.qm11denominatorvalue,\n\t\tp.qmtotalpointsvalue,\n\t\tCOALESCE(p.qmaggregatequalityscorevalue, 0)\n\t\t\tAS qmaggregatequalityscorevalue,\n\t\t'PayorICRecon' AS datasourcetable,\n        NULL AS  subscriberid,\n\t\t NULL AS  all_other_medical,\n\t\t NULL AS  all_other_medical_count,\n\t\t NULL AS  amb_surg,\n\t\t NULL AS  amb_surg_count,\n\t\t NULL AS  attributed_oncologist,\n\t\t NULL AS  avoid_ed_ane_allowed,\n\t\t NULL AS  avoid_ed_ane_count,\n\t\t NULL AS  avoid_ed_deh_allowed,\n\t\t NULL AS  avoid_ed_deh_count,\n\t\t NULL AS  avoid_ed_die_allowed,\n\t\t NULL AS  avoid_ed_die_count,\n\t\t NULL AS  avoid_ed_eme_allowed,\n\t\t NULL AS  avoid_ed_eme_count,\n\t\t NULL AS  avoid_ed_fev_allowed,\n\t\t NULL AS  avoid_ed_fev_count,\n\t\t NULL AS  avoid_ed_nau_allowed,\n\t\t NULL AS  avoid_ed_nau_count,\n\t\t NULL AS  avoid_ed_neu_allowed,\n\t\t NULL AS  avoid_ed_neu_count,\n\t\t NULL AS  avoid_ed_pai_allowed,\n\t\t NULL AS  avoid_ed_pai_count,\n\t\t NULL AS  avoid_ed_pne_allowed,\n\t\t NULL AS  avoid_ed_pne_count,\n\t\t NULL AS  avoid_ed_sep_allowed,\n\t\t NULL AS  avoid_ed_sep_count,\n\t\t NULL AS  avoid_ip_ane_allowed,\n\t\t NULL AS  avoid_ip_deh_allowed,\n\t\t NULL AS  avoid_ip_deh_count,\n\t\t NULL AS  avoid_ip_die_allowed,\n\t\t NULL AS  avoid_ip_die_count,\n\t\t NULL AS  avoid_ip_eme_allowed,\n\t\t NULL AS  avoid_ip_eme_count,\n\t\t NULL AS  avoid_ip_fev_allowed,\n\t\t NULL AS  avoid_ip_fev_count,\n\t\t NULL AS  avoid_ip_nau_allowed,\n\t\t NULL AS  avoid_ip_nau_count,\n\t\t NULL AS  avoid_ip_neu_allowed,\n\t\t NULL AS  avoid_ip_neu_count,\n\t\t NULL AS  avoid_ip_pai_allowed,\n\t\t NULL AS  avoid_ip_pai_count,\n\t\t NULL AS  avoid_ip_pne_allowed,\n\t\t NULL AS  avoid_ip_pne_count,\n\t\t NULL AS  avoid_ip_sep_allowed,\n\t\t NULL AS  avoid_ip_sep_count,\n\t\t NULL AS  avoidable_admits_allowed,\n\t\t NULL AS  avoidable_ed_allowed,\n\t\t NULL AS  avoidable_ed_count,\n\t\t NULL AS  birth_date,\n\t\t NULL AS  ccf_paid,\n\t\t NULL AS  chemo_allowed,\n\t\t NULL AS  chemo_count,\n\t\t NULL AS  chemo_drugs_medical,\n\t\t NULL AS  chemo_drugs_medical_count,\n\t\t NULL AS  chemotherapy_type,\n\t\t NULL AS  dod,\n\t\t NULL AS  ed_allowed,\n\t\t NULL AS  ed_visits,\n\t\t NULL AS  emergencyroomtotalvisits,\n\t\t NULL AS  eol_chemo_allowed,\n\t\t NULL AS  eol_chemo_count,\n\t\t NULL AS  eol_ed_allowed,\n\t\t NULL AS  eol_ed_visits,\n\t\t NULL AS  eol_icu_allowed,\n\t\t NULL AS  eol_icu_count,\n\t\t NULL AS  episode_end_date,\n\t\t NULL AS  episode_start_date,\n\t\t NULL AS  er,\n\t\t NULL AS  er_count,\n\t\t NULL AS  gender,\n\t\t NULL AS  home,\n\t\t NULL AS  inpatient,\n\t\t NULL AS  home_count,\n\t\t NULL AS  hospice_allowed,\n\t\t NULL AS  hospice_claim_admits,\n\t\t NULL AS  hospice_los,\n\t\t NULL AS  icu_allowed,\n\t\t NULL AS  icu_claim_admits,\n\t\t NULL AS  icu_los,\n\t\t NULL AS  inpatient__all_other_inpatient,\n\t\t NULL AS  inpatient__cardiology,\n\t\t NULL AS  inpatient__detailed_coded_drugs,\n\t\t NULL AS  inpatient__emergency_room,\n\t\t NULL AS  inpatient__icu,\n\t\t NULL AS  inpatient__imaging,\n\t\t NULL AS  inpatient__lab_pathology,\n\t\t NULL AS  inpatient__med_surg_supplies,\n\t\t NULL AS  inpatient__operation,\n\t\t NULL AS  inpatient__pharmacy,\n\t\t NULL AS  inpatient__other,\n\t\t NULL AS  inpatient__radiation_therapy,\n\t\t NULL AS  inpatient__respiratory_pt_ot_st,\n\t\t NULL AS  inpatient__room_and_board,\n\t\t NULL AS  inpatient_count,\n\t\t NULL AS  inpatient_count__all_other_inpatient,\n\t\t NULL AS  inpatient_count__cardiology,\n\t\t NULL AS  inpatient_count__detailed_coded_drugs,\n\t\t NULL AS  inpatient_count__emergency_room,\n\t\t NULL AS  inpatient_count__icu,\n\t\t NULL AS  inpatient_count__imaging,\n\t\t NULL AS  inpatient_count__lab_pathology,\n\t\t NULL AS  inpatient_count__med_surg_supplies,\n\t\t NULL AS  inpatient_count__operation,\n\t\t NULL AS  inpatient_count__other,\n\t\t NULL AS  inpatient_count__pharmacy,\n\t\t NULL AS  inpatient_count__radiation_therapy,\n\t\t NULL AS  inpatient_count__respiratory_pt_ot_st,\n\t\t NULL AS  inpatient_count__room_and_board,\n\t\t NULL AS  avoidable_admits_count,\n\t\t NULL AS  inpatient_drugs_requiring_coding,\n\t\t NULL AS  avoid_ip_ane_count,\n\t\t NULL AS  ip_allowed,\n\t\t NULL AS  ip_claim_admits,\n\t\t NULL AS  ip_clusters,\n\t\t NULL AS  ip_los,\n\t\t NULL AS  lab,\n\t\t NULL AS  lab_count,\n\t\t NULL AS  min_risk_corridor,\n\t\t NULL AS  novel_allowed,\n\t\t NULL AS  office,\n\t\t NULL AS  office__all_other_office,\n\t\t NULL AS  office__cardiovascular_procedures,\n\t\t NULL AS  office__drug_admin,\n\t\t NULL AS  office__e_and_m,\n\t\t NULL AS  office__radioactive_agents,\n\t\t NULL AS  office__other,\n\t\t NULL AS  office__radiology_mammography,\n\t\t NULL AS  office__pathology_and_lab,\n\t\t NULL AS  office__psychiatry,\n\t\t NULL AS  office__radiation_treatment,\n\t\t NULL AS  office__radiology_diagnostic,\n\t\t NULL AS  office__radiology_guidance,\n\t\t NULL AS  office__radiology_nuclear_medicine,\n\t\t NULL AS  office__radiology_other,\n\t\t NULL AS  office__radiology_rad_onc_treatment,\n\t\t NULL AS  office__surgery,\n\t\t NULL AS  office__therapeutic_activities,\n\t\t NULL AS  office_count,\n\t\t NULL AS  office_count__all_other_office,\n\t\t NULL AS  office_count__cardiovascular_procedures,\n\t\t NULL AS  office_count__drug_admin,\n\t\t NULL AS  office_count__e_and_m,\n\t\t NULL AS  office_count__other,\n\t\t NULL AS  office_count__pathology_and_lab,\n\t\t NULL AS  office_count__psychiatry,\n\t\t NULL AS  office_count__radiation_treatment,\n\t\t NULL AS  office_count__radioactive_agents,\n\t\t NULL AS  office_count__radiology_diagnostic,\n\t\t NULL AS  office_count__radiology_guidance,\n\t\t NULL AS  office_count__radiology_mammography,\n\t\t NULL AS  office_count__radiology_nuclear_medicine,\n\t\t NULL AS  office_count__radiology_other,\n\t\t NULL AS  office_count__radiology_rad_onc_treatment,\n\t\t NULL AS  office_count__surgery,\n\t\t NULL AS  office_count__therapeutic_activities,\n\t\t NULL AS  operating_room_services_count,\n\t\t NULL AS  outpatient,\n\t\t NULL AS  outpatient__all_other_outpatient,\n\t\t NULL AS  outpatient__chemo_admin,\n\t\t NULL AS  outpatient__detailed_coded_drugs,\n\t\t NULL AS  outpatient__gastrointestinal,\n\t\t NULL AS  outpatient__imaging,\n\t\t NULL AS  outpatient__iv_therapy,\n\t\t NULL AS  outpatient__lab_pathology,\n\t\t NULL AS  outpatient__med_surg_supplies,\n\t\t NULL AS  outpatient__nuclear_medicine,\n\t\t NULL AS  outpatient__operation,\n\t\t NULL AS  outpatient__other,\n\t\t NULL AS  outpatient__pharmacy,\n\t\t NULL AS  outpatient__radiation_therapy,\n\t\t NULL AS  outpatient_count,\n\t\t NULL AS  outpatient_count__all_other_outpatient,\n\t\t NULL AS  outpatient_count__chemo_admin,\n\t\t NULL AS  outpatient_count__detailed_coded_drugs,\n\t\t NULL AS  outpatient_count__gastrointestinal,\n\t\t NULL AS  outpatient_count__imaging,\n\t\t NULL AS  outpatient_count__iv_therapy,\n\t\t NULL AS  outpatient_count__lab_pathology,\n\t\t NULL AS  outpatient_count__med_surg_supplies,\n\t\t NULL AS  outpatient_count__nuclear_medicine,\n\t\t NULL AS  outpatient_count__operation,\n\t\t NULL AS  outpatient_count__other,\n\t\t NULL AS  outpatient_count__pharmacy,\n\t\t NULL AS  outpatient_count__radiation_therapy,\n\t\t NULL AS  practice,\n\t\t NULL AS  prediction,\n\t\t NULL AS  retail_pharm,\n\t\t NULL AS  retail_pharm_count,\n\t\t NULL AS  ssav_expns_amt_no_cap,\n\t\t NULL AS  telehealth,\n\t\t NULL AS  telehealth_count,\n\t\t NULL AS  total_allowed_wind,\n\t\t NULL AS  totalallowedamtcostall,\n\t\t NULL AS  transportation,\n\t\t NULL AS  transportation_count,\n\t\t NULL AS  uc,\n\t\t NULL AS  uc_count\n\tFROM payoricrecon_tin AS p\n),\n\nmasterepisode AS (\n\tSELECT\n\t\tp.memberid,\n\t\tp.runid AS filerunid,\n\t\tp.contractid,\n\t\tp.lineofbusinessidentifier,\n\t\tp.oncologist_tin AS administrativetaxidnumber,\n\t\tp.oncologist_tin AS attributedprovidertaxid,\n\t\tp.oncologist_npi AS participatingprovidernpinumber,\n\t\tp.contractstatecode,\n\t\tp.performanceperiodstartdate,\n\t\tp.performanceperiodenddate,\n\t\tNULL AS contractperiodstartdate,\n\t\tNULL AS contractperiodenddate,\n\t\tp.pgm_id AS programid,\n\t\tp.pg_id AS providergroupingidentifier,\n\t\tp.contractname,\n\t\tp.episode_count AS episodecount,\n\n\t\tp.prediction_wind AS budgetamount,\n\t\tp.trend AS trenddescription,\n\t\tp.novel_adj AS noveladjustmentdescription,\n\t\tp.benchmark_price AS benchmarkpriceamount,\n\t\tp.mrc_percent AS administrativediscountpercent,\n\t\tp.target AS targetpriceamount,\n\t\tp.total_expenditures AS totalallowedactualcostamount,\n\t\tp.epsdactualtargetdiff AS episodeactualtotargetdifferenceamount,\n\t\tp.ssprct AS sharedsavingspercent,\n\t\tp.savings_pool AS savingspoolamount,\n\t\tp.quality_multiplier AS sharedsavingsmultipliervalue,\n\t\tp.ssav_expns_amt AS sharedsavingsexpenseamount,\n\t\tp.episodeid,\n\t\tp.member_state AS patientstatename,\n\t\tp.timeperioddates,\n\t\tp.cancer_type AS episodename,\n\n\t\tp.qm1code,\n\t\tCOALESCE(p.qm1pointsvalue, 0) AS qm1pointsvalue,\n\t\tp.qm1performanceratevalue,\n\t\tp.qm1numeratorvalue,\n\t\tp.qm1denominatorvalue,\n\t\tp.qm2code,\n\t\tCOALESCE(p.qm2pointsvalue, 0) AS qm2pointsvalue,\n\t\tp.qm2performanceratevalue,\n\t\tp.qm2numeratorvalue,\n\t\tp.qm2denominatorvalue,\n\t\tp.qm3code,\n\t\tCOALESCE(p.qm3pointsvalue, 0) AS qm3pointsvalue,\n\t\tp.qm3performanceratevalue,\n\t\tp.qm3numeratorvalue,\n\t\tp.qm3denominatorvalue,\n\t\tp.qm4code,\n\t\tCOALESCE(p.qm4pointsvalue, 0) AS qm4pointsvalue,\n\t\tp.qm4performanceratevalue,\n\t\tp.qm4numeratorvalue,\n\t\tp.qm4denominatorvalue,\n\t\tp.qm5code,\n\t\tCOALESCE(p.qm5pointsvalue, 0) AS qm5pointsvalue,\n\t\tp.qm5performanceratevalue,\n\t\tp.qm5numeratorvalue,\n\t\tp.qm5denominatorvalue,\n\t\tp.qm6code,\n\t\tCOALESCE(p.qm6pointsvalue, 0) AS qm6pointsvalue,\n\t\tp.qm6performanceratevalue,\n\t\tp.qm6numeratorvalue,\n\t\tp.qm6denominatorvalue,\n\t\tp.qm7code,\n\t\tCOALESCE(p.qm7pointsvalue, 0) AS qm7pointsvalue,\n\t\tp.qm7performanceratevalue,\n\t\tp.qm7numeratorvalue,\n\t\tp.qm7denominatorvalue,\n\t\tp.qm8code,\n\t\tCOALESCE(p.qm8pointsvalue, 0) AS qm8pointsvalue,\n\t\tp.qm8performanceratevalue,\n\t\tp.qm8numeratorvalue,\n\t\tp.qm8denominatorvalue,\n\t\tp.qm9code,\n\t\tCOALESCE(p.qm9pointsvalue, 0) AS qm9pointsvalue,\n\t\tp.qm9performanceratevalue,\n\t\tp.qm9numeratorvalue,\n\t\tp.qm9denominatorvalue,\n\t\tp.qm10code,\n\t\tCOALESCE(p.qm10pointsvalue, 0) AS qm10pointsvalue,\n\t\tp.qm10performanceratevalue,\n\t\tp.qm10numeratorvalue,\n\t\tp.qm10denominatorvalue,\n\t\tp.qm11code,\n\t\tCOALESCE(p.qm11pointsvalue, 0) AS qm11pointsvalue,\n\t\tp.qm11performanceratevalue,\n\t\tp.qm11numeratorvalue,\n\t\tp.qm11denominatorvalue,\n\t\tp.qmtotalpointsvalue,\n\t\tCOALESCE(p.qmaggregatequalityscorevalue, 0)\n\t\t\tAS qmaggregatequalityscorevalue,\n\t\t'MasterEpisode' AS datasourcetable,\n\t\tp.subscriberid,\n\t\tp.all_other_medical,\n\t\tp.all_other_medical_count,\n\t\tp.amb_surg,\n\t\tp.amb_surg_count,\n\t\tp.attributed_oncologist,\n\t\tp.avoid_ed_ane_allowed,\n\t\tp.avoid_ed_ane_count,\n\t\tp.avoid_ed_deh_allowed,\n\t\tp.avoid_ed_deh_count,\n\t\tp.avoid_ed_die_allowed,\n\t\tp.avoid_ed_die_count,\n\t\tp.avoid_ed_eme_allowed,\n\t\tp.avoid_ed_eme_count,\n\t\tp.avoid_ed_fev_allowed,\n\t\tp.avoid_ed_fev_count,\n\t\tp.avoid_ed_nau_allowed,\n\t\tp.avoid_ed_nau_count,\n\t\tp.avoid_ed_neu_allowed,\n\t\tp.avoid_ed_neu_count,\n\t\tp.avoid_ed_pai_allowed,\n\t\tp.avoid_ed_pai_count,\n\t\tp.avoid_ed_pne_allowed,\n\t\tp.avoid_ed_pne_count,\n\t\tp.avoid_ed_sep_allowed,\n\t\tp.avoid_ed_sep_count,\n\t\tp.avoid_ip_ane_allowed,\n\t\tp.avoid_ip_deh_allowed,\n\t\tp.avoid_ip_deh_count,\n\t\tp.avoid_ip_die_allowed,\n\t\tp.avoid_ip_die_count,\n\t\tp.avoid_ip_eme_allowed,\n\t\tp.avoid_ip_eme_count,\n\t\tp.avoid_ip_fev_allowed,\n\t\tp.avoid_ip_fev_count,\n\t\tp.avoid_ip_nau_allowed,\n\t\tp.avoid_ip_nau_count,\n\t\tp.avoid_ip_neu_allowed,\n\t\tp.avoid_ip_neu_count,\n\t\tp.avoid_ip_pai_allowed,\n\t\tp.avoid_ip_pai_count,\n\t\tp.avoid_ip_pne_allowed,\n\t\tp.avoid_ip_pne_count,\n\t\tp.avoid_ip_sep_allowed,\n\t\tp.avoid_ip_sep_count,\n\t\tp.avoidable_admits_allowed,\n\t\tp.avoidable_ed_allowed,\n\t\tp.avoidable_ed_count,\n\t\tp.birth_date,\n\t\tp.ccf_paid,\n\t\tp.chemo_allowed,\n\t\tp.chemo_count,\n\t\tp.chemo_drugs_medical,\n\t\tp.chemo_drugs_medical_count,\n\t\tp.chemotherapy_type,\n\t\tp.dod,\n\t\tp.ed_allowed,\n\t\tp.ed_visits,\n\t\tp.emergencyroomtotalvisits,\n\t\tp.eol_chemo_allowed,\n\t\tp.eol_chemo_count,\n\t\tp.eol_ed_allowed,\n\t\tp.eol_ed_visits,\n\t\tp.eol_icu_allowed,\n\t\tp.eol_icu_count,\n\t\tp.episode_end_date,\n\t\tp.episode_start_date,\n\t\tp.er,\n\t\tp.er_count,\n\t\tp.gender,\n\t\tp.home,\n\t\tp.inpatient,\n\t\tp.home_count,\n\t\tp.hospice_allowed,\n\t\tp.hospice_claim_admits,\n\t\tp.hospice_los,\n\t\tp.icu_allowed,\n\t\tp.icu_claim_admits,\n\t\tp.icu_los,\n\t\tp.inpatient__all_other_inpatient,\n\t\tp.inpatient__cardiology,\n\t\tp.inpatient__detailed_coded_drugs,\n\t\tp.inpatient__emergency_room,\n\t\tp.inpatient__icu,\n\t\tp.inpatient__imaging,\n\t\tp.inpatient__lab_pathology,\n\t\tp.inpatient__med_surg_supplies,\n\t\tp.inpatient__operation,\n\t\tp.inpatient__pharmacy,\n\t\tp.inpatient__other,\n\t\tp.inpatient__radiation_therapy,\n\t\tp.inpatient__respiratory_pt_ot_st,\n\t\tp.inpatient__room_and_board,\n\t\tp.inpatient_count,\n\t\tp.inpatient_count__all_other_inpatient,\n\t\tp.inpatient_count__cardiology,\n\t\tp.inpatient_count__detailed_coded_drugs,\n\t\tp.inpatient_count__emergency_room,\n\t\tp.inpatient_count__icu,\n\t\tp.inpatient_count__imaging,\n\t\tp.inpatient_count__lab_pathology,\n\t\tp.inpatient_count__med_surg_supplies,\n\t\tp.inpatient_count__operation,\n\t\tp.inpatient_count__other,\n\t\tp.inpatient_count__pharmacy,\n\t\tp.inpatient_count__radiation_therapy,\n\t\tp.inpatient_count__respiratory_pt_ot_st,\n\t\tp.inpatient_count__room_and_board,\n\t\tp.avoidable_admits_count,\n\t\tp.inpatient_drugs_requiring_coding,\n\t\tp.avoid_ip_ane_count,\n\t\tp.ip_allowed,\n\t\tp.ip_claim_admits,\n\t\tp.ip_clusters,\n\t\tp.ip_los,\n\t\tp.lab,\n\t\tp.lab_count,\n\t\tp.min_risk_corridor,\n\t\tp.novel_allowed,\n\t\tp.office,\n\t\tp.office__all_other_office,\n\t\tp.office__cardiovascular_procedures,\n\t\tp.office__drug_admin,\n\t\tp.office__e_and_m,\n\t\tp.office__radioactive_agents,\n\t\tp.office__other,\n\t\tp.office__radiology_mammography,\n\t\tp.office__pathology_and_lab,\n\t\tp.office__psychiatry,\n\t\tp.office__radiation_treatment,\n\t\tp.office__radiology_diagnostic,\n\t\tp.office__radiology_guidance,\n\t\tp.office__radiology_nuclear_medicine,\n\t\tp.office__radiology_other,\n\t\tp.office__radiology_rad_onc_treatment,\n\t\tp.office__surgery,\n\t\tp.office__therapeutic_activities,\n\t\tp.office_count,\n\t\tp.office_count__all_other_office,\n\t\tp.office_count__cardiovascular_procedures,\n\t\tp.office_count__drug_admin,\n\t\tp.office_count__e_and_m,\n\t\tp.office_count__other,\n\t\tp.office_count__pathology_and_lab,\n\t\tp.office_count__psychiatry,\n\t\tp.office_count__radiation_treatment,\n\t\tp.office_count__radioactive_agents,\n\t\tp.office_count__radiology_diagnostic,\n\t\tp.office_count__radiology_guidance,\n\t\tp.office_count__radiology_mammography,\n\t\tp.office_count__radiology_nuclear_medicine,\n\t\tp.office_count__radiology_other,\n\t\tp.office_count__radiology_rad_onc_treatment,\n\t\tp.office_count__surgery,\n\t\tp.office_count__therapeutic_activities,\n\t\tp.operating_room_services_count,\n\t\tp.outpatient,\n\t\tp.outpatient__all_other_outpatient,\n\t\tp.outpatient__chemo_admin,\n\t\tp.outpatient__detailed_coded_drugs,\n\t\tp.outpatient__gastrointestinal,\n\t\tp.outpatient__imaging,\n\t\tp.outpatient__iv_therapy,\n\t\tp.outpatient__lab_pathology,\n\t\tp.outpatient__med_surg_supplies,\n\t\tp.outpatient__nuclear_medicine,\n\t\tp.outpatient__operation,\n\t\tp.outpatient__other,\n\t\tp.outpatient__pharmacy,\n\t\tp.outpatient__radiation_therapy,\n\t\tp.outpatient_count,\n\t\tp.outpatient_count__all_other_outpatient,\n\t\tp.outpatient_count__chemo_admin,\n\t\tp.outpatient_count__detailed_coded_drugs,\n\t\tp.outpatient_count__gastrointestinal,\n\t\tp.outpatient_count__imaging,\n\t\tp.outpatient_count__iv_therapy,\n\t\tp.outpatient_count__lab_pathology,\n\t\tp.outpatient_count__med_surg_supplies,\n\t\tp.outpatient_count__nuclear_medicine,\n\t\tp.outpatient_count__operation,\n\t\tp.outpatient_count__other,\n\t\tp.outpatient_count__pharmacy,\n\t\tp.outpatient_count__radiation_therapy,\n\t\tp.practice,\n\t\tp.prediction,\n\t\tp.retail_pharm,\n\t\tp.retail_pharm_count,\n\t\tp.ssav_expns_amt_no_cap,\n\t\tp.telehealth,\n\t\tp.telehealth_count,\n\t\tp.total_allowed_wind,\n\t\tp.totalallowedamtcostall,\n\t\tp.transportation,\n\t\tp.transportation_count,\n\t\tp.uc,\n\t\tp.uc_count\n\tFROM ic_masterepisode_perfperiod AS p\n\n),\n\nall_recon_sources AS (\n\n\tSELECT * FROM payoricrecon\n\tUNION ALL\n\tSELECT * FROM masterepisode\n)\n\nSELECT\n\tp.filerunid,\n\tp.contractid,\n\tp.lineofbusinessidentifier,\n\tp.administrativetaxidnumber,\n\tp.attributedprovidertaxid,\n\tp.participatingprovidernpinumber,\n\tp.contractstatecode,\n\tp.performanceperiodstartdate,\n\tp.performanceperiodenddate,\n\tp.contractperiodstartdate,\n\tp.contractperiodenddate,\n\tp.programid,\n\tp.providergroupingidentifier,\n\tp.contractname,\n\tp.episodecount,\n\tp.budgetamount,\n\n\tp.trenddescription,\n\tp.noveladjustmentdescription,\n\tp.benchmarkpriceamount,\n\tp.administrativediscountpercent,\n\tp.targetpriceamount,\n\tp.totalallowedactualcostamount,\n\tp.episodeactualtotargetdifferenceamount,\n\tp.sharedsavingspercent,\n\tp.savingspoolamount,\n\tp.sharedsavingsmultipliervalue,\n\tp.sharedsavingsexpenseamount,\n\tp.episodeid,\n\tp.patientstatename,\n\tp.timeperioddates,\n\tp.episodename,\n\tp.qm1code,\n\n\tp.qm1numeratorvalue,\n\tp.qm1denominatorvalue,\n\tp.qm2code,\n\tp.qm2numeratorvalue,\n\tp.qm2denominatorvalue,\n\tp.qm3code,\n\tp.qm3numeratorvalue,\n\tp.qm3denominatorvalue,\n\tp.qm4code,\n\tp.qm4numeratorvalue,\n\tp.qm4denominatorvalue,\n\tp.qm5code,\n\tp.qm5numeratorvalue,\n\tp.qm5denominatorvalue,\n\tp.qm6code,\n\tp.qm6numeratorvalue,\n\tp.qm6denominatorvalue,\n\tp.qm7code,\n\tp.qm7numeratorvalue,\n\tp.qm7denominatorvalue,\n\tp.qm8code,\n\tp.qm8numeratorvalue,\n\tp.qm8denominatorvalue,\n\tp.qm9code,\n\tp.qm9numeratorvalue,\n\tp.qm9denominatorvalue,\n\tp.qm10code,\n\tp.qm10numeratorvalue,\n\tp.qm10denominatorvalue,\n\tp.qm11code,\n\tp.qm11numeratorvalue,\n\tp.qm11denominatorvalue,\n\tp.qmtotalpointsvalue,\n\tp.datasourcetable,\n\tCAST(p.memberid AS number(38, 0)) AS memberid,\n\tCOALESCE(p.qm1pointsvalue, 0) AS qm1pointsvalue,\n\tIFF(\n\t\tp.qm1performanceratevalue > 1,\n\t\tp.qm1performanceratevalue / 100,\n\t\tp.qm1performanceratevalue\n\t) AS qm1performanceratevalue,\n\tCOALESCE(p.qm2pointsvalue, 0) AS qm2pointsvalue,\n\tIFF(\n\t\tp.qm2performanceratevalue > 1,\n\t\tp.qm2performanceratevalue / 100,\n\t\tp.qm2performanceratevalue\n\t) AS qm2performanceratevalue,\n\tCOALESCE(p.qm3pointsvalue, 0) AS qm3pointsvalue,\n\tIFF(\n\t\tp.qm3performanceratevalue > 1,\n\t\tp.qm3performanceratevalue / 100,\n\t\tp.qm3performanceratevalue\n\t) AS qm3performanceratevalue,\n\tCOALESCE(p.qm4pointsvalue, 0) AS qm4pointsvalue,\n\tIFF(\n\t\tp.qm4performanceratevalue > 1,\n\t\tp.qm4performanceratevalue / 100,\n\t\tp.qm4performanceratevalue\n\t) AS qm4performanceratevalue,\n\tCOALESCE(p.qm5pointsvalue, 0) AS qm5pointsvalue,\n\tIFF(\n\t\tp.qm5performanceratevalue > 1,\n\t\tp.qm5performanceratevalue / 100,\n\t\tp.qm5performanceratevalue\n\t) AS qm5performanceratevalue,\n\tCOALESCE(p.qm6pointsvalue, 0) AS qm6pointsvalue,\n\tIFF(\n\t\tp.qm6performanceratevalue > 1,\n\t\tp.qm6performanceratevalue / 100,\n\t\tp.qm6performanceratevalue\n\t) AS qm6performanceratevalue,\n\tCOALESCE(p.qm7pointsvalue, 0) AS qm7pointsvalue,\n\tIFF(\n\t\tp.qm7performanceratevalue > 1,\n\t\tp.qm7performanceratevalue / 100,\n\t\tp.qm7performanceratevalue\n\t) AS qm7performanceratevalue,\n\tCOALESCE(p.qm8pointsvalue, 0) AS qm8pointsvalue,\n\tIFF(\n\t\tp.qm8performanceratevalue > 1,\n\t\tp.qm8performanceratevalue / 100,\n\t\tp.qm8performanceratevalue\n\t) AS qm8performanceratevalue,\n\tCOALESCE(p.qm9pointsvalue, 0) AS qm9pointsvalue,\n\tIFF(\n\t\tp.qm9performanceratevalue > 1,\n\t\tp.qm9performanceratevalue / 100,\n\t\tp.qm9performanceratevalue\n\t) AS qm9performanceratevalue,\n\tCOALESCE(p.qm10pointsvalue, 0) AS qm10pointsvalue,\n\tIFF(\n\t\tp.qm10performanceratevalue > 1,\n\t\tp.qm10performanceratevalue / 100,\n\t\tp.qm10performanceratevalue\n\t) AS qm10performanceratevalue,\n\tCOALESCE(p.qm11pointsvalue, 0) AS qm11pointsvalue,\n\tIFF(\n\t\tp.qm11performanceratevalue > 1,\n\t\tp.qm11performanceratevalue / 100,\n\t\tp.qm11performanceratevalue\n\t) AS qm11performanceratevalue,\n\tCOALESCE(p.qmaggregatequalityscorevalue, 0) AS qmaggregatequalityscorevalue,\n\t\tp.subscriberid,\n\t\tp.all_other_medical,\n\t\tp.all_other_medical_count,\n\t\tp.amb_surg,\n\t\tp.amb_surg_count,\n\t\tp.attributed_oncologist,\n\t\tp.avoid_ed_ane_allowed,\n\t\tp.avoid_ed_ane_count,\n\t\tp.avoid_ed_deh_allowed,\n\t\tp.avoid_ed_deh_count,\n\t\tp.avoid_ed_die_allowed,\n\t\tp.avoid_ed_die_count,\n\t\tp.avoid_ed_eme_allowed,\n\t\tp.avoid_ed_eme_count,\n\t\tp.avoid_ed_fev_allowed,\n\t\tp.avoid_ed_fev_count,\n\t\tp.avoid_ed_nau_allowed,\n\t\tp.avoid_ed_nau_count,\n\t\tp.avoid_ed_neu_allowed,\n\t\tp.avoid_ed_neu_count,\n\t\tp.avoid_ed_pai_allowed,\n\t\tp.avoid_ed_pai_count,\n\t\tp.avoid_ed_pne_allowed,\n\t\tp.avoid_ed_pne_count,\n\t\tp.avoid_ed_sep_allowed,\n\t\tp.avoid_ed_sep_count,\n\t\tp.avoid_ip_ane_allowed,\n\t\tp.avoid_ip_deh_allowed,\n\t\tp.avoid_ip_deh_count,\n\t\tp.avoid_ip_die_allowed,\n\t\tp.avoid_ip_die_count,\n\t\tp.avoid_ip_eme_allowed,\n\t\tp.avoid_ip_eme_count,\n\t\tp.avoid_ip_fev_allowed,\n\t\tp.avoid_ip_fev_count,\n\t\tp.avoid_ip_nau_allowed,\n\t\tp.avoid_ip_nau_count,\n\t\tp.avoid_ip_neu_allowed,\n\t\tp.avoid_ip_neu_count,\n\t\tp.avoid_ip_pai_allowed,\n\t\tp.avoid_ip_pai_count,\n\t\tp.avoid_ip_pne_allowed,\n\t\tp.avoid_ip_pne_count,\n\t\tp.avoid_ip_sep_allowed,\n\t\tp.avoid_ip_sep_count,\n\t\tp.avoidable_admits_allowed,\n\t\tp.avoidable_ed_allowed,\n\t\tp.avoidable_ed_count,\n\t\tp.birth_date,\n\t\tp.ccf_paid,\n\t\tp.chemo_allowed,\n\t\tp.chemo_count,\n\t\tp.chemo_drugs_medical,\n\t\tp.chemo_drugs_medical_count,\n\t\tp.chemotherapy_type,\n\t\tp.dod,\n\t\tp.ed_allowed,\n\t\tp.ed_visits,\n\t\tp.emergencyroomtotalvisits,\n\t\tp.eol_chemo_allowed,\n\t\tp.eol_chemo_count,\n\t\tp.eol_ed_allowed,\n\t\tp.eol_ed_visits,\n\t\tp.eol_icu_allowed,\n\t\tp.eol_icu_count,\n\t\tp.episode_end_date,\n\t\tp.episode_start_date,\n\t\tp.er,\n\t\tp.er_count,\n\t\tp.gender,\n\t\tp.home,\n\t\tp.inpatient,\n\t\tp.home_count,\n\t\tp.hospice_allowed,\n\t\tp.hospice_claim_admits,\n\t\tp.hospice_los,\n\t\tp.icu_allowed,\n\t\tp.icu_claim_admits,\n\t\tp.icu_los,\n\t\tp.inpatient__all_other_inpatient,\n\t\tp.inpatient__cardiology,\n\t\tp.inpatient__detailed_coded_drugs,\n\t\tp.inpatient__emergency_room,\n\t\tp.inpatient__icu,\n\t\tp.inpatient__imaging,\n\t\tp.inpatient__lab_pathology,\n\t\tp.inpatient__med_surg_supplies,\n\t\tp.inpatient__operation,\n\t\tp.inpatient__pharmacy,\n\t\tp.inpatient__other,\n\t\tp.inpatient__radiation_therapy,\n\t\tp.inpatient__respiratory_pt_ot_st,\n\t\tp.inpatient__room_and_board,\n\t\tp.inpatient_count,\n\t\tp.inpatient_count__all_other_inpatient,\n\t\tp.inpatient_count__cardiology,\n\t\tp.inpatient_count__detailed_coded_drugs,\n\t\tp.inpatient_count__emergency_room,\n\t\tp.inpatient_count__icu,\n\t\tp.inpatient_count__imaging,\n\t\tp.inpatient_count__lab_pathology,\n\t\tp.inpatient_count__med_surg_supplies,\n\t\tp.inpatient_count__operation,\n\t\tp.inpatient_count__other,\n\t\tp.inpatient_count__pharmacy,\n\t\tp.inpatient_count__radiation_therapy,\n\t\tp.inpatient_count__respiratory_pt_ot_st,\n\t\tp.inpatient_count__room_and_board,\n\t\tp.avoidable_admits_count,\n\t\tp.inpatient_drugs_requiring_coding,\n\t\tp.avoid_ip_ane_count,\n\t\tp.ip_allowed,\n\t\tp.ip_claim_admits,\n\t\tp.ip_clusters,\n\t\tp.ip_los,\n\t\tp.lab,\n\t\tp.lab_count,\n\t\tp.min_risk_corridor,\n\t\tp.novel_allowed,\n\t\tp.office,\n\t\tp.office__all_other_office,\n\t\tp.office__cardiovascular_procedures,\n\t\tp.office__drug_admin,\n\t\tp.office__e_and_m,\n\t\tp.office__radioactive_agents,\n\t\tp.office__other,\n\t\tp.office__radiology_mammography,\n\t\tp.office__pathology_and_lab,\n\t\tp.office__psychiatry,\n\t\tp.office__radiation_treatment,\n\t\tp.office__radiology_diagnostic,\n\t\tp.office__radiology_guidance,\n\t\tp.office__radiology_nuclear_medicine,\n\t\tp.office__radiology_other,\n\t\tp.office__radiology_rad_onc_treatment,\n\t\tp.office__surgery,\n\t\tp.office__therapeutic_activities,\n\t\tp.office_count,\n\t\tp.office_count__all_other_office,\n\t\tp.office_count__cardiovascular_procedures,\n\t\tp.office_count__drug_admin,\n\t\tp.office_count__e_and_m,\n\t\tp.office_count__other,\n\t\tp.office_count__pathology_and_lab,\n\t\tp.office_count__psychiatry,\n\t\tp.office_count__radiation_treatment,\n\t\tp.office_count__radioactive_agents,\n\t\tp.office_count__radiology_diagnostic,\n\t\tp.office_count__radiology_guidance,\n\t\tp.office_count__radiology_mammography,\n\t\tp.office_count__radiology_nuclear_medicine,\n\t\tp.office_count__radiology_other,\n\t\tp.office_count__radiology_rad_onc_treatment,\n\t\tp.office_count__surgery,\n\t\tp.office_count__therapeutic_activities,\n\t\tp.operating_room_services_count,\n\t\tp.outpatient,\n\t\tp.outpatient__all_other_outpatient,\n\t\tp.outpatient__chemo_admin,\n\t\tp.outpatient__detailed_coded_drugs,\n\t\tp.outpatient__gastrointestinal,\n\t\tp.outpatient__imaging,\n\t\tp.outpatient__iv_therapy,\n\t\tp.outpatient__lab_pathology,\n\t\tp.outpatient__med_surg_supplies,\n\t\tp.outpatient__nuclear_medicine,\n\t\tp.outpatient__operation,\n\t\tp.outpatient__other,\n\t\tp.outpatient__pharmacy,\n\t\tp.outpatient__radiation_therapy,\n\t\tp.outpatient_count,\n\t\tp.outpatient_count__all_other_outpatient,\n\t\tp.outpatient_count__chemo_admin,\n\t\tp.outpatient_count__detailed_coded_drugs,\n\t\tp.outpatient_count__gastrointestinal,\n\t\tp.outpatient_count__imaging,\n\t\tp.outpatient_count__iv_therapy,\n\t\tp.outpatient_count__lab_pathology,\n\t\tp.outpatient_count__med_surg_supplies,\n\t\tp.outpatient_count__nuclear_medicine,\n\t\tp.outpatient_count__operation,\n\t\tp.outpatient_count__other,\n\t\tp.outpatient_count__pharmacy,\n\t\tp.outpatient_count__radiation_therapy,\n\t\tp.practice,\n\t\tp.prediction,\n\t\tp.retail_pharm,\n\t\tp.retail_pharm_count,\n\t\tp.ssav_expns_amt_no_cap,\n\t\tp.telehealth,\n\t\tp.telehealth_count,\n\t\tp.total_allowed_wind,\n\t\tp.totalallowedamtcostall,\n\t\tp.transportation,\n\t\tp.transportation_count,\n\t\tp.uc,\n\t\tp.uc_count\nFROM all_recon_sources AS p",
    "raw_code": "{{ config( alias = 'stg_ic1_recon_source', schema = 'staging') }}\r\n\r\n\r\nWITH ic_payorrecon AS (\r\n\r\n\tSELECT * FROM {{ source('IC1','PAYORICRECON') }}\r\n),\r\n\r\nic_masterepisode AS (\r\n\r\n\tSELECT * FROM {{ source('IC1','MASTEREPISODE') }}\r\n),\r\n\r\nic_masterepisode_perfperiod AS (\r\n\r\n\tSELECT DISTINCT\r\n\t\tic.*,\r\n\t\tpp.perf_period_name,\r\n\t\tREPLACE(\r\n\t\t\tREPLACE(\r\n\t\t\t\tpp.perf_period_name_range, pp.perf_period_name || ' : ', ''\r\n\t\t\t),\r\n\t\t\t' ',\r\n\t\t\t''\r\n\t\t) AS timeperioddates\r\n\tFROM ic_masterepisode AS ic\r\n\t\tINNER JOIN {{ ref('stg_seed_performance_period') }} AS pp\r\n\t\t\tON\r\n\t\t\t\tic.performanceperiodstartdate BETWEEN pp.perf_period_start_date AND pp.perf_period_end_date\r\n\t\t\t\tAND ic.performanceperiodenddate < DATEADD(YEAR, -1, TO_DATE(SYSDATE())) -- no future Perfperiods, based on the next PP will be a year from when this runs\r\n),\r\n\r\npayoricrecon_tin AS (\r\n\tSELECT DISTINCT\r\n\t\tp.*,\r\n\t\tm.tin AS attributedprovidertaxid\r\n\tFROM ic_payorrecon AS p\r\n\t\tINNER JOIN {{ ref('stg_seed_reconpp2_name_tin_mapping') }} AS m\r\n\t\t\tON p.contractname = m.contractname\r\n\tWHERE\r\n\t\tp.performanceperiodstartdate NOT IN (\r\n\t\t\tSELECT DISTINCT mp.performanceperiodstartdate\r\n\t\t\tFROM ic_masterepisode_perfperiod AS mp\r\n\t\t)\r\n\t\tAND p.performanceperiodenddate < DATEADD(YEAR, -1, TO_DATE(SYSDATE())) -- no future Perfperiods, based on the next PP will be a year from when this runs\r\n\tQUALIFY\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY p.memberid, p.performanceperiodstartdate\r\n\t\t\tORDER BY m.tin\r\n\t\t) = 1\r\n),\r\n\r\npayoricrecon AS (\r\n\tSELECT\r\n\t\tp.memberid,\r\n\t\tp.filerunid,\r\n\t\tp.contractid,\r\n\t\tp.lineofbusinessidentifier,\r\n\t\tp.administrativetaxidnumber,\r\n\t\tp.attributedprovidertaxid,\r\n\t\tp.participatingprovidernpinumber,\r\n\t\tp.contractstatecode,\r\n\t\tp.performanceperiodstartdate,\r\n\t\tp.performanceperiodenddate,\r\n\t\tp.contractperiodstartdate,\r\n\t\tp.contractperiodenddate,\r\n\t\tp.programid,\r\n\t\tp.providergroupingidentifier,\r\n\t\tp.contractname,\r\n\t\tp.episodecount,\r\n\t\tp.budgetamount,\r\n\t\tp.trenddescription,\r\n\t\tp.noveladjustmentdescription,\r\n\t\tp.benchmarkpriceamount,\r\n\t\tp.administrativediscountpercent,\r\n\t\tp.targetpriceamount,\r\n\t\tp.totalallowedactualcostamount,\r\n\t\tp.episodeactualtotargetdifferenceamount,\r\n\t\tp.sharedsavingspercent,\r\n\t\tp.savingspoolamount,\r\n\t\tp.sharedsavingsmultipliervalue,\r\n\t\tp.sharedsavingsexpenseamount,\r\n\t\tp.episodeid,\r\n\t\tp.patientstatename,\r\n\t\tp.timeperioddates,\r\n\t\tp.episodename,\r\n\t\tp.qm1code,\r\n\t\tCOALESCE(p.qm1pointsvalue, 0) AS qm1pointsvalue,\r\n\t\tp.qm1performanceratevalue,\r\n\t\tp.qm1numeratorvalue,\r\n\t\tp.qm1denominatorvalue,\r\n\t\tp.qm2code,\r\n\t\tCOALESCE(p.qm2pointsvalue, 0) AS qm2pointsvalue,\r\n\t\tp.qm2performanceratevalue,\r\n\t\tp.qm2numeratorvalue,\r\n\t\tp.qm2denominatorvalue,\r\n\t\tp.qm3code,\r\n\t\tCOALESCE(p.qm3pointsvalue, 0) AS qm3pointsvalue,\r\n\t\tp.qm3performanceratevalue,\r\n\t\tp.qm3numeratorvalue,\r\n\t\tp.qm3denominatorvalue,\r\n\t\tp.qm4code,\r\n\t\tCOALESCE(p.qm4pointsvalue, 0) AS qm4pointsvalue,\r\n\t\tp.qm4performanceratevalue,\r\n\t\tp.qm4numeratorvalue,\r\n\t\tp.qm4denominatorvalue,\r\n\t\tp.qm5code,\r\n\t\tCOALESCE(p.qm5pointsvalue, 0) AS qm5pointsvalue,\r\n\t\tp.qm5performanceratevalue,\r\n\t\tp.qm5numeratorvalue,\r\n\t\tp.qm5denominatorvalue,\r\n\t\tp.qm6code,\r\n\t\tCOALESCE(p.qm6pointsvalue, 0) AS qm6pointsvalue,\r\n\t\tp.qm6performanceratevalue,\r\n\t\tp.qm6numeratorvalue,\r\n\t\tp.qm6denominatorvalue,\r\n\t\tp.qm7code,\r\n\t\tCOALESCE(p.qm7pointsvalue, 0) AS qm7pointsvalue,\r\n\t\tp.qm7performanceratevalue,\r\n\t\tp.qm7numeratorvalue,\r\n\t\tp.qm7denominatorvalue,\r\n\t\tp.qm8code,\r\n\t\tCOALESCE(p.qm8pointsvalue, 0) AS qm8pointsvalue,\r\n\t\tp.qm8performanceratevalue,\r\n\t\tp.qm8numeratorvalue,\r\n\t\tp.qm8denominatorvalue,\r\n\t\tp.qm9code,\r\n\t\tCOALESCE(p.qm9pointsvalue, 0) AS qm9pointsvalue,\r\n\t\tp.qm9performanceratevalue,\r\n\t\tp.qm9numeratorvalue,\r\n\t\tp.qm9denominatorvalue,\r\n\t\tp.qm10code,\r\n\t\tCOALESCE(p.qm10pointsvalue, 0) AS qm10pointsvalue,\r\n\t\tp.qm10performanceratevalue,\r\n\t\tp.qm10numeratorvalue,\r\n\t\tp.qm10denominatorvalue,\r\n\t\tp.qm11code,\r\n\t\tCOALESCE(p.qm11pointsvalue, 0) AS qm11pointsvalue,\r\n\t\tp.qm11performanceratevalue,\r\n\t\tp.qm11numeratorvalue,\r\n\t\tp.qm11denominatorvalue,\r\n\t\tp.qmtotalpointsvalue,\r\n\t\tCOALESCE(p.qmaggregatequalityscorevalue, 0)\r\n\t\t\tAS qmaggregatequalityscorevalue,\r\n\t\t'PayorICRecon' AS datasourcetable,\r\n        NULL AS  subscriberid,\r\n\t\t NULL AS  all_other_medical,\r\n\t\t NULL AS  all_other_medical_count,\r\n\t\t NULL AS  amb_surg,\r\n\t\t NULL AS  amb_surg_count,\r\n\t\t NULL AS  attributed_oncologist,\r\n\t\t NULL AS  avoid_ed_ane_allowed,\r\n\t\t NULL AS  avoid_ed_ane_count,\r\n\t\t NULL AS  avoid_ed_deh_allowed,\r\n\t\t NULL AS  avoid_ed_deh_count,\r\n\t\t NULL AS  avoid_ed_die_allowed,\r\n\t\t NULL AS  avoid_ed_die_count,\r\n\t\t NULL AS  avoid_ed_eme_allowed,\r\n\t\t NULL AS  avoid_ed_eme_count,\r\n\t\t NULL AS  avoid_ed_fev_allowed,\r\n\t\t NULL AS  avoid_ed_fev_count,\r\n\t\t NULL AS  avoid_ed_nau_allowed,\r\n\t\t NULL AS  avoid_ed_nau_count,\r\n\t\t NULL AS  avoid_ed_neu_allowed,\r\n\t\t NULL AS  avoid_ed_neu_count,\r\n\t\t NULL AS  avoid_ed_pai_allowed,\r\n\t\t NULL AS  avoid_ed_pai_count,\r\n\t\t NULL AS  avoid_ed_pne_allowed,\r\n\t\t NULL AS  avoid_ed_pne_count,\r\n\t\t NULL AS  avoid_ed_sep_allowed,\r\n\t\t NULL AS  avoid_ed_sep_count,\r\n\t\t NULL AS  avoid_ip_ane_allowed,\r\n\t\t NULL AS  avoid_ip_deh_allowed,\r\n\t\t NULL AS  avoid_ip_deh_count,\r\n\t\t NULL AS  avoid_ip_die_allowed,\r\n\t\t NULL AS  avoid_ip_die_count,\r\n\t\t NULL AS  avoid_ip_eme_allowed,\r\n\t\t NULL AS  avoid_ip_eme_count,\r\n\t\t NULL AS  avoid_ip_fev_allowed,\r\n\t\t NULL AS  avoid_ip_fev_count,\r\n\t\t NULL AS  avoid_ip_nau_allowed,\r\n\t\t NULL AS  avoid_ip_nau_count,\r\n\t\t NULL AS  avoid_ip_neu_allowed,\r\n\t\t NULL AS  avoid_ip_neu_count,\r\n\t\t NULL AS  avoid_ip_pai_allowed,\r\n\t\t NULL AS  avoid_ip_pai_count,\r\n\t\t NULL AS  avoid_ip_pne_allowed,\r\n\t\t NULL AS  avoid_ip_pne_count,\r\n\t\t NULL AS  avoid_ip_sep_allowed,\r\n\t\t NULL AS  avoid_ip_sep_count,\r\n\t\t NULL AS  avoidable_admits_allowed,\r\n\t\t NULL AS  avoidable_ed_allowed,\r\n\t\t NULL AS  avoidable_ed_count,\r\n\t\t NULL AS  birth_date,\r\n\t\t NULL AS  ccf_paid,\r\n\t\t NULL AS  chemo_allowed,\r\n\t\t NULL AS  chemo_count,\r\n\t\t NULL AS  chemo_drugs_medical,\r\n\t\t NULL AS  chemo_drugs_medical_count,\r\n\t\t NULL AS  chemotherapy_type,\r\n\t\t NULL AS  dod,\r\n\t\t NULL AS  ed_allowed,\r\n\t\t NULL AS  ed_visits,\r\n\t\t NULL AS  emergencyroomtotalvisits,\r\n\t\t NULL AS  eol_chemo_allowed,\r\n\t\t NULL AS  eol_chemo_count,\r\n\t\t NULL AS  eol_ed_allowed,\r\n\t\t NULL AS  eol_ed_visits,\r\n\t\t NULL AS  eol_icu_allowed,\r\n\t\t NULL AS  eol_icu_count,\r\n\t\t NULL AS  episode_end_date,\r\n\t\t NULL AS  episode_start_date,\r\n\t\t NULL AS  er,\r\n\t\t NULL AS  er_count,\r\n\t\t NULL AS  gender,\r\n\t\t NULL AS  home,\r\n\t\t NULL AS  inpatient,\r\n\t\t NULL AS  home_count,\r\n\t\t NULL AS  hospice_allowed,\r\n\t\t NULL AS  hospice_claim_admits,\r\n\t\t NULL AS  hospice_los,\r\n\t\t NULL AS  icu_allowed,\r\n\t\t NULL AS  icu_claim_admits,\r\n\t\t NULL AS  icu_los,\r\n\t\t NULL AS  inpatient__all_other_inpatient,\r\n\t\t NULL AS  inpatient__cardiology,\r\n\t\t NULL AS  inpatient__detailed_coded_drugs,\r\n\t\t NULL AS  inpatient__emergency_room,\r\n\t\t NULL AS  inpatient__icu,\r\n\t\t NULL AS  inpatient__imaging,\r\n\t\t NULL AS  inpatient__lab_pathology,\r\n\t\t NULL AS  inpatient__med_surg_supplies,\r\n\t\t NULL AS  inpatient__operation,\r\n\t\t NULL AS  inpatient__pharmacy,\r\n\t\t NULL AS  inpatient__other,\r\n\t\t NULL AS  inpatient__radiation_therapy,\r\n\t\t NULL AS  inpatient__respiratory_pt_ot_st,\r\n\t\t NULL AS  inpatient__room_and_board,\r\n\t\t NULL AS  inpatient_count,\r\n\t\t NULL AS  inpatient_count__all_other_inpatient,\r\n\t\t NULL AS  inpatient_count__cardiology,\r\n\t\t NULL AS  inpatient_count__detailed_coded_drugs,\r\n\t\t NULL AS  inpatient_count__emergency_room,\r\n\t\t NULL AS  inpatient_count__icu,\r\n\t\t NULL AS  inpatient_count__imaging,\r\n\t\t NULL AS  inpatient_count__lab_pathology,\r\n\t\t NULL AS  inpatient_count__med_surg_supplies,\r\n\t\t NULL AS  inpatient_count__operation,\r\n\t\t NULL AS  inpatient_count__other,\r\n\t\t NULL AS  inpatient_count__pharmacy,\r\n\t\t NULL AS  inpatient_count__radiation_therapy,\r\n\t\t NULL AS  inpatient_count__respiratory_pt_ot_st,\r\n\t\t NULL AS  inpatient_count__room_and_board,\r\n\t\t NULL AS  avoidable_admits_count,\r\n\t\t NULL AS  inpatient_drugs_requiring_coding,\r\n\t\t NULL AS  avoid_ip_ane_count,\r\n\t\t NULL AS  ip_allowed,\r\n\t\t NULL AS  ip_claim_admits,\r\n\t\t NULL AS  ip_clusters,\r\n\t\t NULL AS  ip_los,\r\n\t\t NULL AS  lab,\r\n\t\t NULL AS  lab_count,\r\n\t\t NULL AS  min_risk_corridor,\r\n\t\t NULL AS  novel_allowed,\r\n\t\t NULL AS  office,\r\n\t\t NULL AS  office__all_other_office,\r\n\t\t NULL AS  office__cardiovascular_procedures,\r\n\t\t NULL AS  office__drug_admin,\r\n\t\t NULL AS  office__e_and_m,\r\n\t\t NULL AS  office__radioactive_agents,\r\n\t\t NULL AS  office__other,\r\n\t\t NULL AS  office__radiology_mammography,\r\n\t\t NULL AS  office__pathology_and_lab,\r\n\t\t NULL AS  office__psychiatry,\r\n\t\t NULL AS  office__radiation_treatment,\r\n\t\t NULL AS  office__radiology_diagnostic,\r\n\t\t NULL AS  office__radiology_guidance,\r\n\t\t NULL AS  office__radiology_nuclear_medicine,\r\n\t\t NULL AS  office__radiology_other,\r\n\t\t NULL AS  office__radiology_rad_onc_treatment,\r\n\t\t NULL AS  office__surgery,\r\n\t\t NULL AS  office__therapeutic_activities,\r\n\t\t NULL AS  office_count,\r\n\t\t NULL AS  office_count__all_other_office,\r\n\t\t NULL AS  office_count__cardiovascular_procedures,\r\n\t\t NULL AS  office_count__drug_admin,\r\n\t\t NULL AS  office_count__e_and_m,\r\n\t\t NULL AS  office_count__other,\r\n\t\t NULL AS  office_count__pathology_and_lab,\r\n\t\t NULL AS  office_count__psychiatry,\r\n\t\t NULL AS  office_count__radiation_treatment,\r\n\t\t NULL AS  office_count__radioactive_agents,\r\n\t\t NULL AS  office_count__radiology_diagnostic,\r\n\t\t NULL AS  office_count__radiology_guidance,\r\n\t\t NULL AS  office_count__radiology_mammography,\r\n\t\t NULL AS  office_count__radiology_nuclear_medicine,\r\n\t\t NULL AS  office_count__radiology_other,\r\n\t\t NULL AS  office_count__radiology_rad_onc_treatment,\r\n\t\t NULL AS  office_count__surgery,\r\n\t\t NULL AS  office_count__therapeutic_activities,\r\n\t\t NULL AS  operating_room_services_count,\r\n\t\t NULL AS  outpatient,\r\n\t\t NULL AS  outpatient__all_other_outpatient,\r\n\t\t NULL AS  outpatient__chemo_admin,\r\n\t\t NULL AS  outpatient__detailed_coded_drugs,\r\n\t\t NULL AS  outpatient__gastrointestinal,\r\n\t\t NULL AS  outpatient__imaging,\r\n\t\t NULL AS  outpatient__iv_therapy,\r\n\t\t NULL AS  outpatient__lab_pathology,\r\n\t\t NULL AS  outpatient__med_surg_supplies,\r\n\t\t NULL AS  outpatient__nuclear_medicine,\r\n\t\t NULL AS  outpatient__operation,\r\n\t\t NULL AS  outpatient__other,\r\n\t\t NULL AS  outpatient__pharmacy,\r\n\t\t NULL AS  outpatient__radiation_therapy,\r\n\t\t NULL AS  outpatient_count,\r\n\t\t NULL AS  outpatient_count__all_other_outpatient,\r\n\t\t NULL AS  outpatient_count__chemo_admin,\r\n\t\t NULL AS  outpatient_count__detailed_coded_drugs,\r\n\t\t NULL AS  outpatient_count__gastrointestinal,\r\n\t\t NULL AS  outpatient_count__imaging,\r\n\t\t NULL AS  outpatient_count__iv_therapy,\r\n\t\t NULL AS  outpatient_count__lab_pathology,\r\n\t\t NULL AS  outpatient_count__med_surg_supplies,\r\n\t\t NULL AS  outpatient_count__nuclear_medicine,\r\n\t\t NULL AS  outpatient_count__operation,\r\n\t\t NULL AS  outpatient_count__other,\r\n\t\t NULL AS  outpatient_count__pharmacy,\r\n\t\t NULL AS  outpatient_count__radiation_therapy,\r\n\t\t NULL AS  practice,\r\n\t\t NULL AS  prediction,\r\n\t\t NULL AS  retail_pharm,\r\n\t\t NULL AS  retail_pharm_count,\r\n\t\t NULL AS  ssav_expns_amt_no_cap,\r\n\t\t NULL AS  telehealth,\r\n\t\t NULL AS  telehealth_count,\r\n\t\t NULL AS  total_allowed_wind,\r\n\t\t NULL AS  totalallowedamtcostall,\r\n\t\t NULL AS  transportation,\r\n\t\t NULL AS  transportation_count,\r\n\t\t NULL AS  uc,\r\n\t\t NULL AS  uc_count\r\n\tFROM payoricrecon_tin AS p\r\n),\r\n\r\nmasterepisode AS (\r\n\tSELECT\r\n\t\tp.memberid,\r\n\t\tp.runid AS filerunid,\r\n\t\tp.contractid,\r\n\t\tp.lineofbusinessidentifier,\r\n\t\tp.oncologist_tin AS administrativetaxidnumber,\r\n\t\tp.oncologist_tin AS attributedprovidertaxid,\r\n\t\tp.oncologist_npi AS participatingprovidernpinumber,\r\n\t\tp.contractstatecode,\r\n\t\tp.performanceperiodstartdate,\r\n\t\tp.performanceperiodenddate,\r\n\t\tNULL AS contractperiodstartdate,\r\n\t\tNULL AS contractperiodenddate,\r\n\t\tp.pgm_id AS programid,\r\n\t\tp.pg_id AS providergroupingidentifier,\r\n\t\tp.contractname,\r\n\t\tp.episode_count AS episodecount,\r\n\r\n\t\tp.prediction_wind AS budgetamount,\r\n\t\tp.trend AS trenddescription,\r\n\t\tp.novel_adj AS noveladjustmentdescription,\r\n\t\tp.benchmark_price AS benchmarkpriceamount,\r\n\t\tp.mrc_percent AS administrativediscountpercent,\r\n\t\tp.target AS targetpriceamount,\r\n\t\tp.total_expenditures AS totalallowedactualcostamount,\r\n\t\tp.epsdactualtargetdiff AS episodeactualtotargetdifferenceamount,\r\n\t\tp.ssprct AS sharedsavingspercent,\r\n\t\tp.savings_pool AS savingspoolamount,\r\n\t\tp.quality_multiplier AS sharedsavingsmultipliervalue,\r\n\t\tp.ssav_expns_amt AS sharedsavingsexpenseamount,\r\n\t\tp.episodeid,\r\n\t\tp.member_state AS patientstatename,\r\n\t\tp.timeperioddates,\r\n\t\tp.cancer_type AS episodename,\r\n\r\n\t\tp.qm1code,\r\n\t\tCOALESCE(p.qm1pointsvalue, 0) AS qm1pointsvalue,\r\n\t\tp.qm1performanceratevalue,\r\n\t\tp.qm1numeratorvalue,\r\n\t\tp.qm1denominatorvalue,\r\n\t\tp.qm2code,\r\n\t\tCOALESCE(p.qm2pointsvalue, 0) AS qm2pointsvalue,\r\n\t\tp.qm2performanceratevalue,\r\n\t\tp.qm2numeratorvalue,\r\n\t\tp.qm2denominatorvalue,\r\n\t\tp.qm3code,\r\n\t\tCOALESCE(p.qm3pointsvalue, 0) AS qm3pointsvalue,\r\n\t\tp.qm3performanceratevalue,\r\n\t\tp.qm3numeratorvalue,\r\n\t\tp.qm3denominatorvalue,\r\n\t\tp.qm4code,\r\n\t\tCOALESCE(p.qm4pointsvalue, 0) AS qm4pointsvalue,\r\n\t\tp.qm4performanceratevalue,\r\n\t\tp.qm4numeratorvalue,\r\n\t\tp.qm4denominatorvalue,\r\n\t\tp.qm5code,\r\n\t\tCOALESCE(p.qm5pointsvalue, 0) AS qm5pointsvalue,\r\n\t\tp.qm5performanceratevalue,\r\n\t\tp.qm5numeratorvalue,\r\n\t\tp.qm5denominatorvalue,\r\n\t\tp.qm6code,\r\n\t\tCOALESCE(p.qm6pointsvalue, 0) AS qm6pointsvalue,\r\n\t\tp.qm6performanceratevalue,\r\n\t\tp.qm6numeratorvalue,\r\n\t\tp.qm6denominatorvalue,\r\n\t\tp.qm7code,\r\n\t\tCOALESCE(p.qm7pointsvalue, 0) AS qm7pointsvalue,\r\n\t\tp.qm7performanceratevalue,\r\n\t\tp.qm7numeratorvalue,\r\n\t\tp.qm7denominatorvalue,\r\n\t\tp.qm8code,\r\n\t\tCOALESCE(p.qm8pointsvalue, 0) AS qm8pointsvalue,\r\n\t\tp.qm8performanceratevalue,\r\n\t\tp.qm8numeratorvalue,\r\n\t\tp.qm8denominatorvalue,\r\n\t\tp.qm9code,\r\n\t\tCOALESCE(p.qm9pointsvalue, 0) AS qm9pointsvalue,\r\n\t\tp.qm9performanceratevalue,\r\n\t\tp.qm9numeratorvalue,\r\n\t\tp.qm9denominatorvalue,\r\n\t\tp.qm10code,\r\n\t\tCOALESCE(p.qm10pointsvalue, 0) AS qm10pointsvalue,\r\n\t\tp.qm10performanceratevalue,\r\n\t\tp.qm10numeratorvalue,\r\n\t\tp.qm10denominatorvalue,\r\n\t\tp.qm11code,\r\n\t\tCOALESCE(p.qm11pointsvalue, 0) AS qm11pointsvalue,\r\n\t\tp.qm11performanceratevalue,\r\n\t\tp.qm11numeratorvalue,\r\n\t\tp.qm11denominatorvalue,\r\n\t\tp.qmtotalpointsvalue,\r\n\t\tCOALESCE(p.qmaggregatequalityscorevalue, 0)\r\n\t\t\tAS qmaggregatequalityscorevalue,\r\n\t\t'MasterEpisode' AS datasourcetable,\r\n\t\tp.subscriberid,\r\n\t\tp.all_other_medical,\r\n\t\tp.all_other_medical_count,\r\n\t\tp.amb_surg,\r\n\t\tp.amb_surg_count,\r\n\t\tp.attributed_oncologist,\r\n\t\tp.avoid_ed_ane_allowed,\r\n\t\tp.avoid_ed_ane_count,\r\n\t\tp.avoid_ed_deh_allowed,\r\n\t\tp.avoid_ed_deh_count,\r\n\t\tp.avoid_ed_die_allowed,\r\n\t\tp.avoid_ed_die_count,\r\n\t\tp.avoid_ed_eme_allowed,\r\n\t\tp.avoid_ed_eme_count,\r\n\t\tp.avoid_ed_fev_allowed,\r\n\t\tp.avoid_ed_fev_count,\r\n\t\tp.avoid_ed_nau_allowed,\r\n\t\tp.avoid_ed_nau_count,\r\n\t\tp.avoid_ed_neu_allowed,\r\n\t\tp.avoid_ed_neu_count,\r\n\t\tp.avoid_ed_pai_allowed,\r\n\t\tp.avoid_ed_pai_count,\r\n\t\tp.avoid_ed_pne_allowed,\r\n\t\tp.avoid_ed_pne_count,\r\n\t\tp.avoid_ed_sep_allowed,\r\n\t\tp.avoid_ed_sep_count,\r\n\t\tp.avoid_ip_ane_allowed,\r\n\t\tp.avoid_ip_deh_allowed,\r\n\t\tp.avoid_ip_deh_count,\r\n\t\tp.avoid_ip_die_allowed,\r\n\t\tp.avoid_ip_die_count,\r\n\t\tp.avoid_ip_eme_allowed,\r\n\t\tp.avoid_ip_eme_count,\r\n\t\tp.avoid_ip_fev_allowed,\r\n\t\tp.avoid_ip_fev_count,\r\n\t\tp.avoid_ip_nau_allowed,\r\n\t\tp.avoid_ip_nau_count,\r\n\t\tp.avoid_ip_neu_allowed,\r\n\t\tp.avoid_ip_neu_count,\r\n\t\tp.avoid_ip_pai_allowed,\r\n\t\tp.avoid_ip_pai_count,\r\n\t\tp.avoid_ip_pne_allowed,\r\n\t\tp.avoid_ip_pne_count,\r\n\t\tp.avoid_ip_sep_allowed,\r\n\t\tp.avoid_ip_sep_count,\r\n\t\tp.avoidable_admits_allowed,\r\n\t\tp.avoidable_ed_allowed,\r\n\t\tp.avoidable_ed_count,\r\n\t\tp.birth_date,\r\n\t\tp.ccf_paid,\r\n\t\tp.chemo_allowed,\r\n\t\tp.chemo_count,\r\n\t\tp.chemo_drugs_medical,\r\n\t\tp.chemo_drugs_medical_count,\r\n\t\tp.chemotherapy_type,\r\n\t\tp.dod,\r\n\t\tp.ed_allowed,\r\n\t\tp.ed_visits,\r\n\t\tp.emergencyroomtotalvisits,\r\n\t\tp.eol_chemo_allowed,\r\n\t\tp.eol_chemo_count,\r\n\t\tp.eol_ed_allowed,\r\n\t\tp.eol_ed_visits,\r\n\t\tp.eol_icu_allowed,\r\n\t\tp.eol_icu_count,\r\n\t\tp.episode_end_date,\r\n\t\tp.episode_start_date,\r\n\t\tp.er,\r\n\t\tp.er_count,\r\n\t\tp.gender,\r\n\t\tp.home,\r\n\t\tp.inpatient,\r\n\t\tp.home_count,\r\n\t\tp.hospice_allowed,\r\n\t\tp.hospice_claim_admits,\r\n\t\tp.hospice_los,\r\n\t\tp.icu_allowed,\r\n\t\tp.icu_claim_admits,\r\n\t\tp.icu_los,\r\n\t\tp.inpatient__all_other_inpatient,\r\n\t\tp.inpatient__cardiology,\r\n\t\tp.inpatient__detailed_coded_drugs,\r\n\t\tp.inpatient__emergency_room,\r\n\t\tp.inpatient__icu,\r\n\t\tp.inpatient__imaging,\r\n\t\tp.inpatient__lab_pathology,\r\n\t\tp.inpatient__med_surg_supplies,\r\n\t\tp.inpatient__operation,\r\n\t\tp.inpatient__pharmacy,\r\n\t\tp.inpatient__other,\r\n\t\tp.inpatient__radiation_therapy,\r\n\t\tp.inpatient__respiratory_pt_ot_st,\r\n\t\tp.inpatient__room_and_board,\r\n\t\tp.inpatient_count,\r\n\t\tp.inpatient_count__all_other_inpatient,\r\n\t\tp.inpatient_count__cardiology,\r\n\t\tp.inpatient_count__detailed_coded_drugs,\r\n\t\tp.inpatient_count__emergency_room,\r\n\t\tp.inpatient_count__icu,\r\n\t\tp.inpatient_count__imaging,\r\n\t\tp.inpatient_count__lab_pathology,\r\n\t\tp.inpatient_count__med_surg_supplies,\r\n\t\tp.inpatient_count__operation,\r\n\t\tp.inpatient_count__other,\r\n\t\tp.inpatient_count__pharmacy,\r\n\t\tp.inpatient_count__radiation_therapy,\r\n\t\tp.inpatient_count__respiratory_pt_ot_st,\r\n\t\tp.inpatient_count__room_and_board,\r\n\t\tp.avoidable_admits_count,\r\n\t\tp.inpatient_drugs_requiring_coding,\r\n\t\tp.avoid_ip_ane_count,\r\n\t\tp.ip_allowed,\r\n\t\tp.ip_claim_admits,\r\n\t\tp.ip_clusters,\r\n\t\tp.ip_los,\r\n\t\tp.lab,\r\n\t\tp.lab_count,\r\n\t\tp.min_risk_corridor,\r\n\t\tp.novel_allowed,\r\n\t\tp.office,\r\n\t\tp.office__all_other_office,\r\n\t\tp.office__cardiovascular_procedures,\r\n\t\tp.office__drug_admin,\r\n\t\tp.office__e_and_m,\r\n\t\tp.office__radioactive_agents,\r\n\t\tp.office__other,\r\n\t\tp.office__radiology_mammography,\r\n\t\tp.office__pathology_and_lab,\r\n\t\tp.office__psychiatry,\r\n\t\tp.office__radiation_treatment,\r\n\t\tp.office__radiology_diagnostic,\r\n\t\tp.office__radiology_guidance,\r\n\t\tp.office__radiology_nuclear_medicine,\r\n\t\tp.office__radiology_other,\r\n\t\tp.office__radiology_rad_onc_treatment,\r\n\t\tp.office__surgery,\r\n\t\tp.office__therapeutic_activities,\r\n\t\tp.office_count,\r\n\t\tp.office_count__all_other_office,\r\n\t\tp.office_count__cardiovascular_procedures,\r\n\t\tp.office_count__drug_admin,\r\n\t\tp.office_count__e_and_m,\r\n\t\tp.office_count__other,\r\n\t\tp.office_count__pathology_and_lab,\r\n\t\tp.office_count__psychiatry,\r\n\t\tp.office_count__radiation_treatment,\r\n\t\tp.office_count__radioactive_agents,\r\n\t\tp.office_count__radiology_diagnostic,\r\n\t\tp.office_count__radiology_guidance,\r\n\t\tp.office_count__radiology_mammography,\r\n\t\tp.office_count__radiology_nuclear_medicine,\r\n\t\tp.office_count__radiology_other,\r\n\t\tp.office_count__radiology_rad_onc_treatment,\r\n\t\tp.office_count__surgery,\r\n\t\tp.office_count__therapeutic_activities,\r\n\t\tp.operating_room_services_count,\r\n\t\tp.outpatient,\r\n\t\tp.outpatient__all_other_outpatient,\r\n\t\tp.outpatient__chemo_admin,\r\n\t\tp.outpatient__detailed_coded_drugs,\r\n\t\tp.outpatient__gastrointestinal,\r\n\t\tp.outpatient__imaging,\r\n\t\tp.outpatient__iv_therapy,\r\n\t\tp.outpatient__lab_pathology,\r\n\t\tp.outpatient__med_surg_supplies,\r\n\t\tp.outpatient__nuclear_medicine,\r\n\t\tp.outpatient__operation,\r\n\t\tp.outpatient__other,\r\n\t\tp.outpatient__pharmacy,\r\n\t\tp.outpatient__radiation_therapy,\r\n\t\tp.outpatient_count,\r\n\t\tp.outpatient_count__all_other_outpatient,\r\n\t\tp.outpatient_count__chemo_admin,\r\n\t\tp.outpatient_count__detailed_coded_drugs,\r\n\t\tp.outpatient_count__gastrointestinal,\r\n\t\tp.outpatient_count__imaging,\r\n\t\tp.outpatient_count__iv_therapy,\r\n\t\tp.outpatient_count__lab_pathology,\r\n\t\tp.outpatient_count__med_surg_supplies,\r\n\t\tp.outpatient_count__nuclear_medicine,\r\n\t\tp.outpatient_count__operation,\r\n\t\tp.outpatient_count__other,\r\n\t\tp.outpatient_count__pharmacy,\r\n\t\tp.outpatient_count__radiation_therapy,\r\n\t\tp.practice,\r\n\t\tp.prediction,\r\n\t\tp.retail_pharm,\r\n\t\tp.retail_pharm_count,\r\n\t\tp.ssav_expns_amt_no_cap,\r\n\t\tp.telehealth,\r\n\t\tp.telehealth_count,\r\n\t\tp.total_allowed_wind,\r\n\t\tp.totalallowedamtcostall,\r\n\t\tp.transportation,\r\n\t\tp.transportation_count,\r\n\t\tp.uc,\r\n\t\tp.uc_count\r\n\tFROM ic_masterepisode_perfperiod AS p\r\n\r\n),\r\n\r\nall_recon_sources AS (\r\n\r\n\tSELECT * FROM payoricrecon\r\n\tUNION ALL\r\n\tSELECT * FROM masterepisode\r\n)\r\n\r\nSELECT\r\n\tp.filerunid,\r\n\tp.contractid,\r\n\tp.lineofbusinessidentifier,\r\n\tp.administrativetaxidnumber,\r\n\tp.attributedprovidertaxid,\r\n\tp.participatingprovidernpinumber,\r\n\tp.contractstatecode,\r\n\tp.performanceperiodstartdate,\r\n\tp.performanceperiodenddate,\r\n\tp.contractperiodstartdate,\r\n\tp.contractperiodenddate,\r\n\tp.programid,\r\n\tp.providergroupingidentifier,\r\n\tp.contractname,\r\n\tp.episodecount,\r\n\tp.budgetamount,\r\n\r\n\tp.trenddescription,\r\n\tp.noveladjustmentdescription,\r\n\tp.benchmarkpriceamount,\r\n\tp.administrativediscountpercent,\r\n\tp.targetpriceamount,\r\n\tp.totalallowedactualcostamount,\r\n\tp.episodeactualtotargetdifferenceamount,\r\n\tp.sharedsavingspercent,\r\n\tp.savingspoolamount,\r\n\tp.sharedsavingsmultipliervalue,\r\n\tp.sharedsavingsexpenseamount,\r\n\tp.episodeid,\r\n\tp.patientstatename,\r\n\tp.timeperioddates,\r\n\tp.episodename,\r\n\tp.qm1code,\r\n\r\n\tp.qm1numeratorvalue,\r\n\tp.qm1denominatorvalue,\r\n\tp.qm2code,\r\n\tp.qm2numeratorvalue,\r\n\tp.qm2denominatorvalue,\r\n\tp.qm3code,\r\n\tp.qm3numeratorvalue,\r\n\tp.qm3denominatorvalue,\r\n\tp.qm4code,\r\n\tp.qm4numeratorvalue,\r\n\tp.qm4denominatorvalue,\r\n\tp.qm5code,\r\n\tp.qm5numeratorvalue,\r\n\tp.qm5denominatorvalue,\r\n\tp.qm6code,\r\n\tp.qm6numeratorvalue,\r\n\tp.qm6denominatorvalue,\r\n\tp.qm7code,\r\n\tp.qm7numeratorvalue,\r\n\tp.qm7denominatorvalue,\r\n\tp.qm8code,\r\n\tp.qm8numeratorvalue,\r\n\tp.qm8denominatorvalue,\r\n\tp.qm9code,\r\n\tp.qm9numeratorvalue,\r\n\tp.qm9denominatorvalue,\r\n\tp.qm10code,\r\n\tp.qm10numeratorvalue,\r\n\tp.qm10denominatorvalue,\r\n\tp.qm11code,\r\n\tp.qm11numeratorvalue,\r\n\tp.qm11denominatorvalue,\r\n\tp.qmtotalpointsvalue,\r\n\tp.datasourcetable,\r\n\tCAST(p.memberid AS number(38, 0)) AS memberid,\r\n\tCOALESCE(p.qm1pointsvalue, 0) AS qm1pointsvalue,\r\n\tIFF(\r\n\t\tp.qm1performanceratevalue > 1,\r\n\t\tp.qm1performanceratevalue / 100,\r\n\t\tp.qm1performanceratevalue\r\n\t) AS qm1performanceratevalue,\r\n\tCOALESCE(p.qm2pointsvalue, 0) AS qm2pointsvalue,\r\n\tIFF(\r\n\t\tp.qm2performanceratevalue > 1,\r\n\t\tp.qm2performanceratevalue / 100,\r\n\t\tp.qm2performanceratevalue\r\n\t) AS qm2performanceratevalue,\r\n\tCOALESCE(p.qm3pointsvalue, 0) AS qm3pointsvalue,\r\n\tIFF(\r\n\t\tp.qm3performanceratevalue > 1,\r\n\t\tp.qm3performanceratevalue / 100,\r\n\t\tp.qm3performanceratevalue\r\n\t) AS qm3performanceratevalue,\r\n\tCOALESCE(p.qm4pointsvalue, 0) AS qm4pointsvalue,\r\n\tIFF(\r\n\t\tp.qm4performanceratevalue > 1,\r\n\t\tp.qm4performanceratevalue / 100,\r\n\t\tp.qm4performanceratevalue\r\n\t) AS qm4performanceratevalue,\r\n\tCOALESCE(p.qm5pointsvalue, 0) AS qm5pointsvalue,\r\n\tIFF(\r\n\t\tp.qm5performanceratevalue > 1,\r\n\t\tp.qm5performanceratevalue / 100,\r\n\t\tp.qm5performanceratevalue\r\n\t) AS qm5performanceratevalue,\r\n\tCOALESCE(p.qm6pointsvalue, 0) AS qm6pointsvalue,\r\n\tIFF(\r\n\t\tp.qm6performanceratevalue > 1,\r\n\t\tp.qm6performanceratevalue / 100,\r\n\t\tp.qm6performanceratevalue\r\n\t) AS qm6performanceratevalue,\r\n\tCOALESCE(p.qm7pointsvalue, 0) AS qm7pointsvalue,\r\n\tIFF(\r\n\t\tp.qm7performanceratevalue > 1,\r\n\t\tp.qm7performanceratevalue / 100,\r\n\t\tp.qm7performanceratevalue\r\n\t) AS qm7performanceratevalue,\r\n\tCOALESCE(p.qm8pointsvalue, 0) AS qm8pointsvalue,\r\n\tIFF(\r\n\t\tp.qm8performanceratevalue > 1,\r\n\t\tp.qm8performanceratevalue / 100,\r\n\t\tp.qm8performanceratevalue\r\n\t) AS qm8performanceratevalue,\r\n\tCOALESCE(p.qm9pointsvalue, 0) AS qm9pointsvalue,\r\n\tIFF(\r\n\t\tp.qm9performanceratevalue > 1,\r\n\t\tp.qm9performanceratevalue / 100,\r\n\t\tp.qm9performanceratevalue\r\n\t) AS qm9performanceratevalue,\r\n\tCOALESCE(p.qm10pointsvalue, 0) AS qm10pointsvalue,\r\n\tIFF(\r\n\t\tp.qm10performanceratevalue > 1,\r\n\t\tp.qm10performanceratevalue / 100,\r\n\t\tp.qm10performanceratevalue\r\n\t) AS qm10performanceratevalue,\r\n\tCOALESCE(p.qm11pointsvalue, 0) AS qm11pointsvalue,\r\n\tIFF(\r\n\t\tp.qm11performanceratevalue > 1,\r\n\t\tp.qm11performanceratevalue / 100,\r\n\t\tp.qm11performanceratevalue\r\n\t) AS qm11performanceratevalue,\r\n\tCOALESCE(p.qmaggregatequalityscorevalue, 0) AS qmaggregatequalityscorevalue,\r\n\t\tp.subscriberid,\r\n\t\tp.all_other_medical,\r\n\t\tp.all_other_medical_count,\r\n\t\tp.amb_surg,\r\n\t\tp.amb_surg_count,\r\n\t\tp.attributed_oncologist,\r\n\t\tp.avoid_ed_ane_allowed,\r\n\t\tp.avoid_ed_ane_count,\r\n\t\tp.avoid_ed_deh_allowed,\r\n\t\tp.avoid_ed_deh_count,\r\n\t\tp.avoid_ed_die_allowed,\r\n\t\tp.avoid_ed_die_count,\r\n\t\tp.avoid_ed_eme_allowed,\r\n\t\tp.avoid_ed_eme_count,\r\n\t\tp.avoid_ed_fev_allowed,\r\n\t\tp.avoid_ed_fev_count,\r\n\t\tp.avoid_ed_nau_allowed,\r\n\t\tp.avoid_ed_nau_count,\r\n\t\tp.avoid_ed_neu_allowed,\r\n\t\tp.avoid_ed_neu_count,\r\n\t\tp.avoid_ed_pai_allowed,\r\n\t\tp.avoid_ed_pai_count,\r\n\t\tp.avoid_ed_pne_allowed,\r\n\t\tp.avoid_ed_pne_count,\r\n\t\tp.avoid_ed_sep_allowed,\r\n\t\tp.avoid_ed_sep_count,\r\n\t\tp.avoid_ip_ane_allowed,\r\n\t\tp.avoid_ip_deh_allowed,\r\n\t\tp.avoid_ip_deh_count,\r\n\t\tp.avoid_ip_die_allowed,\r\n\t\tp.avoid_ip_die_count,\r\n\t\tp.avoid_ip_eme_allowed,\r\n\t\tp.avoid_ip_eme_count,\r\n\t\tp.avoid_ip_fev_allowed,\r\n\t\tp.avoid_ip_fev_count,\r\n\t\tp.avoid_ip_nau_allowed,\r\n\t\tp.avoid_ip_nau_count,\r\n\t\tp.avoid_ip_neu_allowed,\r\n\t\tp.avoid_ip_neu_count,\r\n\t\tp.avoid_ip_pai_allowed,\r\n\t\tp.avoid_ip_pai_count,\r\n\t\tp.avoid_ip_pne_allowed,\r\n\t\tp.avoid_ip_pne_count,\r\n\t\tp.avoid_ip_sep_allowed,\r\n\t\tp.avoid_ip_sep_count,\r\n\t\tp.avoidable_admits_allowed,\r\n\t\tp.avoidable_ed_allowed,\r\n\t\tp.avoidable_ed_count,\r\n\t\tp.birth_date,\r\n\t\tp.ccf_paid,\r\n\t\tp.chemo_allowed,\r\n\t\tp.chemo_count,\r\n\t\tp.chemo_drugs_medical,\r\n\t\tp.chemo_drugs_medical_count,\r\n\t\tp.chemotherapy_type,\r\n\t\tp.dod,\r\n\t\tp.ed_allowed,\r\n\t\tp.ed_visits,\r\n\t\tp.emergencyroomtotalvisits,\r\n\t\tp.eol_chemo_allowed,\r\n\t\tp.eol_chemo_count,\r\n\t\tp.eol_ed_allowed,\r\n\t\tp.eol_ed_visits,\r\n\t\tp.eol_icu_allowed,\r\n\t\tp.eol_icu_count,\r\n\t\tp.episode_end_date,\r\n\t\tp.episode_start_date,\r\n\t\tp.er,\r\n\t\tp.er_count,\r\n\t\tp.gender,\r\n\t\tp.home,\r\n\t\tp.inpatient,\r\n\t\tp.home_count,\r\n\t\tp.hospice_allowed,\r\n\t\tp.hospice_claim_admits,\r\n\t\tp.hospice_los,\r\n\t\tp.icu_allowed,\r\n\t\tp.icu_claim_admits,\r\n\t\tp.icu_los,\r\n\t\tp.inpatient__all_other_inpatient,\r\n\t\tp.inpatient__cardiology,\r\n\t\tp.inpatient__detailed_coded_drugs,\r\n\t\tp.inpatient__emergency_room,\r\n\t\tp.inpatient__icu,\r\n\t\tp.inpatient__imaging,\r\n\t\tp.inpatient__lab_pathology,\r\n\t\tp.inpatient__med_surg_supplies,\r\n\t\tp.inpatient__operation,\r\n\t\tp.inpatient__pharmacy,\r\n\t\tp.inpatient__other,\r\n\t\tp.inpatient__radiation_therapy,\r\n\t\tp.inpatient__respiratory_pt_ot_st,\r\n\t\tp.inpatient__room_and_board,\r\n\t\tp.inpatient_count,\r\n\t\tp.inpatient_count__all_other_inpatient,\r\n\t\tp.inpatient_count__cardiology,\r\n\t\tp.inpatient_count__detailed_coded_drugs,\r\n\t\tp.inpatient_count__emergency_room,\r\n\t\tp.inpatient_count__icu,\r\n\t\tp.inpatient_count__imaging,\r\n\t\tp.inpatient_count__lab_pathology,\r\n\t\tp.inpatient_count__med_surg_supplies,\r\n\t\tp.inpatient_count__operation,\r\n\t\tp.inpatient_count__other,\r\n\t\tp.inpatient_count__pharmacy,\r\n\t\tp.inpatient_count__radiation_therapy,\r\n\t\tp.inpatient_count__respiratory_pt_ot_st,\r\n\t\tp.inpatient_count__room_and_board,\r\n\t\tp.avoidable_admits_count,\r\n\t\tp.inpatient_drugs_requiring_coding,\r\n\t\tp.avoid_ip_ane_count,\r\n\t\tp.ip_allowed,\r\n\t\tp.ip_claim_admits,\r\n\t\tp.ip_clusters,\r\n\t\tp.ip_los,\r\n\t\tp.lab,\r\n\t\tp.lab_count,\r\n\t\tp.min_risk_corridor,\r\n\t\tp.novel_allowed,\r\n\t\tp.office,\r\n\t\tp.office__all_other_office,\r\n\t\tp.office__cardiovascular_procedures,\r\n\t\tp.office__drug_admin,\r\n\t\tp.office__e_and_m,\r\n\t\tp.office__radioactive_agents,\r\n\t\tp.office__other,\r\n\t\tp.office__radiology_mammography,\r\n\t\tp.office__pathology_and_lab,\r\n\t\tp.office__psychiatry,\r\n\t\tp.office__radiation_treatment,\r\n\t\tp.office__radiology_diagnostic,\r\n\t\tp.office__radiology_guidance,\r\n\t\tp.office__radiology_nuclear_medicine,\r\n\t\tp.office__radiology_other,\r\n\t\tp.office__radiology_rad_onc_treatment,\r\n\t\tp.office__surgery,\r\n\t\tp.office__therapeutic_activities,\r\n\t\tp.office_count,\r\n\t\tp.office_count__all_other_office,\r\n\t\tp.office_count__cardiovascular_procedures,\r\n\t\tp.office_count__drug_admin,\r\n\t\tp.office_count__e_and_m,\r\n\t\tp.office_count__other,\r\n\t\tp.office_count__pathology_and_lab,\r\n\t\tp.office_count__psychiatry,\r\n\t\tp.office_count__radiation_treatment,\r\n\t\tp.office_count__radioactive_agents,\r\n\t\tp.office_count__radiology_diagnostic,\r\n\t\tp.office_count__radiology_guidance,\r\n\t\tp.office_count__radiology_mammography,\r\n\t\tp.office_count__radiology_nuclear_medicine,\r\n\t\tp.office_count__radiology_other,\r\n\t\tp.office_count__radiology_rad_onc_treatment,\r\n\t\tp.office_count__surgery,\r\n\t\tp.office_count__therapeutic_activities,\r\n\t\tp.operating_room_services_count,\r\n\t\tp.outpatient,\r\n\t\tp.outpatient__all_other_outpatient,\r\n\t\tp.outpatient__chemo_admin,\r\n\t\tp.outpatient__detailed_coded_drugs,\r\n\t\tp.outpatient__gastrointestinal,\r\n\t\tp.outpatient__imaging,\r\n\t\tp.outpatient__iv_therapy,\r\n\t\tp.outpatient__lab_pathology,\r\n\t\tp.outpatient__med_surg_supplies,\r\n\t\tp.outpatient__nuclear_medicine,\r\n\t\tp.outpatient__operation,\r\n\t\tp.outpatient__other,\r\n\t\tp.outpatient__pharmacy,\r\n\t\tp.outpatient__radiation_therapy,\r\n\t\tp.outpatient_count,\r\n\t\tp.outpatient_count__all_other_outpatient,\r\n\t\tp.outpatient_count__chemo_admin,\r\n\t\tp.outpatient_count__detailed_coded_drugs,\r\n\t\tp.outpatient_count__gastrointestinal,\r\n\t\tp.outpatient_count__imaging,\r\n\t\tp.outpatient_count__iv_therapy,\r\n\t\tp.outpatient_count__lab_pathology,\r\n\t\tp.outpatient_count__med_surg_supplies,\r\n\t\tp.outpatient_count__nuclear_medicine,\r\n\t\tp.outpatient_count__operation,\r\n\t\tp.outpatient_count__other,\r\n\t\tp.outpatient_count__pharmacy,\r\n\t\tp.outpatient_count__radiation_therapy,\r\n\t\tp.practice,\r\n\t\tp.prediction,\r\n\t\tp.retail_pharm,\r\n\t\tp.retail_pharm_count,\r\n\t\tp.ssav_expns_amt_no_cap,\r\n\t\tp.telehealth,\r\n\t\tp.telehealth_count,\r\n\t\tp.total_allowed_wind,\r\n\t\tp.totalallowedamtcostall,\r\n\t\tp.transportation,\r\n\t\tp.transportation_count,\r\n\t\tp.uc,\r\n\t\tp.uc_count\r\nFROM all_recon_sources AS p",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_ic1_recon_source",
    "description": "Reconcillation data from ic1",
    "columns": {
      "memberid": {
        "name": "memberid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "filerunid": {
        "name": "filerunid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractid": {
        "name": "contractid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "lineofbusinessidentifier": {
        "name": "lineofbusinessidentifier",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "administrativetaxidnumber": {
        "name": "administrativetaxidnumber",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "attributedprovidertaxid": {
        "name": "attributedprovidertaxid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "participatingprovidernpinumber": {
        "name": "participatingprovidernpinumber",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractstatecode": {
        "name": "contractstatecode",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "performanceperiodstartdate": {
        "name": "performanceperiodstartdate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "performanceperiodenddate": {
        "name": "performanceperiodenddate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractperiodstartdate": {
        "name": "contractperiodstartdate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractperiodenddate": {
        "name": "contractperiodenddate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "programid": {
        "name": "programid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "providergroupingidentifier": {
        "name": "providergroupingidentifier",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractname": {
        "name": "contractname",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episodecount": {
        "name": "episodecount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "budgetamount": {
        "name": "budgetamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "trenddescription": {
        "name": "trenddescription",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "noveladjustmentdescription": {
        "name": "noveladjustmentdescription",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "benchmarkpriceamount": {
        "name": "benchmarkpriceamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "administrativediscountpercent": {
        "name": "administrativediscountpercent",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "targetpriceamount": {
        "name": "targetpriceamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "totalallowedactualcostamount": {
        "name": "totalallowedactualcostamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episodeactualtotargetdifferenceamount": {
        "name": "episodeactualtotargetdifferenceamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "sharedsavingspercent": {
        "name": "sharedsavingspercent",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "savingspoolamount": {
        "name": "savingspoolamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "sharedsavingsmultipliervalue": {
        "name": "sharedsavingsmultipliervalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "sharedsavingsexpenseamount": {
        "name": "sharedsavingsexpenseamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episodeid": {
        "name": "episodeid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "patientstatename": {
        "name": "patientstatename",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "timeperioddates": {
        "name": "timeperioddates",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episodename": {
        "name": "episodename",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1code": {
        "name": "qm1code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1pointsvalue": {
        "name": "qm1pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1performanceratevalue": {
        "name": "qm1performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1numeratorvalue": {
        "name": "qm1numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1denominatorvalue": {
        "name": "qm1denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2code": {
        "name": "qm2code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2pointsvalue": {
        "name": "qm2pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2performanceratevalue": {
        "name": "qm2performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2numeratorvalue": {
        "name": "qm2numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2denominatorvalue": {
        "name": "qm2denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3code": {
        "name": "qm3code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3pointsvalue": {
        "name": "qm3pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3performanceratevalue": {
        "name": "qm3performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3nominatorvalue": {
        "name": "qm3nominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3denominatorvalue": {
        "name": "qm3denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4code": {
        "name": "qm4code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4pointsvalue": {
        "name": "qm4pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4performanceratevalue": {
        "name": "qm4performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4numeratorvalue": {
        "name": "qm4numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4denominatorvalue": {
        "name": "qm4denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5code - not_null": {
        "name": "qm5code - not_null",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5pointsvalue": {
        "name": "qm5pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5performanceratevalue": {
        "name": "qm5performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5numeratorvalue": {
        "name": "qm5numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5denominatorvalue": {
        "name": "qm5denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6code": {
        "name": "qm6code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6pointsvalue": {
        "name": "qm6pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6performanceratevalue": {
        "name": "qm6performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6numeratorvalue": {
        "name": "qm6numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6denominatorvalue": {
        "name": "qm6denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7code": {
        "name": "qm7code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7pointsvalue": {
        "name": "qm7pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7performanceratevalue": {
        "name": "qm7performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7numeratorvalue": {
        "name": "qm7numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7denominatorvalue": {
        "name": "qm7denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8code": {
        "name": "qm8code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8pointsvalue": {
        "name": "qm8pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8performanceratevalue": {
        "name": "qm8performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8numeratorvalue": {
        "name": "qm8numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8denominatorvalue": {
        "name": "qm8denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9code": {
        "name": "qm9code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9pointsvalue": {
        "name": "qm9pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9performanceratevalue": {
        "name": "qm9performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9numeratorvalue": {
        "name": "qm9numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9denominatorvalue": {
        "name": "qm9denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10code": {
        "name": "qm10code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10pointsvalue": {
        "name": "qm10pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10performanceratevalue": {
        "name": "qm10performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10numeratorvalue": {
        "name": "qm10numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10denominatorvalue": {
        "name": "qm10denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11code": {
        "name": "qm11code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11pointsvalue": {
        "name": "qm11pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11performanceratevalue": {
        "name": "qm11performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11numeratorvalue": {
        "name": "qm11numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11denominatorvalue": {
        "name": "qm11denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qmtotalpointsvalue": {
        "name": "qmtotalpointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qmaggregatequalityscorevalue": {
        "name": "qmaggregatequalityscorevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.MASTEREPISODE",
        "source.anthem_dev.IC1.PAYORICRECON",
        "model.anthem_dev.stg_seed_performance_period",
        "model.anthem_dev.stg_seed_reconpp2_name_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_lineofbussiness",
    "name": "stg_lineofbussiness",
    "original_file_path": "models\\staging\\stg_lineofbussiness.sql",
    "compiled_code": "\n\n\nSELECT\n\tlineofbusiness,\n\tCASE\n\t\tWHEN\n\t\t\tlineofbusiness IN ('Grp_Medicare', 'Medicare', 'MEDICARE')\n\t\t\tTHEN 'Medicare Advantage'\n\t\tWHEN\n\t\t\tlineofbusiness IN ('Commercial', 'COMMERCIAL')\n\t\t\tTHEN 'Commercial'\n\t\tELSE lineofbusiness\n\tEND AS display_lob\nFROM\n\t(\n\t\tSELECT DISTINCT lineofbusinessidentifier AS lineofbusiness\n\t\tFROM dev_dtx_gc.IC1.MASTEREPISODE\n\t\tUNION DISTINCT\n\t\tSELECT DISTINCT INITCAP(lineofbusinessidentifier) AS lineofbusiness,\n\t\tFROM dev_dtx_gc.IC1.ATTRIBUTION\n\t\tUNION DISTINCT\n\t\tSELECT DISTINCT COALESCE(INITCAP(lineofbusinessidentifier), 'NA') AS lineofbusiness\n\t\tFROM dev_dtx_gc.IC1.CCF\n\t\tORDER BY lineofbusiness\n\t) AS unionlist",
    "raw_code": "{{ config( alias = 'stg_lineofbussiness', schema = 'staging', MATERIALIZED = 'TABLE' , transient = false) }}\r\n\r\n\r\nSELECT\r\n\tlineofbusiness,\r\n\tCASE\r\n\t\tWHEN\r\n\t\t\tlineofbusiness IN ('Grp_Medicare', 'Medicare', 'MEDICARE')\r\n\t\t\tTHEN 'Medicare Advantage'\r\n\t\tWHEN\r\n\t\t\tlineofbusiness IN ('Commercial', 'COMMERCIAL')\r\n\t\t\tTHEN 'Commercial'\r\n\t\tELSE lineofbusiness\r\n\tEND AS display_lob\r\nFROM\r\n\t(\r\n\t\tSELECT DISTINCT lineofbusinessidentifier AS lineofbusiness\r\n\t\tFROM {{ source('IC1','MASTEREPISODE') }}\r\n\t\tUNION DISTINCT\r\n\t\tSELECT DISTINCT INITCAP(lineofbusinessidentifier) AS lineofbusiness,\r\n\t\tFROM {{ source('IC1','ATTRIBUTION') }}\r\n\t\tUNION DISTINCT\r\n\t\tSELECT DISTINCT COALESCE(INITCAP(lineofbusinessidentifier), 'NA') AS lineofbusiness\r\n\t\tFROM {{ source('IC1','CCF') }}\r\n\t\tORDER BY lineofbusiness\r\n\t) AS unionlist",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_lineofbussiness",
    "description": "Dimension able for LOB (Line of bussiness)",
    "columns": {
      "lineofbusiness": {
        "name": "lineofbusiness",
        "description": "Feeding from Attribution and CCF",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "Display_LOB": {
        "name": "Display_LOB",
        "description": "LOB Name to be used in UI as per product requirement",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.MASTEREPISODE",
        "source.anthem_dev.IC1.ATTRIBUTION",
        "source.anthem_dev.IC1.CCF"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_medical_facility",
    "name": "stg_medical_facility",
    "original_file_path": "models\\staging\\stg_medical_facility.sql",
    "compiled_code": "\n\nWITH distinctmedfac AS (\n\tSELECT\n\t\tproviderentityname AS attributedproviderorganizationname,\n\t\tattributedproviderstreet1address,\n\t\tattributedproviderstreet2address,\n\t\tattributedprovidercityaddress,\n\t\tattributedproviderstateaddress,\n\t\tLPAD(attributedprovidertaxid, 9, 0) AS attributedprovidertaxid,\n\t\tLPAD(attributedproviderzipcodeaddress, 5, 0)\n\t\t\tAS attributedproviderzipcodeaddress,\n\t\tCONCAT(\n\t\t\tCOALESCE(attributedproviderstreet1address, ''),\n\t\t\tCOALESCE(CONCAT(', ', attributedproviderstreet2address), ''),\n\t\t\tCOALESCE(CONCAT(', ', attributedprovidercityaddress), ''),\n\t\t\tCOALESCE(CONCAT(', ', attributedproviderstateaddress), '')\n\t\t) AS medicalfacilitylocation,\n\t\tROW_NUMBER()\n\t\t\tOVER (\n\t\t\t\tPARTITION BY attributedprovidertaxid\n\t\t\t\tORDER BY fileprocesseddatetime DESC\n\t\t\t)\n\t\t\tAS recentdata\n\tFROM dev_dtx_gc.staging.stg_attribution\n\tWHERE\n\t\tattributedprovidertaxid IS NOT NULL\n\t\tOR LEN(TRIM(attributedprovidertaxid)) > 0\n),\n\nfinal_list AS (\n\tSELECT\n\t\tattributedprovidertaxid AS tin,\n\t\tattributedproviderorganizationname AS medicalfacilityorganizationname,\n\t\tattributedproviderstreet1address AS medicalfacilitystreet1address,\n\t\tattributedproviderstreet2address AS medicalfacilitystreet2address,\n\t\tattributedprovidercityaddress AS medicalfacilitycity,\n\t\tattributedproviderstateaddress AS medicalfacilitystate,\n\t\tattributedproviderzipcodeaddress AS medicalfacilityzipcodeaddress,\n\t\tmedicalfacilitylocation,\n\t\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\n\tFROM distinctmedfac\n\tWHERE recentdata = 1 AND attributedprovidertaxid IS NOT NULL\n\n\tUNION ALL\n\n\tSELECT DISTINCT\n\t\tLPAD(c.attributedprovidertaxid, 9, 0) AS tin,\n\t\tc.providergroupid AS medicalfacilityorganizationname,\n\t\tNULL AS medicalfacilitystreet1address,\n\t\tNULL AS medicalfacilitystreet2address,\n\t\tNULL AS medicalfacilitycity,\n\t\tNULL AS medicalfacilitystate,\n\t\tNULL AS medicalfacilityzipcodeaddress,\n\t\tNULL AS medicalfacilitylocation,\n\t\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\n\tFROM dev_dtx_gc.staging.stg_care_coordination_fee AS c\n\tWHERE\n\t\tNOT EXISTS (\n\t\t\tSELECT 1 FROM distinctmedfac AS a\n\t\t\tWHERE\n\t\t\t\tLPAD(c.attributedprovidertaxid, 9, 0)\n\t\t\t\t= LPAD(a.attributedprovidertaxid, 9, 0)\n\t\t)\n\t\tAND c.attributedprovidertaxid IS NOT NULL\n)\n\nSELECT\n\tfl.*,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3\nFROM final_list AS fl\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON fl.tin = map.tin",
    "raw_code": "{{ config( alias = 'stg_medical_facility', schema = 'staging') }}\r\n\r\nWITH distinctmedfac AS (\r\n\tSELECT\r\n\t\tproviderentityname AS attributedproviderorganizationname,\r\n\t\tattributedproviderstreet1address,\r\n\t\tattributedproviderstreet2address,\r\n\t\tattributedprovidercityaddress,\r\n\t\tattributedproviderstateaddress,\r\n\t\tLPAD(attributedprovidertaxid, 9, 0) AS attributedprovidertaxid,\r\n\t\tLPAD(attributedproviderzipcodeaddress, 5, 0)\r\n\t\t\tAS attributedproviderzipcodeaddress,\r\n\t\tCONCAT(\r\n\t\t\tCOALESCE(attributedproviderstreet1address, ''),\r\n\t\t\tCOALESCE(CONCAT(', ', attributedproviderstreet2address), ''),\r\n\t\t\tCOALESCE(CONCAT(', ', attributedprovidercityaddress), ''),\r\n\t\t\tCOALESCE(CONCAT(', ', attributedproviderstateaddress), '')\r\n\t\t) AS medicalfacilitylocation,\r\n\t\tROW_NUMBER()\r\n\t\t\tOVER (\r\n\t\t\t\tPARTITION BY attributedprovidertaxid\r\n\t\t\t\tORDER BY fileprocesseddatetime DESC\r\n\t\t\t)\r\n\t\t\tAS recentdata\r\n\tFROM {{ ref('stg_attribution') }}\r\n\tWHERE\r\n\t\tattributedprovidertaxid IS NOT NULL\r\n\t\tOR LEN(TRIM(attributedprovidertaxid)) > 0\r\n),\r\n\r\nfinal_list AS (\r\n\tSELECT\r\n\t\tattributedprovidertaxid AS tin,\r\n\t\tattributedproviderorganizationname AS medicalfacilityorganizationname,\r\n\t\tattributedproviderstreet1address AS medicalfacilitystreet1address,\r\n\t\tattributedproviderstreet2address AS medicalfacilitystreet2address,\r\n\t\tattributedprovidercityaddress AS medicalfacilitycity,\r\n\t\tattributedproviderstateaddress AS medicalfacilitystate,\r\n\t\tattributedproviderzipcodeaddress AS medicalfacilityzipcodeaddress,\r\n\t\tmedicalfacilitylocation,\r\n\t\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\n\tFROM distinctmedfac\r\n\tWHERE recentdata = 1 AND attributedprovidertaxid IS NOT NULL\r\n\r\n\tUNION ALL\r\n\r\n\tSELECT DISTINCT\r\n\t\tLPAD(c.attributedprovidertaxid, 9, 0) AS tin,\r\n\t\tc.providergroupid AS medicalfacilityorganizationname,\r\n\t\tNULL AS medicalfacilitystreet1address,\r\n\t\tNULL AS medicalfacilitystreet2address,\r\n\t\tNULL AS medicalfacilitycity,\r\n\t\tNULL AS medicalfacilitystate,\r\n\t\tNULL AS medicalfacilityzipcodeaddress,\r\n\t\tNULL AS medicalfacilitylocation,\r\n\t\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\n\tFROM {{ ref('stg_care_coordination_fee') }} AS c\r\n\tWHERE\r\n\t\tNOT EXISTS (\r\n\t\t\tSELECT 1 FROM distinctmedfac AS a\r\n\t\t\tWHERE\r\n\t\t\t\tLPAD(c.attributedprovidertaxid, 9, 0)\r\n\t\t\t\t= LPAD(a.attributedprovidertaxid, 9, 0)\r\n\t\t)\r\n\t\tAND c.attributedprovidertaxid IS NOT NULL\r\n)\r\n\r\nSELECT\r\n\tfl.*,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3\r\nFROM final_list AS fl\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON fl.tin = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_medical_facility",
    "description": "Provider details",
    "columns": {
      "TIN": {
        "name": "TIN",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_attribution",
        "model.anthem_dev.stg_care_coordination_fee",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_member",
    "name": "stg_member",
    "original_file_path": "models\\staging\\stg_member.sql",
    "compiled_code": "\n\n/*\nAs per IC1 documentation ICsiteId + Member ID should be unique and it should be used for primary key,\nThe data right now has duplicate and added the below code to remove duplicates.\n*/\nWITH members AS (\n\tSELECT DISTINCT\n\t\tm.memberid,\n\t\tm.memberbirthdate,\n\t\tm.memberdeathdate,\n\t\tm.membergendercode,\n\t\tm.memberracecode,\n\t\tm.membermedicaidnumber,\n\t\tm.membermedicarenumber,\n\t\tNULL AS medicalrecordnumber,\n\t\tm.fileprocesseddatetime,\n\t\tm.subscriberid,\n\t\tCOALESCE(m.memberlastname, '')\n\t\t|| ', '\n\t\t|| COALESCE(m.memberfirstname, '') AS membername,\n\t\tCASE\n\t\t\tWHEN\n\t\t\t\tCAST(GETDATE() AS date) >= CAST(m.memberbirthdate AS date)\n\t\t\t\tAND CAST('1900-01-01' AS date)\n\t\t\t\t<= CAST(m.memberbirthdate AS date)\n\t\t\t\tTHEN 1\n\t\t\tELSE 0\n\t\tEND AS valid_dob,\n\t\tROW_NUMBER()\n\t\t\tOVER (\n\t\t\t\tPARTITION BY m.memberid\n\t\t\t\tORDER BY\n\t\t\t\t\tvalid_dob DESC,\n\t\t\t\t\tm.subscriberid ASC,\n\t\t\t\t\tm.memberdeathdate ASC,\n\t\t\t\t\tm.membermedicaidnumber ASC,\n\t\t\t\t\tm.membermedicarenumber ASC,\n\t\t\t\t\tm.membermiddlename ASC,\n\t\t\t\t\tm.memberlastname ASC,\n\t\t\t\t\tm.memberfirstname ASC,\n\t\t\t\t\tm.memberbirthdate ASC,\n\t\t\t\t\tm.membergendercode ASC,\n\t\t\t\t\tm.memberracecode ASC\n\t\t\t)\n\t\t\tAS rn\n\tFROM dev_dtx_gc.IC1.MEMBER AS m\n)\n\nSELECT\n\tm.memberid,\n\tm.membername,\n\tm.memberbirthdate,\n\tm.memberdeathdate,\n\tm.membergendercode,\n\tr.description AS memberrace,\n\tm.membermedicaidnumber,\n\tm.membermedicarenumber,\n\tm.medicalrecordnumber,\n\tm.fileprocesseddatetime,\n\tm.subscriberid,\n\tFLOOR(\n\t\t(\n\t\t\tDATEDIFF(MONTH, m.memberbirthdate, CURRENT_DATE())\n\t\t\t-\n\t\t\tTO_NUMERIC(DATE_PART(DAY, CURRENT_DATE()) < DATE_PART(DAY, m.memberbirthdate))\n\t\t) / 12\n\t) AS memberagecurrent\nFROM members AS m\n\tLEFT JOIN dev_dtx_gc.staging.stg_seed_racevalueset AS r\n\t\tON m.memberracecode = REPLACE(r.code, '-', '')\nWHERE rn = 1\n\nUNION ALL\n\nSELECT DISTINCT\n\te.memberid,\n\tNULL AS membername,\n\te.birth_date AS memberbirthdate,\n\te.dod AS memberdeathdate,\n\te.gender AS membergendercode,\n\te.race AS memberrace,\n\tNULL AS membermedicaidnumber,\n\tNULL AS membermedicarenumber,\n\tNULL AS medicalrecordnumber,\n\t'01/01/1900' AS fileprocesseddatetime,\n\te.subscriberid,\n\tNULL AS memberagecurrent\nFROM dev_dtx_gc.IC1.MASTEREPISODE AS e\nWHERE NOT EXISTS (\n\t\tSELECT 1 FROM dev_dtx_gc.IC1.MEMBER AS m\n\t\tWHERE m.memberid = e.memberid\n\t)\nQUALIFY ROW_NUMBER() OVER (\n\t\tPARTITION BY e.memberid\n\t\tORDER BY e.subscriberid\n\t) = 1\n\nUNION ALL\n\nSELECT DISTINCT\n\tc.memberid,\n\tNULL AS membername,\n\tNULL AS memberbirthdate,\n\tNULL AS memberdeathdate,\n\tNULL AS membergendercode,\n\tNULL AS memberrace,\n\tNULL AS membermedicaidnumber,\n\tNULL AS membermedicarenumber,\n\tNULL AS medicalrecordnumber,\n\t'01/01/1900' AS fileprocesseddatetime,\n\tc.subscriberid,\n\tNULL AS memberagecurrent\nFROM dev_dtx_gc.IC1.CCF AS c\nWHERE NOT EXISTS (\n\t\t SELECT 1 FROM dev_dtx_gc.IC1.MEMBER AS m\n\t\tWHERE m.memberid = c.memberid\n\t\tUNION ALL\n\t\tSELECT 1 FROM dev_dtx_gc.IC1.MASTEREPISODE AS e\n\t\tWHERE e.memberid = c.memberid\n\t)\nQUALIFY ROW_NUMBER() OVER (\n\t\tPARTITION BY c.memberid\n\t\tORDER BY c.subscriberid\n\t) = 1\n\nUNION ALL\n\nSELECT DISTINCT\n\ta.memberid,\n\tNULL AS membername,\n\tNULL AS memberbirthdate,\n\tNULL AS memberdeathdate,\n\tNULL AS membergendercode,\n\tNULL AS memberrace,\n\tNULL AS membermedicaidnumber,\n\tNULL AS membermedicarenumber,\n\tNULL AS medicalrecordnumber,\n\t'01/01/1900' AS fileprocesseddatetime,\n\tNULL AS subscriberid,\n\tNULL AS memberagecurrent\nFROM dev_dtx_gc.IC1.ATTRIBUTION AS a\nWHERE NOT EXISTS (\n\t\t SELECT 1 FROM dev_dtx_gc.IC1.MEMBER AS m\n\t\tWHERE m.memberid = a.memberid\n\t\tUNION ALL\n\t\tSELECT 1 FROM dev_dtx_gc.IC1.MASTEREPISODE AS e\n\t\tWHERE e.memberid = a.memberid\n\t\tUNION ALL\n\t\tSELECT 1 FROM dev_dtx_gc.IC1.CCF AS c\n\t\tWHERE c.memberid = a.memberid\n\t)",
    "raw_code": "{{ config( alias = 'STG_MEMBER', schema = 'staging') }}\r\n\r\n/*\r\nAs per IC1 documentation ICsiteId + Member ID should be unique and it should be used for primary key,\r\nThe data right now has duplicate and added the below code to remove duplicates.\r\n*/\r\nWITH members AS (\r\n\tSELECT DISTINCT\r\n\t\tm.memberid,\r\n\t\tm.memberbirthdate,\r\n\t\tm.memberdeathdate,\r\n\t\tm.membergendercode,\r\n\t\tm.memberracecode,\r\n\t\tm.membermedicaidnumber,\r\n\t\tm.membermedicarenumber,\r\n\t\tNULL AS medicalrecordnumber,\r\n\t\tm.fileprocesseddatetime,\r\n\t\tm.subscriberid,\r\n\t\tCOALESCE(m.memberlastname, '')\r\n\t\t|| ', '\r\n\t\t|| COALESCE(m.memberfirstname, '') AS membername,\r\n\t\tCASE\r\n\t\t\tWHEN\r\n\t\t\t\tCAST(GETDATE() AS date) >= CAST(m.memberbirthdate AS date)\r\n\t\t\t\tAND CAST('1900-01-01' AS date)\r\n\t\t\t\t<= CAST(m.memberbirthdate AS date)\r\n\t\t\t\tTHEN 1\r\n\t\t\tELSE 0\r\n\t\tEND AS valid_dob,\r\n\t\tROW_NUMBER()\r\n\t\t\tOVER (\r\n\t\t\t\tPARTITION BY m.memberid\r\n\t\t\t\tORDER BY\r\n\t\t\t\t\tvalid_dob DESC,\r\n\t\t\t\t\tm.subscriberid ASC,\r\n\t\t\t\t\tm.memberdeathdate ASC,\r\n\t\t\t\t\tm.membermedicaidnumber ASC,\r\n\t\t\t\t\tm.membermedicarenumber ASC,\r\n\t\t\t\t\tm.membermiddlename ASC,\r\n\t\t\t\t\tm.memberlastname ASC,\r\n\t\t\t\t\tm.memberfirstname ASC,\r\n\t\t\t\t\tm.memberbirthdate ASC,\r\n\t\t\t\t\tm.membergendercode ASC,\r\n\t\t\t\t\tm.memberracecode ASC\r\n\t\t\t)\r\n\t\t\tAS rn\r\n\tFROM {{ source('IC1','MEMBER') }} AS m\r\n)\r\n\r\nSELECT\r\n\tm.memberid,\r\n\tm.membername,\r\n\tm.memberbirthdate,\r\n\tm.memberdeathdate,\r\n\tm.membergendercode,\r\n\tr.description AS memberrace,\r\n\tm.membermedicaidnumber,\r\n\tm.membermedicarenumber,\r\n\tm.medicalrecordnumber,\r\n\tm.fileprocesseddatetime,\r\n\tm.subscriberid,\r\n\tFLOOR(\r\n\t\t(\r\n\t\t\tDATEDIFF(MONTH, m.memberbirthdate, CURRENT_DATE())\r\n\t\t\t-\r\n\t\t\tTO_NUMERIC(DATE_PART(DAY, CURRENT_DATE()) < DATE_PART(DAY, m.memberbirthdate))\r\n\t\t) / 12\r\n\t) AS memberagecurrent\r\nFROM members AS m\r\n\tLEFT JOIN {{ ref('stg_seed_racevalueset') }} AS r\r\n\t\tON m.memberracecode = REPLACE(r.code, '-', '')\r\nWHERE rn = 1\r\n\r\nUNION ALL\r\n\r\nSELECT DISTINCT\r\n\te.memberid,\r\n\tNULL AS membername,\r\n\te.birth_date AS memberbirthdate,\r\n\te.dod AS memberdeathdate,\r\n\te.gender AS membergendercode,\r\n\te.race AS memberrace,\r\n\tNULL AS membermedicaidnumber,\r\n\tNULL AS membermedicarenumber,\r\n\tNULL AS medicalrecordnumber,\r\n\t'01/01/1900' AS fileprocesseddatetime,\r\n\te.subscriberid,\r\n\tNULL AS memberagecurrent\r\nFROM {{ source('IC1','MASTEREPISODE') }} AS e\r\nWHERE NOT EXISTS (\r\n\t\tSELECT 1 FROM {{ source('IC1','MEMBER') }} AS m\r\n\t\tWHERE m.memberid = e.memberid\r\n\t)\r\nQUALIFY ROW_NUMBER() OVER (\r\n\t\tPARTITION BY e.memberid\r\n\t\tORDER BY e.subscriberid\r\n\t) = 1\r\n\r\nUNION ALL\r\n\r\nSELECT DISTINCT\r\n\tc.memberid,\r\n\tNULL AS membername,\r\n\tNULL AS memberbirthdate,\r\n\tNULL AS memberdeathdate,\r\n\tNULL AS membergendercode,\r\n\tNULL AS memberrace,\r\n\tNULL AS membermedicaidnumber,\r\n\tNULL AS membermedicarenumber,\r\n\tNULL AS medicalrecordnumber,\r\n\t'01/01/1900' AS fileprocesseddatetime,\r\n\tc.subscriberid,\r\n\tNULL AS memberagecurrent\r\nFROM {{ source('IC1','CCF') }} AS c\r\nWHERE NOT EXISTS (\r\n\t\t SELECT 1 FROM {{ source('IC1','MEMBER') }} AS m\r\n\t\tWHERE m.memberid = c.memberid\r\n\t\tUNION ALL\r\n\t\tSELECT 1 FROM {{ source('IC1','MASTEREPISODE') }} AS e\r\n\t\tWHERE e.memberid = c.memberid\r\n\t)\r\nQUALIFY ROW_NUMBER() OVER (\r\n\t\tPARTITION BY c.memberid\r\n\t\tORDER BY c.subscriberid\r\n\t) = 1\r\n\r\nUNION ALL\r\n\r\nSELECT DISTINCT\r\n\ta.memberid,\r\n\tNULL AS membername,\r\n\tNULL AS memberbirthdate,\r\n\tNULL AS memberdeathdate,\r\n\tNULL AS membergendercode,\r\n\tNULL AS memberrace,\r\n\tNULL AS membermedicaidnumber,\r\n\tNULL AS membermedicarenumber,\r\n\tNULL AS medicalrecordnumber,\r\n\t'01/01/1900' AS fileprocesseddatetime,\r\n\tNULL AS subscriberid,\r\n\tNULL AS memberagecurrent\r\nFROM {{ source('IC1','ATTRIBUTION') }} AS a\r\nWHERE NOT EXISTS (\r\n\t\t SELECT 1 FROM {{ source('IC1','MEMBER') }} AS m\r\n\t\tWHERE m.memberid = a.memberid\r\n\t\tUNION ALL\r\n\t\tSELECT 1 FROM {{ source('IC1','MASTEREPISODE') }} AS e\r\n\t\tWHERE e.memberid = a.memberid\r\n\t\tUNION ALL\r\n\t\tSELECT 1 FROM {{ source('IC1','CCF') }} AS c\r\n\t\tWHERE c.memberid = a.memberid\r\n\t)",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "STG_MEMBER",
    "description": "Member details",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "FILEPROCESSEDDATETIME": {
        "name": "FILEPROCESSEDDATETIME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CCF",
        "source.anthem_dev.IC1.MASTEREPISODE",
        "source.anthem_dev.IC1.MEMBER",
        "source.anthem_dev.IC1.ATTRIBUTION",
        "model.anthem_dev.stg_seed_racevalueset"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_member_admissions",
    "name": "stg_member_admissions",
    "original_file_path": "models\\staging\\stg_member_admissions.sql",
    "compiled_code": "\n\nWITH member_admission AS(\n    SELECT\n        c.memberid,\n        cl.claimid,\n        cl.claimlineid,\n        cl.claimlineservicestartdate AS dateofservice,\n        cl.claimlineserviceenddate AS dateofserviceend,\n        cl.claimlineplaceofservicecode,\n        cl.claimlineprincipaldiagnosiscode,\n        cl.claimlinerevenuecode,\n        cl.claimlinehealthservicecode,\n        c.claimtypeofbillcode,\n        MAX(CASE \n                WHEN cl.claimlinerevenuecode BETWEEN 100 AND 249 THEN 2\n                WHEN cl.claimlineplaceofservicecode IN (22, 23)\n                    AND (\n                        cl.claimlinerevenuecode IN ('0450', '0451', '0452', '0453', '0454', '0455', '0457', '0458', '0459')\n                        OR (cl.claimlinerevenuecode = '0456' AND cl.claimlinehealthservicecode IN ('99281', '99282', '99283', '99284', '99285'))\n                    )\n                    THEN 1\n                    ELSE 0\n                END) OVER(PARTITION BY c.claimid) AS max_admission_code,\n        CASE max_admission_code\n            WHEN 2 THEN 'IP'\n            WHEN 1 THEN 'ED'\n            ELSE NULL\n        END AS admission_type\n    FROM dev_dtx_gc.staging.STG_MEMBER AS m\n    INNER JOIN dev_dtx_gc.IC1.CLAIM AS c\n        ON m.memberid = c.memberid\n    INNER JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n        ON c.claimid = cl.claimid\n    WHERE cl.claimlineplaceofservicecode > 0\n)\n,\ndistinctipadmissions        -- all Distinct IP records\nAS (\n    SELECT DISTINCT\n        ma.memberid,\n        ma.dateofservice\n    FROM member_admission AS ma\n    WHERE ma.admission_type = 'IP'\n)\n,\n-- Splitting individual records into group admissions based on continuous dates \nipadmissiongroup AS (\n    SELECT\n        ipa.memberid,\n        ipa.dateofservice,\n        DATEDIFF(\n            DAY,\n            MIN(ipa.dateofservice) OVER (PARTITION BY ipa.memberid),\n            ipa.dateofservice\n        )\n        - (\n        ROW_NUMBER() OVER (\n            PARTITION BY ipa.memberid\n            ORDER BY ipa.dateofservice ASC\n            ) - 1\n        ) AS admission_group\n    FROM distinctipadmissions AS ipa\n)\nSELECT ma.*,\n    ipa.admission_group,\n    CASE ma.admission_type\n        WHEN 'IP' THEN MIN(ma.dateofservice) OVER(PARTITION BY ma.memberid, ipa.admission_group)\n        WHEN 'ED' THEN MIN(ma.dateofservice) OVER(PARTITION BY ma.memberid, ma.claimid)\n        ELSE ma.dateofservice\n    END AS admission_start_date,\n    CASE WHEN ma.admission_type = 'IP' THEN CONCAT(ma.memberid, ipa.admission_group) ELSE NULL END AS ipdateid,\n    CASE WHEN ma.admission_type = 'ED' THEN CONCAT(ma.memberid, admission_start_date) ELSE NULL END AS eddateid\nFROM member_admission ma\n    LEFT OUTER JOIN ipadmissiongroup AS ipa\n        ON ma.memberid = ipa.memberid AND ma.dateofservice = ipa.dateofservice and ma.admission_type = 'IP'",
    "raw_code": "{{ config( alias = 'stg_member_admissions', schema = 'staging') }}\r\n\r\nWITH member_admission AS(\r\n    SELECT\r\n        c.memberid,\r\n        cl.claimid,\r\n        cl.claimlineid,\r\n        cl.claimlineservicestartdate AS dateofservice,\r\n        cl.claimlineserviceenddate AS dateofserviceend,\r\n        cl.claimlineplaceofservicecode,\r\n        cl.claimlineprincipaldiagnosiscode,\r\n        cl.claimlinerevenuecode,\r\n        cl.claimlinehealthservicecode,\r\n        c.claimtypeofbillcode,\r\n        MAX(CASE \r\n                WHEN cl.claimlinerevenuecode BETWEEN 100 AND 249 THEN 2\r\n                WHEN cl.claimlineplaceofservicecode IN (22, 23)\r\n                    AND (\r\n                        cl.claimlinerevenuecode IN ('0450', '0451', '0452', '0453', '0454', '0455', '0457', '0458', '0459')\r\n                        OR (cl.claimlinerevenuecode = '0456' AND cl.claimlinehealthservicecode IN ('99281', '99282', '99283', '99284', '99285'))\r\n                    )\r\n                    THEN 1\r\n                    ELSE 0\r\n                END) OVER(PARTITION BY c.claimid) AS max_admission_code,\r\n        CASE max_admission_code\r\n            WHEN 2 THEN 'IP'\r\n            WHEN 1 THEN 'ED'\r\n            ELSE NULL\r\n        END AS admission_type\r\n    FROM {{ ref('stg_member') }} AS m\r\n    INNER JOIN {{ source('IC1','CLAIM') }} AS c\r\n        ON m.memberid = c.memberid\r\n    INNER JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n        ON c.claimid = cl.claimid\r\n    WHERE cl.claimlineplaceofservicecode > 0\r\n)\r\n,\r\ndistinctipadmissions        -- all Distinct IP records\r\nAS (\r\n    SELECT DISTINCT\r\n        ma.memberid,\r\n        ma.dateofservice\r\n    FROM member_admission AS ma\r\n    WHERE ma.admission_type = 'IP'\r\n)\r\n,\r\n-- Splitting individual records into group admissions based on continuous dates \r\nipadmissiongroup AS (\r\n    SELECT\r\n        ipa.memberid,\r\n        ipa.dateofservice,\r\n        DATEDIFF(\r\n            DAY,\r\n            MIN(ipa.dateofservice) OVER (PARTITION BY ipa.memberid),\r\n            ipa.dateofservice\r\n        )\r\n        - (\r\n        ROW_NUMBER() OVER (\r\n            PARTITION BY ipa.memberid\r\n            ORDER BY ipa.dateofservice ASC\r\n            ) - 1\r\n        ) AS admission_group\r\n    FROM distinctipadmissions AS ipa\r\n)\r\nSELECT ma.*,\r\n    ipa.admission_group,\r\n    CASE ma.admission_type\r\n        WHEN 'IP' THEN MIN(ma.dateofservice) OVER(PARTITION BY ma.memberid, ipa.admission_group)\r\n        WHEN 'ED' THEN MIN(ma.dateofservice) OVER(PARTITION BY ma.memberid, ma.claimid)\r\n        ELSE ma.dateofservice\r\n    END AS admission_start_date,\r\n    CASE WHEN ma.admission_type = 'IP' THEN CONCAT(ma.memberid, ipa.admission_group) ELSE NULL END AS ipdateid,\r\n    CASE WHEN ma.admission_type = 'ED' THEN CONCAT(ma.memberid, admission_start_date) ELSE NULL END AS eddateid\r\nFROM member_admission ma\r\n    LEFT OUTER JOIN ipadmissiongroup AS ipa\r\n        ON ma.memberid = ipa.memberid AND ma.dateofservice = ipa.dateofservice and ma.admission_type = 'IP'",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_member_admissions",
    "description": "All Medical claim details",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMLINE",
        "model.anthem_dev.stg_member"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_member_chemotherapy",
    "name": "stg_member_chemotherapy",
    "original_file_path": "models\\staging\\stg_member_chemotherapy.sql",
    "compiled_code": "\nWITH diagnosis_chemo AS (\n\t\tSELECT * FROM dev_dtx_gc.staging.stg_seed_chemo_codes AS cc\n\t\tWHERE cc.code_type = 'DIAGNOSIS'\n)\nSELECT\n\tmemberid,\n\tchemodate,\n\tclaimlineplaceofservicecode,\n\tchemocode,\n\tchemodesc,\n\t'Pharmacy' AS category\nFROM (\n\tSELECT DISTINCT\n\t\tc.memberid,\n\t\tc.claimprescriptionfilleddate AS chemodate,\n\t\t0 AS claimlineplaceofservicecode,\n\t\tcc.code AS chemocode,\n\t\tcc.agents AS chemodesc,\n\t\t1 AS prefrence\n\tFROM dev_dtx_gc.IC1.CLAIMPHARMACY AS c\n\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_chemo_codes AS cc\n\t\t\tON c.claimpharmacyndccode = cc.code AND cc.code_type = 'NDC'\n\n\tUNION DISTINCT\n\n\tSELECT DISTINCT\n\t\tc.memberid,\n\t\tc.claimprescriptionfilleddate AS chemodate,\n\t\t0 AS claimlineplaceofservicecode,\n\t\tcc.code AS chemocode,\n\t\tcc.agents AS chemodesc,\n\t\t2 AS prefrence\n\tFROM dev_dtx_gc.IC1.CLAIMPHARMACY AS c\n\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_chemo_codes AS cc\n\t\t\tON cc.code = LEFT(c.claimpharmacygenericproductidentifier, 10) AND cc.code_type = 'GPI10'\n\n)\nQUALIFY ROW_NUMBER() OVER (\n\t\tPARTITION BY memberid, chemodate\n\t\tORDER BY prefrence DESC\n\t) = 1\n\nUNION DISTINCT\n\nSELECT\n\tmemberid,\n\tchemodate,\n\tclaimlineplaceofservicecode,\n\tchemocode,\n\tchemodesc,\n\t'Medical' AS category\nFROM (\n\tSELECT DISTINCT\n\tc.memberid,\n\tcl.claimlineservicestartdate AS chemodate,\n\tcl.claimlineplaceofservicecode,\n\tcc.code AS chemocode,\n\tcc.agents AS chemodesc,\n\t1 AS prefrence\n\tFROM dev_dtx_gc.IC1.CLAIM AS c\n\tINNER JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\tON c.claimid = cl.claimid\n\tINNER JOIN dev_dtx_gc.staging.stg_seed_chemo_codes AS cc\n\t\tON cl.claimlinehealthservicecode = cc.code AND cc.code_type = 'HCPCS'\n\n\tUNION DISTINCT\n\n\tSELECT DISTINCT\n\t\tc.memberid,\n\t\tcl.claimlineservicestartdate AS chemodate,\n\t\tcl.claimlineplaceofservicecode,\n\t\tcc.code AS chemocode,\n\t\tcc.agents AS chemodesc,\n\t\t2 AS prefrence\n\tFROM dev_dtx_gc.IC1.CLAIM AS c\n\t\tINNER JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\t\tON c.claimid = cl.claimid\n\t\tINNER JOIN diagnosis_chemo AS cc\n\t\t\tON cl.claimlineprincipaldiagnosiscode = cc.code\n\n\tUNION DISTINCT\n\n\tSELECT DISTINCT\n\t\tc.memberid,\n\t\tcl.claimlineservicestartdate AS chemodate,\n\t\tcl.claimlineplaceofservicecode,\n\t\tcc.code AS chemocode,\n\t\tcc.agents AS chemodesc,\n\t\t3 AS prefrence\n\tFROM dev_dtx_gc.IC1.CLAIM AS c\n\t\tINNER JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\t\tON c.claimid = cl.claimid\n\t\tINNER JOIN diagnosis_chemo AS cc\n\t\t\tON cl.claimlineadmittingdiagnosiscode = cc.code\n\n\t\tUNION DISTINCT\n\n\tSELECT DISTINCT\n\t\tc.memberid,\n\t\tcl.claimlineservicestartdate AS chemodate,\n\t\tcl.claimlineplaceofservicecode,\n\t\tcc.code AS chemocode,\n\t\tcc.agents AS chemodesc,\n\t\t4 AS prefrence\n\tFROM dev_dtx_gc.IC1.CLAIM AS c\n\t\tINNER JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\t\tON c.claimid = cl.claimid\n\t\tLEFT JOIN dev_dtx_gc.IC1.CLAIMLINEDIAGNOSIS AS cld\n\t\t\tON cl.claimid = cld.claimid\n\t\t\t\tAND cl.claimlineid = cld.claimlineid\n\t\tINNER JOIN diagnosis_chemo AS cc\n\t\t\tON cld.diagnosiscode = cc.code\n)\nQUALIFY ROW_NUMBER() OVER (\n\t\tPARTITION BY memberid, chemodate\n\t\tORDER BY prefrence\n\t) = 1",
    "raw_code": "{{ config( alias = 'stg_member_chemotherapy', schema = 'staging') }}\r\nWITH diagnosis_chemo AS (\r\n\t\tSELECT * FROM {{ ref('stg_seed_chemo_codes') }} AS cc\r\n\t\tWHERE cc.code_type = 'DIAGNOSIS'\r\n)\r\nSELECT\r\n\tmemberid,\r\n\tchemodate,\r\n\tclaimlineplaceofservicecode,\r\n\tchemocode,\r\n\tchemodesc,\r\n\t'Pharmacy' AS category\r\nFROM (\r\n\tSELECT DISTINCT\r\n\t\tc.memberid,\r\n\t\tc.claimprescriptionfilleddate AS chemodate,\r\n\t\t0 AS claimlineplaceofservicecode,\r\n\t\tcc.code AS chemocode,\r\n\t\tcc.agents AS chemodesc,\r\n\t\t1 AS prefrence\r\n\tFROM {{ source('IC1','CLAIMPHARMACY') }} AS c\r\n\t\tINNER JOIN {{ ref('stg_seed_chemo_codes') }} AS cc\r\n\t\t\tON c.claimpharmacyndccode = cc.code AND cc.code_type = 'NDC'\r\n\r\n\tUNION DISTINCT\r\n\r\n\tSELECT DISTINCT\r\n\t\tc.memberid,\r\n\t\tc.claimprescriptionfilleddate AS chemodate,\r\n\t\t0 AS claimlineplaceofservicecode,\r\n\t\tcc.code AS chemocode,\r\n\t\tcc.agents AS chemodesc,\r\n\t\t2 AS prefrence\r\n\tFROM {{ source('IC1','CLAIMPHARMACY') }} AS c\r\n\t\tINNER JOIN {{ ref('stg_seed_chemo_codes') }} AS cc\r\n\t\t\tON cc.code = LEFT(c.claimpharmacygenericproductidentifier, 10) AND cc.code_type = 'GPI10'\r\n\r\n)\r\nQUALIFY ROW_NUMBER() OVER (\r\n\t\tPARTITION BY memberid, chemodate\r\n\t\tORDER BY prefrence DESC\r\n\t) = 1\r\n\r\nUNION DISTINCT\r\n\r\nSELECT\r\n\tmemberid,\r\n\tchemodate,\r\n\tclaimlineplaceofservicecode,\r\n\tchemocode,\r\n\tchemodesc,\r\n\t'Medical' AS category\r\nFROM (\r\n\tSELECT DISTINCT\r\n\tc.memberid,\r\n\tcl.claimlineservicestartdate AS chemodate,\r\n\tcl.claimlineplaceofservicecode,\r\n\tcc.code AS chemocode,\r\n\tcc.agents AS chemodesc,\r\n\t1 AS prefrence\r\n\tFROM {{ source('IC1','CLAIM') }} AS c\r\n\tINNER JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\tON c.claimid = cl.claimid\r\n\tINNER JOIN {{ ref('stg_seed_chemo_codes') }} AS cc\r\n\t\tON cl.claimlinehealthservicecode = cc.code AND cc.code_type = 'HCPCS'\r\n\r\n\tUNION DISTINCT\r\n\r\n\tSELECT DISTINCT\r\n\t\tc.memberid,\r\n\t\tcl.claimlineservicestartdate AS chemodate,\r\n\t\tcl.claimlineplaceofservicecode,\r\n\t\tcc.code AS chemocode,\r\n\t\tcc.agents AS chemodesc,\r\n\t\t2 AS prefrence\r\n\tFROM {{ source('IC1','CLAIM') }} AS c\r\n\t\tINNER JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\t\tON c.claimid = cl.claimid\r\n\t\tINNER JOIN diagnosis_chemo AS cc\r\n\t\t\tON cl.claimlineprincipaldiagnosiscode = cc.code\r\n\r\n\tUNION DISTINCT\r\n\r\n\tSELECT DISTINCT\r\n\t\tc.memberid,\r\n\t\tcl.claimlineservicestartdate AS chemodate,\r\n\t\tcl.claimlineplaceofservicecode,\r\n\t\tcc.code AS chemocode,\r\n\t\tcc.agents AS chemodesc,\r\n\t\t3 AS prefrence\r\n\tFROM {{ source('IC1','CLAIM') }} AS c\r\n\t\tINNER JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\t\tON c.claimid = cl.claimid\r\n\t\tINNER JOIN diagnosis_chemo AS cc\r\n\t\t\tON cl.claimlineadmittingdiagnosiscode = cc.code\r\n\r\n\t\tUNION DISTINCT\r\n\r\n\tSELECT DISTINCT\r\n\t\tc.memberid,\r\n\t\tcl.claimlineservicestartdate AS chemodate,\r\n\t\tcl.claimlineplaceofservicecode,\r\n\t\tcc.code AS chemocode,\r\n\t\tcc.agents AS chemodesc,\r\n\t\t4 AS prefrence\r\n\tFROM {{ source('IC1','CLAIM') }} AS c\r\n\t\tINNER JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\t\tON c.claimid = cl.claimid\r\n\t\tLEFT JOIN {{ source('IC1','CLAIMLINEDIAGNOSIS') }} AS cld\r\n\t\t\tON cl.claimid = cld.claimid\r\n\t\t\t\tAND cl.claimlineid = cld.claimlineid\r\n\t\tINNER JOIN diagnosis_chemo AS cc\r\n\t\t\tON cld.diagnosiscode = cc.code\r\n)\r\nQUALIFY ROW_NUMBER() OVER (\r\n\t\tPARTITION BY memberid, chemodate\r\n\t\tORDER BY prefrence\r\n\t) = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_member_chemotherapy",
    "description": "Member received chemo details",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIMLINEDIAGNOSIS",
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMPHARMACY",
        "source.anthem_dev.IC1.CLAIMLINE",
        "model.anthem_dev.stg_seed_chemo_codes"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_member_hospice_mapping",
    "name": "stg_member_hospice_mapping",
    "original_file_path": "models\\staging\\stg_member_hospice_mapping.sql",
    "compiled_code": "\n\nWITH hospice_members AS (\n\tSELECT DISTINCT\n\t\tmemberid,\n\t\tperf_period_key,\n\t\tlineofbusiness\n\tFROM dev_dtx_gc.staging.stg_hospice_members\n)\n\nSELECT DISTINCT\n\tm.memberid,\n\tpp.perf_period_key,\n\tlob.lineofbusiness,\n\tCASE\n\t\tWHEN h.memberid IS NOT NULL THEN 'Yes'\n\t\tELSE 'No'\n\tEND AS ishospicemember\nFROM dev_dtx_gc.staging.STG_MEMBER AS m\n\tCROSS JOIN dev_dtx_gc.staging.stg_seed_performance_period AS pp\n\tCROSS JOIN dev_dtx_gc.staging.stg_lineofbussiness AS lob\n\tLEFT JOIN\n\t\thospice_members AS h\n\t\tON m.memberid = h.memberid AND pp.perf_period_key = h.perf_period_key AND lob.lineofbusiness = h.lineofbusiness\nWHERE pp.perf_period_name LIKE 'PP%'",
    "raw_code": "{{ config( alias = 'stg_member_hospice_mapping', schema = 'staging') }}\r\n\r\nWITH hospice_members AS (\r\n\tSELECT DISTINCT\r\n\t\tmemberid,\r\n\t\tperf_period_key,\r\n\t\tlineofbusiness\r\n\tFROM {{ ref('stg_hospice_members') }}\r\n)\r\n\r\nSELECT DISTINCT\r\n\tm.memberid,\r\n\tpp.perf_period_key,\r\n\tlob.lineofbusiness,\r\n\tCASE\r\n\t\tWHEN h.memberid IS NOT NULL THEN 'Yes'\r\n\t\tELSE 'No'\r\n\tEND AS ishospicemember\r\nFROM {{ ref('stg_member') }} AS m\r\n\tCROSS JOIN {{ ref('stg_seed_performance_period') }} AS pp\r\n\tCROSS JOIN {{ ref('stg_lineofbussiness') }} AS lob\r\n\tLEFT JOIN\r\n\t\thospice_members AS h\r\n\t\tON m.memberid = h.memberid AND pp.perf_period_key = h.perf_period_key AND lob.lineofbusiness = h.lineofbusiness\r\nWHERE pp.perf_period_name LIKE 'PP%'",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_member_hospice_mapping",
    "description": "Maps each member in each perf period to Hospice admitted or not",
    "columns": {
      "memberid": {
        "name": "memberid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "perf_period_key": {
        "name": "perf_period_key",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "isHospiceMember": {
        "name": "isHospiceMember",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_hospice_members",
        "model.anthem_dev.stg_member",
        "model.anthem_dev.stg_seed_performance_period",
        "model.anthem_dev.stg_lineofbussiness"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_member_quality_measures",
    "name": "stg_member_quality_measures",
    "original_file_path": "models\\staging\\stg_member_quality_measures.sql",
    "compiled_code": "\n\nWITH fact_member_quality_measures AS (\n\t--QM1\n\tSELECT\n\t\tmemberid,\n\t\t1 AS qmid,\n\t\tnumerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\torderingprovidernpi,\n\t\torderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\ttreatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tTO_VARCHAR(chemodates) AS chemodate,\n\t\tNULL AS chemocode,\n\t\tNULL AS consolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tNULL AS hospicedate,\n\t\tdrugsadministered,\n\t\tTO_VARCHAR(chemodates) AS drugsadministereddates,\n\t\tdenominatortriggerdate,\n\t\tnumeratortriggerdate,\n\t\thealth_condition,\n\t\tauthrequestdate,\n\t\tauthidreference,\n\t\tNULL AS daysinhospice,\n\t\tNULL AS ht3_desc,\n\t\tNULL AS cort_desc,\n\t\tNULL AS dop_desc,\n\t\tNULL AS nk1_desc,\n\t\tNULL AS olz_desc,\n\t\tlineofbusiness,\n\t\tclinicalscenariodescription,\n\t\tdosingdeviationtext,\n\t\tbiomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm1\n\n\t--QM2a    \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t10 AS qmid,\n\t\tq.low_risk_numerator AS numerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tchemodate,\n\t\tchemocode,\n\t\tconsolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tNULL AS hospicedate,\n\t\tdrugsadministered,\n\t\tdrugsadministereddates,\n\t\tNULL AS denominatortriggerdate,\n\t\tNULL AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tht3_desc,\n\t\tcort_desc,\n\t\tdop_desc,\n\t\tnk1_desc,\n\t\tolz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm2 AS q\n\tWHERE max_emetic_risk = 1\n\n\t--QM2b     \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t11 AS qmid,\n\t\tq.moderate1_risk_numerator AS numerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tchemodate,\n\t\tchemocode,\n\t\tconsolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tNULL AS hospicedate,\n\t\tdrugsadministered,\n\t\tdrugsadministereddates,\n\t\tNULL AS denominatortriggerdate,\n\t\tNULL AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tht3_desc,\n\t\tcort_desc,\n\t\tdop_desc,\n\t\tnk1_desc,\n\t\tolz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm2 AS q\n\tWHERE max_emetic_risk = 2\n\n\t--QM2c   \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t12 AS qmid,\n\t\tq.moderate2_risk_numerator AS numerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tchemodate,\n\t\tchemocode,\n\t\tconsolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tNULL AS hospicedate,\n\t\tdrugsadministered,\n\t\tdrugsadministereddates,\n\t\tNULL AS denominatortriggerdate,\n\t\tNULL AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tht3_desc,\n\t\tcort_desc,\n\t\tdop_desc,\n\t\tnk1_desc,\n\t\tolz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm2 AS q\n\tWHERE max_emetic_risk = 3\n\n\t--QM2d   \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t13 AS qmid,\n\t\tq.high_risk_numerator AS numerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tchemodate,\n\t\tchemocode,\n\t\tconsolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tNULL AS hospicedate,\n\t\tdrugsadministered,\n\t\tdrugsadministereddates,\n\t\tNULL AS denominatortriggerdate,\n\t\tNULL AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tht3_desc,\n\t\tcort_desc,\n\t\tdop_desc,\n\t\tnk1_desc,\n\t\tolz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm2 AS q\n\tWHERE max_emetic_risk = 4\n\n\t--QM3    \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t3 AS qmid,\n\t\tnumerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\ticd10code,\n\t\ticd10description,\n\t\tclaimlinehealthservicecode,\n\t\tdateofservice AS ipdate,\n\t\tNULL AS eddate,\n\t\tTO_CHAR(chemodate) AS chemodate,\n\t\tchemocode,\n\t\tNULL AS consolidated_emetic_desc,\n\t\tchemodesc,\n\t\tNULL AS hospicedate,\n\t\tNULL AS drugsadministered,\n\t\tNULL AS drugsadministereddates,\n\t\tchemodate AS denominatortriggerdate,\n\t\tCASE WHEN numerator = '1.0' THEN dateofservice END AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tNULL AS ht3_desc,\n\t\tNULL AS cort_desc,\n\t\tNULL AS dop_desc,\n\t\tNULL AS nk1_desc,\n\t\tNULL AS olz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm3_4\n\tWHERE qm_name = 'QM3'\n\n\t--QM4    \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t4 AS qmid,\n\t\tnumerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\ticd10code,\n\t\ticd10description,\n\t\tclaimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tdateofservice AS eddate,\n\t\tTO_CHAR(chemodate) AS chemodate,\n\t\tchemocode,\n\t\tNULL AS consolidated_emetic_desc,\n\t\tchemodesc,\n\t\tNULL AS hospicedate,\n\t\tNULL AS drugsadministered,\n\t\tNULL AS drugsadministereddates,\n\t\tchemodate AS denominatortriggerdate,\n\t\tCASE WHEN numerator = '1.0' THEN dateofservice END AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tNULL AS ht3_desc,\n\t\tNULL AS cort_desc,\n\t\tNULL AS dop_desc,\n\t\tNULL AS nk1_desc,\n\t\tNULL AS olz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm3_4\n\tWHERE qm_name = 'QM4'\n\n\t--QM5    \n\tUNION ALL\n\n\tSELECT\n\t\tmemberid,\n\t\t5 AS qmid,\n\t\tnumerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tTO_CHAR(chemodate) AS chemodate,\n\t\tchemocode,\n\t\tNULL AS consolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tNULL AS hospicedate,\n\t\tNULL AS drugsadministered,\n\t\tNULL AS drugsadministereddates,\n\t\tmemberdeathdate AS denominatortriggerdate,\n\t\tchemodate AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tNULL AS ht3_desc,\n\t\tNULL AS cort_desc,\n\t\tNULL AS dop_desc,\n\t\tNULL AS nk1_desc,\n\t\tNULL AS olz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm5\n\n\t--QM6   \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t6 AS qmid,\n\t\tnumerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tlastedvisitdate AS eddate,\n\t\tNULL AS chemodate,\n\t\tNULL AS chemocode,\n\t\tNULL AS consolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tNULL AS hospicedate,\n\t\tNULL AS drugsadministered,\n\t\tNULL AS drugsadministereddates,\n\t\tmemberdeathdate AS denominatortriggerdate,\n\t\tlastedvisitdate AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tNULL AS ht3_desc,\n\t\tNULL AS cort_desc,\n\t\tNULL AS dop_desc,\n\t\tNULL AS nk1_desc,\n\t\tNULL AS olz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm6\n\n\t--QM7   \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t7 AS qmid,\n\t\tnumerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tNULL AS chemodate,\n\t\tNULL AS chemocode,\n\t\tNULL AS consolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tNULL AS hospicedate,\n\t\tNULL AS drugsadministered,\n\t\tNULL AS drugsadministereddates,\n\t\tmemberdeathdate AS denominatortriggerdate,\n\t\tlasticuvisitdate AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tNULL AS ht3_desc,\n\t\tNULL AS cort_desc,\n\t\tNULL AS dop_desc,\n\t\tNULL AS nk1_desc,\n\t\tNULL AS olz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm7\n\n\t--QM8   \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t8 AS qmid,\n\t\tnumerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tNULL AS chemodate,\n\t\tNULL AS chemocode,\n\t\tNULL AS consolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\thospicedate,\n\t\tNULL AS drugsadministered,\n\t\tNULL AS drugsadministereddates,\n\t\tmemberdeathdate AS denominatortriggerdate,\n\t\thospicedate AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tNULL AS daysinhospice,\n\t\tNULL AS ht3_desc,\n\t\tNULL AS cort_desc,\n\t\tNULL AS dop_desc,\n\t\tNULL AS nk1_desc,\n\t\tNULL AS olz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm8\n\n\t--QM9   \n\tUNION ALL\n\tSELECT\n\t\tmemberid,\n\t\t9 AS qmid,\n\t\tnumerator,\n\t\tdenominator,\n\t\tparticipatingprovidernpi,\n\t\tNULL AS orderingprovidernpi,\n\t\tNULL AS orderingprovider,\n\t\tperf_period_key,\n\t\tcontextdate,\n\t\tepisode_start_date,\n\t\tepisode_end_date,\n\t\ttin,\n\t\tprincipalcancercode,\n\t\tcancerdiagnosisgroupcode,\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\n\t\tNULL AS icd10code,\n\t\tNULL AS icd10description,\n\t\tNULL AS claimlinehealthservicecode,\n\t\tNULL AS ipdate,\n\t\tNULL AS eddate,\n\t\tNULL AS chemodate,\n\t\tNULL AS chemocode,\n\t\tNULL AS consolidated_emetic_desc,\n\t\tNULL AS chemodesc,\n\t\tlastnohospicedate AS hospicedate,\n\t\tNULL AS drugsadministered,\n\t\tNULL AS drugsadministereddates,\n\t\tmemberdeathdate AS denominatortriggerdate,\n\t\tlastnohospicedate AS numeratortriggerdate,\n\t\tNULL AS health_condition,\n\t\tNULL AS authrequestdate,\n\t\tNULL AS authidreference,\n\t\tdaysinhospice,\n\t\tNULL AS ht3_desc,\n\t\tNULL AS cort_desc,\n\t\tNULL AS dop_desc,\n\t\tNULL AS nk1_desc,\n\t\tNULL AS olz_desc,\n\t\tlineofbusiness,\n\t\tNULL AS clinicalscenariodescription,\n\t\tNULL AS dosingdeviationtext,\n\t\tNULL AS biomarkercodedescription\n\tFROM dev_dtx_gc.staging.stg_qm9\n),\n\nstg_member_chemotherapy AS (\n\tSELECT\n\t\tc.memberid,\n\t\tDATE_TRUNC('month', chemodate) AS attributionstartdate,\n\t\tLISTAGG(DISTINCT chemodate, ', ') WITHIN GROUP (\n\t\t\tORDER BY chemodate\n\t\t) AS chemodate,\n\t\tLISTAGG(DISTINCT chemocode, ', ') WITHIN GROUP (\n\t\t\tORDER BY chemocode\n\t\t) AS chemocode\n\tFROM dev_dtx_gc.staging.stg_member_chemotherapy AS c\n\tGROUP BY c.memberid, DATE_TRUNC('month', chemodate)\n)\n\nSELECT\n\tfmq.memberid,\n\tfmq.qmid,\n\tSUM(fmq.numerator) AS numerator,\n\tSUM(fmq.denominator) AS denominator,\n\tfmq.participatingprovidernpi,\n\tfmq.orderingprovidernpi,\n\tfmq.orderingprovider,\n\tfmq.perf_period_key,\n\tfmq.contextdate,\n\tfmq.episode_start_date,\n\tfmq.episode_end_date,\n\tfmq.tin AS attributedprovidertaxid,\n\tfmq.principalcancercode,\n\tfmq.cancerdiagnosisgroupcode,\n\tCONCAT(COALESCE(fmq.participatingprovidernpi, ''), '_', fmq.tin) AS participatingnpi_attributedtin,\n\tCONCAT(fmq.memberid, '_', fmq.tin) AS memberid_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\n\tfmq.treatmentplanpathwayregimenindicatorcode,\n\tfmq.icd10description,\n\tfmq.icd10code,\n\tfmq.claimlinehealthservicecode,\n\tfmq.ipdate,\n\tfmq.eddate,\n\tCASE WHEN fmq.qmid IN (1, 10, 11, 12, 13, 3, 4, 5) THEN fmq.chemodate ELSE smc.chemodate END AS chemodate,\n\tCASE WHEN fmq.qmid IN (1, 10, 11, 12, 13, 3, 4, 5) THEN fmq.chemocode ELSE smc.chemocode END AS chemocode,\n\tfmq.consolidated_emetic_desc,\n\tfmq.chemodesc,\n\tfmq.hospicedate,\n\tfmq.drugsadministered,\n\tfmq.drugsadministereddates,\n\tfmq.denominatortriggerdate,\n\tfmq.numeratortriggerdate,\n\temc.emcodes,\n\tfmq.health_condition,\n\tfmq.authrequestdate,\n\tfmq.authidreference,\n\tfmq.daysinhospice,\n\tfmq.ht3_desc,\n\tfmq.cort_desc,\n\tfmq.dop_desc,\n\tfmq.nk1_desc,\n\tfmq.olz_desc,\n\tfmq.lineofbusiness,\n\tfmq.clinicalscenariodescription,\n\tfmq.dosingdeviationtext,\n\tfmq.biomarkercodedescription,\n\thm.ishospicemember,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3\nFROM fact_member_quality_measures AS fmq\n\tLEFT JOIN dev_dtx_gc.staging.stg_emcodes_per_attributionmonth AS emc\n\t\tON fmq.memberid = emc.memberid AND fmq.contextdate = emc.attributionmonth\n\tLEFT JOIN stg_member_chemotherapy AS smc\n\t\tON fmq.memberid = smc.memberid AND fmq.contextdate = smc.attributionstartdate\n\tLEFT JOIN dev_dtx_gc.staging.stg_member_hospice_mapping AS hm\n\t\tON fmq.memberid = hm.memberid AND fmq.perf_period_key = hm.perf_period_key AND fmq.lineofbusiness = hm.lineofbusiness\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON fmq.tin = map.tin\nGROUP BY\n\tfmq.qmid,\n\tfmq.memberid,\n\tfmq.participatingprovidernpi,\n\tfmq.orderingprovidernpi,\n\tfmq.orderingprovider,\n\tfmq.perf_period_key,\n\tfmq.contextdate,\n\tfmq.episode_start_date,\n\tfmq.episode_end_date,\n\tfmq.tin,\n\tfmq.principalcancercode,\n\tfmq.cancerdiagnosisgroupcode,\n\tfmq.treatmentplanpathwayregimenindicatorcode,\n\tfmq.icd10description,\n\tfmq.icd10code,\n\tfmq.claimlinehealthservicecode,\n\tfmq.ipdate,\n\tfmq.eddate,\n\tCASE WHEN fmq.qmid IN (1, 10, 11, 12, 13, 3, 4, 5) THEN fmq.chemodate ELSE smc.chemodate END,\n\tCASE WHEN fmq.qmid IN (1, 10, 11, 12, 13, 3, 4, 5) THEN fmq.chemocode ELSE smc.chemocode END,\n\tfmq.consolidated_emetic_desc,\n\tfmq.chemodesc,\n\tfmq.hospicedate,\n\tfmq.drugsadministered,\n\tfmq.drugsadministereddates,\n\tfmq.denominatortriggerdate,\n\tfmq.numeratortriggerdate,\n\temc.emcodes,\n\tfmq.health_condition,\n\tfmq.authrequestdate,\n\tfmq.authidreference,\n\tfmq.daysinhospice,\n\tfmq.ht3_desc,\n\tfmq.cort_desc,\n\tfmq.dop_desc,\n\tfmq.nk1_desc,\n\tfmq.olz_desc,\n\tfmq.lineofbusiness,\n\tfmq.clinicalscenariodescription,\n\tfmq.dosingdeviationtext,\n\tfmq.biomarkercodedescription,\n\thm.ishospicemember,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3",
    "raw_code": "{{ config( alias = 'stg_member_quality_measures', schema = 'staging') }}\r\n\r\nWITH fact_member_quality_measures AS (\r\n\t--QM1\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t1 AS qmid,\r\n\t\tnumerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\torderingprovidernpi,\r\n\t\torderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\ttreatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tTO_VARCHAR(chemodates) AS chemodate,\r\n\t\tNULL AS chemocode,\r\n\t\tNULL AS consolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tdrugsadministered,\r\n\t\tTO_VARCHAR(chemodates) AS drugsadministereddates,\r\n\t\tdenominatortriggerdate,\r\n\t\tnumeratortriggerdate,\r\n\t\thealth_condition,\r\n\t\tauthrequestdate,\r\n\t\tauthidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tNULL AS ht3_desc,\r\n\t\tNULL AS cort_desc,\r\n\t\tNULL AS dop_desc,\r\n\t\tNULL AS nk1_desc,\r\n\t\tNULL AS olz_desc,\r\n\t\tlineofbusiness,\r\n\t\tclinicalscenariodescription,\r\n\t\tdosingdeviationtext,\r\n\t\tbiomarkercodedescription\r\n\tFROM {{ ref('stg_qm1') }}\r\n\r\n\t--QM2a    \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t10 AS qmid,\r\n\t\tq.low_risk_numerator AS numerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tchemodate,\r\n\t\tchemocode,\r\n\t\tconsolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tdrugsadministered,\r\n\t\tdrugsadministereddates,\r\n\t\tNULL AS denominatortriggerdate,\r\n\t\tNULL AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tht3_desc,\r\n\t\tcort_desc,\r\n\t\tdop_desc,\r\n\t\tnk1_desc,\r\n\t\tolz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm2') }} AS q\r\n\tWHERE max_emetic_risk = 1\r\n\r\n\t--QM2b     \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t11 AS qmid,\r\n\t\tq.moderate1_risk_numerator AS numerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tchemodate,\r\n\t\tchemocode,\r\n\t\tconsolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tdrugsadministered,\r\n\t\tdrugsadministereddates,\r\n\t\tNULL AS denominatortriggerdate,\r\n\t\tNULL AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tht3_desc,\r\n\t\tcort_desc,\r\n\t\tdop_desc,\r\n\t\tnk1_desc,\r\n\t\tolz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm2') }} AS q\r\n\tWHERE max_emetic_risk = 2\r\n\r\n\t--QM2c   \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t12 AS qmid,\r\n\t\tq.moderate2_risk_numerator AS numerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tchemodate,\r\n\t\tchemocode,\r\n\t\tconsolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tdrugsadministered,\r\n\t\tdrugsadministereddates,\r\n\t\tNULL AS denominatortriggerdate,\r\n\t\tNULL AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tht3_desc,\r\n\t\tcort_desc,\r\n\t\tdop_desc,\r\n\t\tnk1_desc,\r\n\t\tolz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm2') }} AS q\r\n\tWHERE max_emetic_risk = 3\r\n\r\n\t--QM2d   \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t13 AS qmid,\r\n\t\tq.high_risk_numerator AS numerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tchemodate,\r\n\t\tchemocode,\r\n\t\tconsolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tdrugsadministered,\r\n\t\tdrugsadministereddates,\r\n\t\tNULL AS denominatortriggerdate,\r\n\t\tNULL AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tht3_desc,\r\n\t\tcort_desc,\r\n\t\tdop_desc,\r\n\t\tnk1_desc,\r\n\t\tolz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm2') }} AS q\r\n\tWHERE max_emetic_risk = 4\r\n\r\n\t--QM3    \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t3 AS qmid,\r\n\t\tnumerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\ticd10code,\r\n\t\ticd10description,\r\n\t\tclaimlinehealthservicecode,\r\n\t\tdateofservice AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tTO_CHAR(chemodate) AS chemodate,\r\n\t\tchemocode,\r\n\t\tNULL AS consolidated_emetic_desc,\r\n\t\tchemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tNULL AS drugsadministered,\r\n\t\tNULL AS drugsadministereddates,\r\n\t\tchemodate AS denominatortriggerdate,\r\n\t\tCASE WHEN numerator = '1.0' THEN dateofservice END AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tNULL AS ht3_desc,\r\n\t\tNULL AS cort_desc,\r\n\t\tNULL AS dop_desc,\r\n\t\tNULL AS nk1_desc,\r\n\t\tNULL AS olz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm3_4') }}\r\n\tWHERE qm_name = 'QM3'\r\n\r\n\t--QM4    \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t4 AS qmid,\r\n\t\tnumerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\ticd10code,\r\n\t\ticd10description,\r\n\t\tclaimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tdateofservice AS eddate,\r\n\t\tTO_CHAR(chemodate) AS chemodate,\r\n\t\tchemocode,\r\n\t\tNULL AS consolidated_emetic_desc,\r\n\t\tchemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tNULL AS drugsadministered,\r\n\t\tNULL AS drugsadministereddates,\r\n\t\tchemodate AS denominatortriggerdate,\r\n\t\tCASE WHEN numerator = '1.0' THEN dateofservice END AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tNULL AS ht3_desc,\r\n\t\tNULL AS cort_desc,\r\n\t\tNULL AS dop_desc,\r\n\t\tNULL AS nk1_desc,\r\n\t\tNULL AS olz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm3_4') }}\r\n\tWHERE qm_name = 'QM4'\r\n\r\n\t--QM5    \r\n\tUNION ALL\r\n\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t5 AS qmid,\r\n\t\tnumerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tTO_CHAR(chemodate) AS chemodate,\r\n\t\tchemocode,\r\n\t\tNULL AS consolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tNULL AS drugsadministered,\r\n\t\tNULL AS drugsadministereddates,\r\n\t\tmemberdeathdate AS denominatortriggerdate,\r\n\t\tchemodate AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tNULL AS ht3_desc,\r\n\t\tNULL AS cort_desc,\r\n\t\tNULL AS dop_desc,\r\n\t\tNULL AS nk1_desc,\r\n\t\tNULL AS olz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm5') }}\r\n\r\n\t--QM6   \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t6 AS qmid,\r\n\t\tnumerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tlastedvisitdate AS eddate,\r\n\t\tNULL AS chemodate,\r\n\t\tNULL AS chemocode,\r\n\t\tNULL AS consolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tNULL AS drugsadministered,\r\n\t\tNULL AS drugsadministereddates,\r\n\t\tmemberdeathdate AS denominatortriggerdate,\r\n\t\tlastedvisitdate AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tNULL AS ht3_desc,\r\n\t\tNULL AS cort_desc,\r\n\t\tNULL AS dop_desc,\r\n\t\tNULL AS nk1_desc,\r\n\t\tNULL AS olz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm6') }}\r\n\r\n\t--QM7   \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t7 AS qmid,\r\n\t\tnumerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tNULL AS chemodate,\r\n\t\tNULL AS chemocode,\r\n\t\tNULL AS consolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tNULL AS hospicedate,\r\n\t\tNULL AS drugsadministered,\r\n\t\tNULL AS drugsadministereddates,\r\n\t\tmemberdeathdate AS denominatortriggerdate,\r\n\t\tlasticuvisitdate AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tNULL AS ht3_desc,\r\n\t\tNULL AS cort_desc,\r\n\t\tNULL AS dop_desc,\r\n\t\tNULL AS nk1_desc,\r\n\t\tNULL AS olz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm7') }}\r\n\r\n\t--QM8   \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t8 AS qmid,\r\n\t\tnumerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tNULL AS chemodate,\r\n\t\tNULL AS chemocode,\r\n\t\tNULL AS consolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\thospicedate,\r\n\t\tNULL AS drugsadministered,\r\n\t\tNULL AS drugsadministereddates,\r\n\t\tmemberdeathdate AS denominatortriggerdate,\r\n\t\thospicedate AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tNULL AS daysinhospice,\r\n\t\tNULL AS ht3_desc,\r\n\t\tNULL AS cort_desc,\r\n\t\tNULL AS dop_desc,\r\n\t\tNULL AS nk1_desc,\r\n\t\tNULL AS olz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm8') }}\r\n\r\n\t--QM9   \r\n\tUNION ALL\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\t9 AS qmid,\r\n\t\tnumerator,\r\n\t\tdenominator,\r\n\t\tparticipatingprovidernpi,\r\n\t\tNULL AS orderingprovidernpi,\r\n\t\tNULL AS orderingprovider,\r\n\t\tperf_period_key,\r\n\t\tcontextdate,\r\n\t\tepisode_start_date,\r\n\t\tepisode_end_date,\r\n\t\ttin,\r\n\t\tprincipalcancercode,\r\n\t\tcancerdiagnosisgroupcode,\r\n\t\tNULL AS treatmentplanpathwayregimenindicatorcode,\r\n\t\tNULL AS icd10code,\r\n\t\tNULL AS icd10description,\r\n\t\tNULL AS claimlinehealthservicecode,\r\n\t\tNULL AS ipdate,\r\n\t\tNULL AS eddate,\r\n\t\tNULL AS chemodate,\r\n\t\tNULL AS chemocode,\r\n\t\tNULL AS consolidated_emetic_desc,\r\n\t\tNULL AS chemodesc,\r\n\t\tlastnohospicedate AS hospicedate,\r\n\t\tNULL AS drugsadministered,\r\n\t\tNULL AS drugsadministereddates,\r\n\t\tmemberdeathdate AS denominatortriggerdate,\r\n\t\tlastnohospicedate AS numeratortriggerdate,\r\n\t\tNULL AS health_condition,\r\n\t\tNULL AS authrequestdate,\r\n\t\tNULL AS authidreference,\r\n\t\tdaysinhospice,\r\n\t\tNULL AS ht3_desc,\r\n\t\tNULL AS cort_desc,\r\n\t\tNULL AS dop_desc,\r\n\t\tNULL AS nk1_desc,\r\n\t\tNULL AS olz_desc,\r\n\t\tlineofbusiness,\r\n\t\tNULL AS clinicalscenariodescription,\r\n\t\tNULL AS dosingdeviationtext,\r\n\t\tNULL AS biomarkercodedescription\r\n\tFROM {{ ref('stg_qm9') }}\r\n),\r\n\r\nstg_member_chemotherapy AS (\r\n\tSELECT\r\n\t\tc.memberid,\r\n\t\tDATE_TRUNC('month', chemodate) AS attributionstartdate,\r\n\t\tLISTAGG(DISTINCT chemodate, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY chemodate\r\n\t\t) AS chemodate,\r\n\t\tLISTAGG(DISTINCT chemocode, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY chemocode\r\n\t\t) AS chemocode\r\n\tFROM {{ ref('stg_member_chemotherapy') }} AS c\r\n\tGROUP BY c.memberid, DATE_TRUNC('month', chemodate)\r\n)\r\n\r\nSELECT\r\n\tfmq.memberid,\r\n\tfmq.qmid,\r\n\tSUM(fmq.numerator) AS numerator,\r\n\tSUM(fmq.denominator) AS denominator,\r\n\tfmq.participatingprovidernpi,\r\n\tfmq.orderingprovidernpi,\r\n\tfmq.orderingprovider,\r\n\tfmq.perf_period_key,\r\n\tfmq.contextdate,\r\n\tfmq.episode_start_date,\r\n\tfmq.episode_end_date,\r\n\tfmq.tin AS attributedprovidertaxid,\r\n\tfmq.principalcancercode,\r\n\tfmq.cancerdiagnosisgroupcode,\r\n\tCONCAT(COALESCE(fmq.participatingprovidernpi, ''), '_', fmq.tin) AS participatingnpi_attributedtin,\r\n\tCONCAT(fmq.memberid, '_', fmq.tin) AS memberid_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\r\n\tfmq.treatmentplanpathwayregimenindicatorcode,\r\n\tfmq.icd10description,\r\n\tfmq.icd10code,\r\n\tfmq.claimlinehealthservicecode,\r\n\tfmq.ipdate,\r\n\tfmq.eddate,\r\n\tCASE WHEN fmq.qmid IN (1, 10, 11, 12, 13, 3, 4, 5) THEN fmq.chemodate ELSE smc.chemodate END AS chemodate,\r\n\tCASE WHEN fmq.qmid IN (1, 10, 11, 12, 13, 3, 4, 5) THEN fmq.chemocode ELSE smc.chemocode END AS chemocode,\r\n\tfmq.consolidated_emetic_desc,\r\n\tfmq.chemodesc,\r\n\tfmq.hospicedate,\r\n\tfmq.drugsadministered,\r\n\tfmq.drugsadministereddates,\r\n\tfmq.denominatortriggerdate,\r\n\tfmq.numeratortriggerdate,\r\n\temc.emcodes,\r\n\tfmq.health_condition,\r\n\tfmq.authrequestdate,\r\n\tfmq.authidreference,\r\n\tfmq.daysinhospice,\r\n\tfmq.ht3_desc,\r\n\tfmq.cort_desc,\r\n\tfmq.dop_desc,\r\n\tfmq.nk1_desc,\r\n\tfmq.olz_desc,\r\n\tfmq.lineofbusiness,\r\n\tfmq.clinicalscenariodescription,\r\n\tfmq.dosingdeviationtext,\r\n\tfmq.biomarkercodedescription,\r\n\thm.ishospicemember,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3\r\nFROM fact_member_quality_measures AS fmq\r\n\tLEFT JOIN {{ ref('stg_emcodes_per_attributionmonth') }} AS emc\r\n\t\tON fmq.memberid = emc.memberid AND fmq.contextdate = emc.attributionmonth\r\n\tLEFT JOIN stg_member_chemotherapy AS smc\r\n\t\tON fmq.memberid = smc.memberid AND fmq.contextdate = smc.attributionstartdate\r\n\tLEFT JOIN {{ ref('stg_member_hospice_mapping') }} AS hm\r\n\t\tON fmq.memberid = hm.memberid AND fmq.perf_period_key = hm.perf_period_key AND fmq.lineofbusiness = hm.lineofbusiness\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON fmq.tin = map.tin\r\nGROUP BY\r\n\tfmq.qmid,\r\n\tfmq.memberid,\r\n\tfmq.participatingprovidernpi,\r\n\tfmq.orderingprovidernpi,\r\n\tfmq.orderingprovider,\r\n\tfmq.perf_period_key,\r\n\tfmq.contextdate,\r\n\tfmq.episode_start_date,\r\n\tfmq.episode_end_date,\r\n\tfmq.tin,\r\n\tfmq.principalcancercode,\r\n\tfmq.cancerdiagnosisgroupcode,\r\n\tfmq.treatmentplanpathwayregimenindicatorcode,\r\n\tfmq.icd10description,\r\n\tfmq.icd10code,\r\n\tfmq.claimlinehealthservicecode,\r\n\tfmq.ipdate,\r\n\tfmq.eddate,\r\n\tCASE WHEN fmq.qmid IN (1, 10, 11, 12, 13, 3, 4, 5) THEN fmq.chemodate ELSE smc.chemodate END,\r\n\tCASE WHEN fmq.qmid IN (1, 10, 11, 12, 13, 3, 4, 5) THEN fmq.chemocode ELSE smc.chemocode END,\r\n\tfmq.consolidated_emetic_desc,\r\n\tfmq.chemodesc,\r\n\tfmq.hospicedate,\r\n\tfmq.drugsadministered,\r\n\tfmq.drugsadministereddates,\r\n\tfmq.denominatortriggerdate,\r\n\tfmq.numeratortriggerdate,\r\n\temc.emcodes,\r\n\tfmq.health_condition,\r\n\tfmq.authrequestdate,\r\n\tfmq.authidreference,\r\n\tfmq.daysinhospice,\r\n\tfmq.ht3_desc,\r\n\tfmq.cort_desc,\r\n\tfmq.dop_desc,\r\n\tfmq.nk1_desc,\r\n\tfmq.olz_desc,\r\n\tfmq.lineofbusiness,\r\n\tfmq.clinicalscenariodescription,\r\n\tfmq.dosingdeviationtext,\r\n\tfmq.biomarkercodedescription,\r\n\thm.ishospicemember,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_member_quality_measures",
    "description": "Fact Member Quality Measures",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QMID": {
        "name": "QMID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NUMERATOR": {
        "name": "NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CONTEXTDATE": {
        "name": "CONTEXTDATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ISHOSPICEMEMBER": {
        "name": "ISHOSPICEMEMBER",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_qm1",
        "model.anthem_dev.stg_qm2",
        "model.anthem_dev.stg_qm3_4",
        "model.anthem_dev.stg_qm5",
        "model.anthem_dev.stg_qm6",
        "model.anthem_dev.stg_qm7",
        "model.anthem_dev.stg_qm8",
        "model.anthem_dev.stg_qm9",
        "model.anthem_dev.stg_member_chemotherapy",
        "model.anthem_dev.stg_emcodes_per_attributionmonth",
        "model.anthem_dev.stg_member_hospice_mapping",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_member_tin_mapping",
    "name": "stg_member_tin_mapping",
    "original_file_path": "models\\staging\\stg_member_tin_mapping.sql",
    "compiled_code": "\nWITH mbr_tin_uniq AS (\n\tSELECT DISTINCT\n\t\tmemberid,\n\t\tattributedprovidertaxid\n\tFROM dev_dtx_gc.staging.stg_attribution_all\n)\n\nSELECT\n\tm.memberid,\n\tm.membername,\n\tm.memberdeathdate,\n\tm.membergendercode,\n\tm.memberrace,\n\tm.membermedicaidnumber,\n\tm.membermedicarenumber,\n\tm.medicalrecordnumber,\n\tm.fileprocesseddatetime,\n\tm.subscriberid,\n\tm.memberagecurrent,\n\tsa.attributedprovidertaxid AS medicalfacilitytin,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tTO_VARCHAR(m.memberbirthdate, 'MM/DD/YYYY') AS memberbirthdate,\n\tCONCAT(m.memberid, '_', sa.attributedprovidertaxid)\n\t\tAS memberid_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM dev_dtx_gc.staging.STG_MEMBER AS m\n\tINNER JOIN mbr_tin_uniq AS sa\n\t\tON m.memberid = sa.memberid\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON sa.attributedprovidertaxid = map.tin",
    "raw_code": "{{ config( alias = 'stg_member_tin_mapping', schema = 'staging') }}\r\nWITH mbr_tin_uniq AS (\r\n\tSELECT DISTINCT\r\n\t\tmemberid,\r\n\t\tattributedprovidertaxid\r\n\tFROM {{ ref('stg_attribution_all') }}\r\n)\r\n\r\nSELECT\r\n\tm.memberid,\r\n\tm.membername,\r\n\tm.memberdeathdate,\r\n\tm.membergendercode,\r\n\tm.memberrace,\r\n\tm.membermedicaidnumber,\r\n\tm.membermedicarenumber,\r\n\tm.medicalrecordnumber,\r\n\tm.fileprocesseddatetime,\r\n\tm.subscriberid,\r\n\tm.memberagecurrent,\r\n\tsa.attributedprovidertaxid AS medicalfacilitytin,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tTO_VARCHAR(m.memberbirthdate, 'MM/DD/YYYY') AS memberbirthdate,\r\n\tCONCAT(m.memberid, '_', sa.attributedprovidertaxid)\r\n\t\tAS memberid_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM {{ ref('stg_member') }} AS m\r\n\tINNER JOIN mbr_tin_uniq AS sa\r\n\t\tON m.memberid = sa.memberid\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON sa.attributedprovidertaxid = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_member_tin_mapping",
    "description": "Member details",
    "columns": {
      "MemberId_AttributedTIN": {
        "name": "MemberId_AttributedTIN",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_attribution_all",
        "model.anthem_dev.stg_member",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_participating_provider",
    "name": "stg_participating_provider",
    "original_file_path": "models\\staging\\stg_participating_provider.sql",
    "compiled_code": "\n\nWITH distinctprovider AS (\n\tSELECT DISTINCT\n\t\tLPAD(participatingprovidernpi, 10, 0) AS participatingprovidernpi,\n\t\ttin\n\tFROM dev_dtx_gc.staging.stg_episodes\n\tWHERE tin IS NOT NULL\n\n\tUNION ALL\n\n\tSELECT DISTINCT\n\t\tLPAD(sa.attributednpiproviderid, 10, 0) AS participatingprovidernpi,\n\t\tsa.attributedprovidertaxid AS tin\n\tFROM dev_dtx_gc.staging.stg_attribution AS sa\n\tWHERE NOT EXISTS (\n\t\t\tSELECT DISTINCT\n\t\t\t\tse.participatingprovidernpi,\n\t\t\t\tse.tin\n\t\t\tFROM dev_dtx_gc.staging.stg_episodes AS se\n\t\t\tWHERE se.participatingprovidernpi = sa.attributednpiproviderid AND se.tin = sa.attributedprovidertaxid\n\t\t) AND sa.attributedprovidertaxid IS NOT NULL\n)\n\nSELECT\n\tp.participatingprovidernpi AS npi,\n\tsp.provider_name,\n\tsp.provider_city_name,\n\tsp.provider_state_name,\n\tsp.provider_postal_code,\n\tsp.taxonomy_code,\n\tsp.npi_deactivation_date,\n\tsp.provider_specialty,\n\tp.tin AS medicalfacilitytin,\n\tCONCAT(\n\t\tCOALESCE(p.participatingprovidernpi, ''), '_', p.tin\n\t) AS participatingnpi_attributedtin,\n\tNULL AS region,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3\nFROM distinctprovider AS p\n\tLEFT JOIN dev_dtx_gc.staging.stg_provider AS sp\n\t\tON p.participatingprovidernpi = sp.npi\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON p.tin = map.tin",
    "raw_code": "{{ config( alias = 'stg_participating_provider', schema = 'staging') }}\r\n\r\nWITH distinctprovider AS (\r\n\tSELECT DISTINCT\r\n\t\tLPAD(participatingprovidernpi, 10, 0) AS participatingprovidernpi,\r\n\t\ttin\r\n\tFROM {{ ref('stg_episodes') }}\r\n\tWHERE tin IS NOT NULL\r\n\r\n\tUNION ALL\r\n\r\n\tSELECT DISTINCT\r\n\t\tLPAD(sa.attributednpiproviderid, 10, 0) AS participatingprovidernpi,\r\n\t\tsa.attributedprovidertaxid AS tin\r\n\tFROM {{ ref('stg_attribution') }} AS sa\r\n\tWHERE NOT EXISTS (\r\n\t\t\tSELECT DISTINCT\r\n\t\t\t\tse.participatingprovidernpi,\r\n\t\t\t\tse.tin\r\n\t\t\tFROM {{ ref('stg_episodes') }} AS se\r\n\t\t\tWHERE se.participatingprovidernpi = sa.attributednpiproviderid AND se.tin = sa.attributedprovidertaxid\r\n\t\t) AND sa.attributedprovidertaxid IS NOT NULL\r\n)\r\n\r\nSELECT\r\n\tp.participatingprovidernpi AS npi,\r\n\tsp.provider_name,\r\n\tsp.provider_city_name,\r\n\tsp.provider_state_name,\r\n\tsp.provider_postal_code,\r\n\tsp.taxonomy_code,\r\n\tsp.npi_deactivation_date,\r\n\tsp.provider_specialty,\r\n\tp.tin AS medicalfacilitytin,\r\n\tCONCAT(\r\n\t\tCOALESCE(p.participatingprovidernpi, ''), '_', p.tin\r\n\t) AS participatingnpi_attributedtin,\r\n\tNULL AS region,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3\r\nFROM distinctprovider AS p\r\n\tLEFT JOIN {{ ref('stg_provider') }} AS sp\r\n\t\tON p.participatingprovidernpi = sp.npi\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON p.tin = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_participating_provider",
    "description": "Provider details",
    "columns": {
      "ParticipatingNPI_AttributedTIN": {
        "name": "ParticipatingNPI_AttributedTIN",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_episodes",
        "model.anthem_dev.stg_attribution",
        "model.anthem_dev.stg_provider",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_pharmacy_provider",
    "name": "stg_pharmacy_provider",
    "original_file_path": "models\\staging\\stg_pharmacy_provider.sql",
    "compiled_code": "\n\nWITH distinctprovider AS (\n\tSELECT DISTINCT\n\t\tclaimpharmacynationalprovideridentifier,\n\t\tmedicalfacilitytin\n\tFROM dev_dtx_gc.staging.stg_claims\n\tWHERE medicalfacilitytin IS NOT NULL\n)\n\nSELECT\n\tp.claimpharmacynationalprovideridentifier AS npi,\n\tsp.provider_name,\n\tsp.provider_city_name,\n\tsp.provider_state_name,\n\tsp.provider_postal_code,\n\tsp.taxonomy_code,\n\tsp.npi_deactivation_date,\n\tsp.provider_specialty,\n\tp.medicalfacilitytin,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tCONCAT(\n\t\tCOALESCE(p.claimpharmacynationalprovideridentifier, ''),\n\t\t'_',\n\t\tp.medicalfacilitytin\n\t) AS pharmacynpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM distinctprovider AS p\n\tLEFT JOIN dev_dtx_gc.staging.stg_provider AS sp\n\t\tON p.claimpharmacynationalprovideridentifier = sp.npi\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON p.medicalfacilitytin = map.tin",
    "raw_code": "{{ config( alias = 'stg_pharmacy_provider', schema = 'staging') }}\r\n\r\nWITH distinctprovider AS (\r\n\tSELECT DISTINCT\r\n\t\tclaimpharmacynationalprovideridentifier,\r\n\t\tmedicalfacilitytin\r\n\tFROM {{ ref('stg_claims') }}\r\n\tWHERE medicalfacilitytin IS NOT NULL\r\n)\r\n\r\nSELECT\r\n\tp.claimpharmacynationalprovideridentifier AS npi,\r\n\tsp.provider_name,\r\n\tsp.provider_city_name,\r\n\tsp.provider_state_name,\r\n\tsp.provider_postal_code,\r\n\tsp.taxonomy_code,\r\n\tsp.npi_deactivation_date,\r\n\tsp.provider_specialty,\r\n\tp.medicalfacilitytin,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tCONCAT(\r\n\t\tCOALESCE(p.claimpharmacynationalprovideridentifier, ''),\r\n\t\t'_',\r\n\t\tp.medicalfacilitytin\r\n\t) AS pharmacynpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM distinctprovider AS p\r\n\tLEFT JOIN {{ ref('stg_provider') }} AS sp\r\n\t\tON p.claimpharmacynationalprovideridentifier = sp.npi\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON p.medicalfacilitytin = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_pharmacy_provider",
    "description": "Provider details",
    "columns": {
      "PharmacyNPI_AttributedTIN": {
        "name": "PharmacyNPI_AttributedTIN",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_claims",
        "model.anthem_dev.stg_provider",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_prescribing_provider",
    "name": "stg_prescribing_provider",
    "original_file_path": "models\\staging\\stg_prescribing_provider.sql",
    "compiled_code": "\n\nWITH distinctprovider AS (\n\tSELECT DISTINCT\n\t\tclaimprescribingprovidernpinumber,\n\t\tmedicalfacilitytin\n\tFROM dev_dtx_gc.staging.stg_claims\n\tWHERE medicalfacilitytin IS NOT NULL\n)\n\nSELECT\n\tp.claimprescribingprovidernpinumber as npi,\n\tsp.provider_name,\n\tsp.provider_city_name,\n\tsp.provider_state_name,\n\tsp.provider_postal_code,\n\tsp.taxonomy_code,\n\tsp.npi_deactivation_date,\n\tsp.provider_specialty,\n\tp.medicalfacilitytin,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tCONCAT(\n\t\tCOALESCE(p.claimprescribingprovidernpinumber, ''),\n\t\t'_',\n\t\tp.medicalfacilitytin\n\t) AS prescribingnpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM distinctprovider AS p\n\tLEFT JOIN dev_dtx_gc.staging.stg_provider AS sp\n\t\tON p.claimprescribingprovidernpinumber = sp.npi\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON p.medicalfacilitytin = map.tin",
    "raw_code": "{{ config( alias = 'stg_prescribing_provider', schema = 'staging') }}\r\n\r\nWITH distinctprovider AS (\r\n\tSELECT DISTINCT\r\n\t\tclaimprescribingprovidernpinumber,\r\n\t\tmedicalfacilitytin\r\n\tFROM {{ ref('stg_claims') }}\r\n\tWHERE medicalfacilitytin IS NOT NULL\r\n)\r\n\r\nSELECT\r\n\tp.claimprescribingprovidernpinumber as npi,\r\n\tsp.provider_name,\r\n\tsp.provider_city_name,\r\n\tsp.provider_state_name,\r\n\tsp.provider_postal_code,\r\n\tsp.taxonomy_code,\r\n\tsp.npi_deactivation_date,\r\n\tsp.provider_specialty,\r\n\tp.medicalfacilitytin,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tCONCAT(\r\n\t\tCOALESCE(p.claimprescribingprovidernpinumber, ''),\r\n\t\t'_',\r\n\t\tp.medicalfacilitytin\r\n\t) AS prescribingnpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM distinctprovider AS p\r\n\tLEFT JOIN {{ ref('stg_provider') }} AS sp\r\n\t\tON p.claimprescribingprovidernpinumber = sp.npi\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON p.medicalfacilitytin = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_prescribing_provider",
    "description": "Provider details",
    "columns": {
      "PrescribingNPI_AttributedTIN": {
        "name": "PrescribingNPI_AttributedTIN",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_claims",
        "model.anthem_dev.stg_provider",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_provider",
    "name": "stg_provider",
    "original_file_path": "models\\staging\\stg_provider.sql",
    "compiled_code": "\n\nWITH distinctParticipatingProvider as (\n   SELECT DISTINCT memberid,\n   participatingprovidernpi\n   FROM dev_dtx_gc.staging.stg_episodes\n   UNION ALL\n   SELECT DISTINCT sa.memberid,\n   sa.attributednpiproviderid as participatingprovidernpi\n   FROM dev_dtx_gc.staging.stg_attribution sa \n   WHERE NOT EXISTS (\n      SELECT DISTINCT se.memberid, se.participatingprovidernpi \n      FROM dev_dtx_gc.staging.stg_episodes se \n      WHERE se.memberid = sa.memberid AND se.participatingprovidernpi = sa.attributednpiproviderid\n      )\n)\n, qualified_providers as (\n    SELECT DISTINCT\n    c.claimbillingprovidernpinumber,\n    c.claimrenderingprovidernpinumber,\n    p.claimpharmacynationalprovideridentifier,\n    p.claimprescribingprovidernpinumber,\n    e.participatingprovidernpi\n    FROM distinctParticipatingProvider e\n    LEFT JOIN dev_dtx_gc.IC1.CLAIM c \n    ON e.memberid = c.memberid\n    LEFT JOIN dev_dtx_gc.IC1.CLAIMPHARMACY p\n    ON e.memberid = p.memberid    \n),\n\nnpilist AS (\n\tSELECT DISTINCT npi FROM\n\t\t(\n\t\t\tSELECT claimbillingprovidernpinumber AS npi FROM qualified_providers\n\t\t\tUNION ALL\n\t\t\tSELECT claimrenderingprovidernpinumber AS npi FROM qualified_providers\n\t\t\tUNION ALL\n\t\t\tSELECT claimpharmacynationalprovideridentifier AS npi FROM qualified_providers\n\t\t\tUNION ALL\n\t\t\tSELECT claimprescribingprovidernpinumber AS npi FROM qualified_providers\n\t\t\tUNION ALL\n\t\t\tSELECT participatingprovidernpi AS npi FROM qualified_providers\n\t\t\tUNION ALL\n\t\t\tSELECT aimprovidernpinumber FROM dev_dtx_gc.IC1.ANTHEMAIM    -- IC-16752:will pick NPI's missing from attribution and present in AIM data\n\t\t) AS npi\n),\n\ntaxonomy_specialty_mapping AS (\n\tSELECT\n\t\tconcept_name AS provider_specialty,\n\t\tconcept_code\n\tFROM PROD_INTELLIGENCE_DTX.IC_TO_ANTHEM.CONCEPT\n\tWHERE domain_id = 'Provider Specialty'\n\t\tAND concept_class_id = 'NUCC'\n)\n\nSELECT\n\tnl.npi,\n\tUPPER(IFF(\n\t\tnd.entity_type_code = 2, nd.provider_organization_name_legal_business_name,\n\t\tCOALESCE(nd.provider_last_name_legal_name, '') || ', ' || COALESCE(nd.provider_first_name, '')\n\t)) AS provider_name,\n\tnd.provider_business_practice_location_address_city_name AS provider_city_name,\n\tnd.provider_business_practice_location_address_state_name AS provider_state_name,\n\tnd.provider_business_practice_location_address_postal_code AS provider_postal_code,\n\tnd.healthcare_provider_taxonomy_code_1 AS taxonomy_code,\n\tnd.npi_deactivation_date,\n\tts.provider_specialty\nFROM npilist AS nl\n\tLEFT JOIN\n\t\t\n\t\t\tPROD_INTELLIGENCE_DTX.IC_TO_ANTHEM.NPIDATA AS nd\n\t\t\n\t\tON nl.npi = nd.npi\n\tLEFT JOIN taxonomy_specialty_mapping AS ts\n\t\tON ts.concept_code = nd.healthcare_provider_taxonomy_code_1\nWHERE nl.npi IS NOT NULL",
    "raw_code": "{{ config( alias = 'stg_provider', schema = 'staging') }}\r\n\r\nWITH distinctParticipatingProvider as (\r\n   SELECT DISTINCT memberid,\r\n   participatingprovidernpi\r\n   FROM {{ref('stg_episodes')}}\r\n   UNION ALL\r\n   SELECT DISTINCT sa.memberid,\r\n   sa.attributednpiproviderid as participatingprovidernpi\r\n   FROM {{ref('stg_attribution')}} sa \r\n   WHERE NOT EXISTS (\r\n      SELECT DISTINCT se.memberid, se.participatingprovidernpi \r\n      FROM {{ref('stg_episodes')}} se \r\n      WHERE se.memberid = sa.memberid AND se.participatingprovidernpi = sa.attributednpiproviderid\r\n      )\r\n)\r\n, qualified_providers as (\r\n    SELECT DISTINCT\r\n    c.claimbillingprovidernpinumber,\r\n    c.claimrenderingprovidernpinumber,\r\n    p.claimpharmacynationalprovideridentifier,\r\n    p.claimprescribingprovidernpinumber,\r\n    e.participatingprovidernpi\r\n    FROM distinctParticipatingProvider e\r\n    LEFT JOIN {{ source('IC1','CLAIM')}} c \r\n    ON e.memberid = c.memberid\r\n    LEFT JOIN {{ source('IC1','CLAIMPHARMACY')}} p\r\n    ON e.memberid = p.memberid    \r\n),\r\n\r\nnpilist AS (\r\n\tSELECT DISTINCT npi FROM\r\n\t\t(\r\n\t\t\tSELECT claimbillingprovidernpinumber AS npi FROM qualified_providers\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT claimrenderingprovidernpinumber AS npi FROM qualified_providers\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT claimpharmacynationalprovideridentifier AS npi FROM qualified_providers\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT claimprescribingprovidernpinumber AS npi FROM qualified_providers\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT participatingprovidernpi AS npi FROM qualified_providers\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT aimprovidernpinumber FROM {{ source('IC1','ANTHEMAIM') }}    -- IC-16752:will pick NPI's missing from attribution and present in AIM data\r\n\t\t) AS npi\r\n),\r\n\r\ntaxonomy_specialty_mapping AS (\r\n\tSELECT\r\n\t\tconcept_name AS provider_specialty,\r\n\t\tconcept_code\r\n\tFROM {{ source('IC_TO_ANTHEM','CONCEPT') }}\r\n\tWHERE domain_id = 'Provider Specialty'\r\n\t\tAND concept_class_id = 'NUCC'\r\n)\r\n\r\nSELECT\r\n\tnl.npi,\r\n\tUPPER(IFF(\r\n\t\tnd.entity_type_code = 2, nd.provider_organization_name_legal_business_name,\r\n\t\tCOALESCE(nd.provider_last_name_legal_name, '') || ', ' || COALESCE(nd.provider_first_name, '')\r\n\t)) AS provider_name,\r\n\tnd.provider_business_practice_location_address_city_name AS provider_city_name,\r\n\tnd.provider_business_practice_location_address_state_name AS provider_state_name,\r\n\tnd.provider_business_practice_location_address_postal_code AS provider_postal_code,\r\n\tnd.healthcare_provider_taxonomy_code_1 AS taxonomy_code,\r\n\tnd.npi_deactivation_date,\r\n\tts.provider_specialty\r\nFROM npilist AS nl\r\n\tLEFT JOIN\r\n\t\t{% if '_DEMO' in target.database %}\r\n        {{ source('IC1','LKP_NPIDATA') }} nd\r\n        {% else %}\r\n\t\t\t{{ source('IC_TO_ANTHEM','NPIDATA') }} AS nd\r\n\t\t{% endif %}\r\n\t\tON nl.npi = nd.npi\r\n\tLEFT JOIN taxonomy_specialty_mapping AS ts\r\n\t\tON ts.concept_code = nd.healthcare_provider_taxonomy_code_1\r\nWHERE nl.npi IS NOT NULL",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_provider",
    "description": "Provider details",
    "columns": {
      "NPI": {
        "name": "NPI",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMPHARMACY",
        "source.anthem_dev.IC1.ANTHEMAIM",
        "source.anthem_dev.IC_TO_ANTHEM.CONCEPT",
        "source.anthem_dev.IC_TO_ANTHEM.NPIDATA",
        "model.anthem_dev.stg_episodes",
        "model.anthem_dev.stg_attribution"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_qm1",
    "name": "stg_qm1",
    "original_file_path": "models\\staging\\stg_qm1.sql",
    "compiled_code": "\n\n-- Denominator Logic:\n-- 1.       Member attributed (month of attribution)\n\n-- 2.       Member has (Y, N or P) in TREATMENTPLANPATHWAYREGIMENINDICATORCODE column of DEV_DTX.IC1.TreatmentPlan table AND TREATMENTPLANDRUGTYPEDESCRIPTION = 'CHEMO'\n\n-- 3.       Each row meeting this criteria should be counted in the denominator where Memberid + TreatmentPlanPlannedStartDate + TreatmentPlanSourceRegimenCode +TreatmentPlanPathwayRegimenIndicatorCode is a unique concatenated value\n-- Numerator Logic: \n-- 1. Qualifying numerator for pathway adherence\n-- 2.Identify members with qualifying on-pathway regimen utilizing \u201cPathway Regimen Indicator Code\u201d field \n--     a. \u201cY\u201d indicates that the member was treated with an on-pathway regimen\n--     b. \u201cP\u201d indicates that the member was treated with an on-pathway regimen but has missing data elements\n-- 4. Sum the number of regimens in the cohort who are \u201cY\u201d \n-- 5. Sum the number of regimens in the cohort who are \u201cP\u201d and multiply by \u00bd\n-- 6. Sum the number of regimens in the cohort who are \u201cY\u2019 and \u201c \u00bd P\u201d\n\nWITH treatmentplanwithcptcode AS (\n\tSELECT\n\t\ttp.memberid,\n\t\ttp.aimplannedtreatmentbegindate AS treatmentplanplannedstartdate,\n\t\ttp.aimplannedtreatmentenddate AS treatmentplanplannedenddate,\n\t\ttp.aimpathwayregimenindicatorcode AS treatmentplanpathwayregimenindicatorcode,\n\t\ttp.aimregimenname AS treatmentplanregimenname,\n\t\ttp.aimutilizationmanagementhealthconditiondescription AS health_condition,\n\t\ttp.utilizataionmanagementrequestinitiateddate AS authrequestdate,\n\t\ttp.aimreferencenumber AS authidreference,\n\t\ttp.aimprovidernpinumber AS orderingprovidernpi,\n\t\ttp.clinicalscenariodescription,\n\t\tREPLACE(LISTAGG(DISTINCT CHAR(8226) || ' ' || tp.dosingdeviationtext, ','), ',', CHAR(10)) AS dosingdeviationtext,\n\t\tREPLACE(LISTAGG(DISTINCT CHAR(8226) || ' ' || tp.biomarkercodedescription || '-' || COALESCE(tp.biomarkerresulttext, 'Unknown'), ','), ',', CHAR(10)) AS biomarkercodedescription,\n\t\te.perf_period_key\n\tFROM dev_dtx_gc.IC1.ANTHEMAIM AS tp\n\t\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS e\n\t\t\tON tp.memberid = e.memberid\n\t\t\t\tAND tp.aimplannedtreatmentenddate >= e.episode_start_date\n\t\t\t\tAND tp.aimplannedtreatmentbegindate <= e.episode_end_date\n\tWHERE tp.aimdrugtypecode = 'CHEMO'\n\t\tAND tp.aimpathwayregimenindicatorcode IN (\n\t\t\t'Y',\n\t\t\t'N',\n\t\t\t'P'\n\t\t)\n\tGROUP BY\n\t\ttp.memberid,\n\t\ttp.aimplannedtreatmentbegindate,\n\t\ttp.aimplannedtreatmentenddate,\n\t\ttp.aimpathwayregimenindicatorcode,\n\t\ttp.aimregimenname,\n\t\ttp.aimutilizationmanagementhealthconditiondescription,\n\t\ttp.utilizataionmanagementrequestinitiateddate,\n\t\ttp.aimreferencenumber,\n\t\ttp.aimprovidernpinumber,\n\t\ttp.clinicalscenariodescription,\n\t\te.perf_period_key\n),\n\nmonths AS (\n\tSELECT DISTINCT DATE_TRUNC(MONTH, date) AS month FROM dev_dtx_gc.staging.stg_dates\n),\n\noneepisodepermonth AS (\n\tSELECT DISTINCT\n\t\ttp.memberid,\n\t\t1 AS denominator,\n\t\tCASE tp.treatmentplanpathwayregimenindicatorcode\n\t\t\tWHEN 'Y'\n\t\t\t\tTHEN 1\n\t\t\tWHEN 'P'\n\t\t\t\tTHEN 0.5\n\t\t\tWHEN 'N'\n\t\t\t\tTHEN 0\n\t\tEND AS numerator,\n\t\te.episode_start_date,\n\t\te.episode_end_date,\n\t\tm.month AS contextdate,\n\t\ttp.orderingprovidernpi,\n\t\tsp.provider_name AS orderingprovider,\n\t\te.participatingprovidernpi,\n\t\te.perf_period_key,\n\t\te.cancerdiagnosisgroupcode,\n\t\te.principalcancercode,\n\t\te.tin,\n\t\te.lineofbusiness,\n\t\ttp.treatmentplanpathwayregimenindicatorcode,\n\t\ttp.treatmentplanplannedenddate AS denominatortriggerdate,\n\t\ttp.treatmentplanplannedstartdate AS numeratortriggerdate,\n\t\ttp.treatmentplanplannedstartdate AS chemodates,\n\t\ttp.treatmentplanregimenname AS drugsadministered,\n\t\ttp.health_condition,\n\t\ttp.authrequestdate,\n\t\ttp.authidreference,\n\t\ttp.clinicalscenariodescription,\n\t\ttp.dosingdeviationtext,\n\t\ttp.biomarkercodedescription\n\tFROM treatmentplanwithcptcode AS tp\n\t\tINNER JOIN\n\t\t\tdev_dtx_gc.staging.stg_episodes\n\t\t\t\tAS e\n\t\t\tON tp.memberid = e.memberid\n\t\t\t\tAND tp.perf_period_key = e.perf_period_key\n\t\tINNER JOIN months AS m\n\t\t\tON m.month BETWEEN DATE_TRUNC(MONTH, e.episode_start_date)\n\t\t\t\tAND DATE_TRUNC(MONTH, e.episode_end_date)\n\t\tLEFT OUTER JOIN dev_dtx_gc.staging.stg_provider AS sp\n\t\t\tON tp.orderingprovidernpi = sp.npi\n)\n\nSELECT * FROM oneepisodepermonth",
    "raw_code": "{{ config( alias = 'stg_qm1', schema = 'staging') }}\r\n\r\n-- Denominator Logic:\r\n-- 1.       Member attributed (month of attribution)\r\n\r\n-- 2.       Member has (Y, N or P) in TREATMENTPLANPATHWAYREGIMENINDICATORCODE column of DEV_DTX.IC1.TreatmentPlan table AND TREATMENTPLANDRUGTYPEDESCRIPTION = 'CHEMO'\r\n\r\n-- 3.       Each row meeting this criteria should be counted in the denominator where Memberid + TreatmentPlanPlannedStartDate + TreatmentPlanSourceRegimenCode +TreatmentPlanPathwayRegimenIndicatorCode is a unique concatenated value\r\n-- Numerator Logic: \r\n-- 1. Qualifying numerator for pathway adherence\r\n-- 2.Identify members with qualifying on-pathway regimen utilizing \u201cPathway Regimen Indicator Code\u201d field \r\n--     a. \u201cY\u201d indicates that the member was treated with an on-pathway regimen\r\n--     b. \u201cP\u201d indicates that the member was treated with an on-pathway regimen but has missing data elements\r\n-- 4. Sum the number of regimens in the cohort who are \u201cY\u201d \r\n-- 5. Sum the number of regimens in the cohort who are \u201cP\u201d and multiply by \u00bd\r\n-- 6. Sum the number of regimens in the cohort who are \u201cY\u2019 and \u201c \u00bd P\u201d\r\n\r\nWITH treatmentplanwithcptcode AS (\r\n\tSELECT\r\n\t\ttp.memberid,\r\n\t\ttp.aimplannedtreatmentbegindate AS treatmentplanplannedstartdate,\r\n\t\ttp.aimplannedtreatmentenddate AS treatmentplanplannedenddate,\r\n\t\ttp.aimpathwayregimenindicatorcode AS treatmentplanpathwayregimenindicatorcode,\r\n\t\ttp.aimregimenname AS treatmentplanregimenname,\r\n\t\ttp.aimutilizationmanagementhealthconditiondescription AS health_condition,\r\n\t\ttp.utilizataionmanagementrequestinitiateddate AS authrequestdate,\r\n\t\ttp.aimreferencenumber AS authidreference,\r\n\t\ttp.aimprovidernpinumber AS orderingprovidernpi,\r\n\t\ttp.clinicalscenariodescription,\r\n\t\tREPLACE(LISTAGG(DISTINCT CHAR(8226) || ' ' || tp.dosingdeviationtext, ','), ',', CHAR(10)) AS dosingdeviationtext,\r\n\t\tREPLACE(LISTAGG(DISTINCT CHAR(8226) || ' ' || tp.biomarkercodedescription || '-' || COALESCE(tp.biomarkerresulttext, 'Unknown'), ','), ',', CHAR(10)) AS biomarkercodedescription,\r\n\t\te.perf_period_key\r\n\tFROM {{ source('IC1','ANTHEMAIM') }} AS tp\r\n\t\tINNER JOIN {{ ref('stg_episodes') }} AS e\r\n\t\t\tON tp.memberid = e.memberid\r\n\t\t\t\tAND tp.aimplannedtreatmentenddate >= e.episode_start_date\r\n\t\t\t\tAND tp.aimplannedtreatmentbegindate <= e.episode_end_date\r\n\tWHERE tp.aimdrugtypecode = 'CHEMO'\r\n\t\tAND tp.aimpathwayregimenindicatorcode IN (\r\n\t\t\t'Y',\r\n\t\t\t'N',\r\n\t\t\t'P'\r\n\t\t)\r\n\tGROUP BY\r\n\t\ttp.memberid,\r\n\t\ttp.aimplannedtreatmentbegindate,\r\n\t\ttp.aimplannedtreatmentenddate,\r\n\t\ttp.aimpathwayregimenindicatorcode,\r\n\t\ttp.aimregimenname,\r\n\t\ttp.aimutilizationmanagementhealthconditiondescription,\r\n\t\ttp.utilizataionmanagementrequestinitiateddate,\r\n\t\ttp.aimreferencenumber,\r\n\t\ttp.aimprovidernpinumber,\r\n\t\ttp.clinicalscenariodescription,\r\n\t\te.perf_period_key\r\n),\r\n\r\nmonths AS (\r\n\tSELECT DISTINCT DATE_TRUNC(MONTH, date) AS month FROM {{ ref('stg_dates') }}\r\n),\r\n\r\noneepisodepermonth AS (\r\n\tSELECT DISTINCT\r\n\t\ttp.memberid,\r\n\t\t1 AS denominator,\r\n\t\tCASE tp.treatmentplanpathwayregimenindicatorcode\r\n\t\t\tWHEN 'Y'\r\n\t\t\t\tTHEN 1\r\n\t\t\tWHEN 'P'\r\n\t\t\t\tTHEN 0.5\r\n\t\t\tWHEN 'N'\r\n\t\t\t\tTHEN 0\r\n\t\tEND AS numerator,\r\n\t\te.episode_start_date,\r\n\t\te.episode_end_date,\r\n\t\tm.month AS contextdate,\r\n\t\ttp.orderingprovidernpi,\r\n\t\tsp.provider_name AS orderingprovider,\r\n\t\te.participatingprovidernpi,\r\n\t\te.perf_period_key,\r\n\t\te.cancerdiagnosisgroupcode,\r\n\t\te.principalcancercode,\r\n\t\te.tin,\r\n\t\te.lineofbusiness,\r\n\t\ttp.treatmentplanpathwayregimenindicatorcode,\r\n\t\ttp.treatmentplanplannedenddate AS denominatortriggerdate,\r\n\t\ttp.treatmentplanplannedstartdate AS numeratortriggerdate,\r\n\t\ttp.treatmentplanplannedstartdate AS chemodates,\r\n\t\ttp.treatmentplanregimenname AS drugsadministered,\r\n\t\ttp.health_condition,\r\n\t\ttp.authrequestdate,\r\n\t\ttp.authidreference,\r\n\t\ttp.clinicalscenariodescription,\r\n\t\ttp.dosingdeviationtext,\r\n\t\ttp.biomarkercodedescription\r\n\tFROM treatmentplanwithcptcode AS tp\r\n\t\tINNER JOIN\r\n\t\t\t{{ ref('stg_episodes') }}\r\n\t\t\t\tAS e\r\n\t\t\tON tp.memberid = e.memberid\r\n\t\t\t\tAND tp.perf_period_key = e.perf_period_key\r\n\t\tINNER JOIN months AS m\r\n\t\t\tON m.month BETWEEN DATE_TRUNC(MONTH, e.episode_start_date)\r\n\t\t\t\tAND DATE_TRUNC(MONTH, e.episode_end_date)\r\n\t\tLEFT OUTER JOIN {{ ref('stg_provider') }} AS sp\r\n\t\t\tON tp.orderingprovidernpi = sp.npi\r\n)\r\n\r\nSELECT * FROM oneepisodepermonth",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_qm1",
    "description": "QM1 Informations",
    "columns": {
      "MEMBERID": {
        "name": "MEMBERID",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CONTEXTDATE": {
        "name": "CONTEXTDATE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NUMERATOR": {
        "name": "NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TIN": {
        "name": "TIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.ANTHEMAIM",
        "model.anthem_dev.stg_episodes",
        "model.anthem_dev.stg_dates",
        "model.anthem_dev.stg_provider"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_qm2",
    "name": "stg_qm2",
    "original_file_path": "models\\staging\\stg_qm2.sql",
    "compiled_code": "\n\nWITH calendar_months AS (\n\tSELECT DISTINCT DATE_TRUNC(MONTH, date) AS month_first_date\n\tFROM dev_dtx_gc.staging.stg_dates\n),\n\nqm2_raw_emetics_details AS (       --- IC-16505: Getting Highest Emetic risk available for each patient\n\tSELECT * FROM (\n\t\tSELECT\n\t\t\tc.memberid,\n\t\t\tep.perf_period_key,\n\t\t\te.code AS emetic_code,\n\t\t\tCONCAT_WS(' - ', e.code, e.agents) AS emetic_desc,\n\t\t\tcl.claimlineservicestartdate AS emetic_date,\n\t\t\te.emetic_risk,\n\t\t\tCASE WHEN emetic_risk = 'HIGH' THEN 4\n\t\t\t\tWHEN emetic_risk = 'MODERATE 2' THEN 3\n\t\t\t\tWHEN emetic_risk = 'MODERATE 1' THEN 2\n\t\t\t\tELSE 1\n\t\t\tEND AS emetic_risk_number\n\t\tFROM dev_dtx_gc.IC1.CLAIM AS c\n\t\t\tINNER JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\t\t\tON c.claimid = cl.claimid\n\t\t\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS ep\n\t\t\t\tON c.memberid = ep.memberid\n\t\t\t\t\tAND cl.claimlineservicestartdate >= ep.episode_start_date\n\t\t\t\t\tAND cl.claimlineservicestartdate <= ep.episode_end_date\n\t\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_chemo_w_emeticrisk_codes AS e\n\t\t\t\tON cl.claimlinehealthservicecode = e.code AND e.code_type = 'HCPCS'\n\t\tUNION ALL\n\t\tSELECT\n\t\t\tcp.memberid,\n\t\t\tep.perf_period_key,\n\t\t\te.code AS emetic_code,\n\t\t\tCONCAT_WS(' - ', e.code, e.agents) AS emetic_desc,\n\t\t\tcp.claimprescriptionfilleddate AS emetic_date,\n\t\t\te.emetic_risk,\n\t\t\tCASE WHEN emetic_risk = 'HIGH' THEN 4\n\t\t\t\tWHEN emetic_risk = 'MODERATE 2' THEN 3\n\t\t\t\tWHEN emetic_risk = 'MODERATE 1' THEN 2\n\t\t\t\tELSE 1\n\t\t\tEND AS emetic_risk_number\n\t\tFROM dev_dtx_gc.IC1.CLAIMPHARMACY AS cp\n\t\t\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS ep\n\t\t\t\tON cp.memberid = ep.memberid\n\t\t\t\t\tAND cp.claimprescriptionfilleddate >= ep.episode_start_date\n\t\t\t\t\tAND cp.claimprescriptionfilleddate <= ep.episode_end_date\n\t\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_chemo_w_emeticrisk_codes AS e\n\t\t\t\tON e.code = LEFT(cp.claimpharmacygenericproductidentifier, 10) AND e.code_type = 'GPI10'\n\t)\n),\n\nqualified_chemo AS (   --- Getting only one emetic record per patient based on Risk rank\n\tSELECT e.*\n\tFROM qm2_raw_emetics_details AS e\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY e.memberid, e.perf_period_key\n\t\t\tORDER BY e.emetic_risk_number DESC, e.emetic_date ASC\n\t\t) = 1\n),\n\nqualified_emetic_desc AS (   --- Getting all emetic records on Qualified Date to get consolidated Qualified Emetic desc\n\tSELECT\n\t\tqc.memberid,\n\t\tqc.perf_period_key,\n\t\tLISTAGG(DISTINCT re.emetic_desc, ', ') WITHIN GROUP (\n\t\t\tORDER BY re.emetic_desc\n\t\t) AS qualified_emetic_desc\n\tFROM qualified_chemo AS qc\n\t\tLEFT OUTER JOIN qm2_raw_emetics_details AS re\n\t\t\tON qc.memberid = re.memberid AND qc.emetic_date = re.emetic_date AND qc.emetic_desc = re.emetic_desc\n\tGROUP BY qc.memberid, qc.perf_period_key\n),\n\nconsolidated_emetic_desc AS (   --- Getting all emetic records other than Qualified Date to get Consolidated Emetic desc\n\tSELECT\n\t\tqc.memberid,\n\t\tqc.perf_period_key,\n\t\tLISTAGG(DISTINCT re.emetic_desc, ', ') WITHIN GROUP (\n\t\t\tORDER BY re.emetic_desc\n\t\t) AS consolidated_emetic_desc\n\tFROM qm2_raw_emetics_details AS re\n\t\tLEFT OUTER JOIN qualified_chemo AS qc\n\t\t\tON re.memberid = qc.memberid AND re.emetic_date = qc.emetic_date AND re.emetic_desc <> qc.emetic_desc\n\tGROUP BY qc.memberid, qc.perf_period_key\n),\n\nqm2_emetics_details AS (\n\tSELECT\n\t\te.*,\n\t\tqe.qualified_emetic_desc,\n\t\tCOALESCE(ce.consolidated_emetic_desc, 'None') AS consolidated_emetic_desc\n\tFROM qualified_chemo AS e\n\t\tLEFT OUTER JOIN qualified_emetic_desc AS qe\n\t\t\tON e.memberid = qe.memberid AND e.perf_period_key = qe.perf_period_key\n\t\tLEFT OUTER JOIN consolidated_emetic_desc AS ce\n\t\t\tON e.memberid = ce.memberid AND e.perf_period_key = ce.perf_period_key\n),\n\nqm2_eme_antieme_details AS (       --- IC-16505: Getting first Antiemetic per class on or after Highest Emetic risk for each patient\n\tSELECT\n\t\te.memberid,\n\t\te.perf_period_key,\n\t\te.emetic_code,\n\t\te.qualified_emetic_desc AS emetic_desc,\n\t\te.consolidated_emetic_desc,\n\t\te.emetic_date,\n\t\te.emetic_risk,\n\t\te.emetic_risk_number,\n\t\tae.antiemetic_code,\n\t\tae.antiemetic_desc,\n\t\tae.antiemetic_class,\n\t\tae.antiemetic_date,\n\t\tae.ht3_desc,\n\t\tae.cort_desc,\n\t\tae.dop_desc,\n\t\tae.nk1_desc,\n\t\tae.olz_desc\n\tFROM qm2_emetics_details AS e\n\t\tLEFT JOIN\n\t\t\t(\n\t\t\t\tSELECT\n\t\t\t\t\te.memberid,\n\t\t\t\t\ta.code AS antiemetic_code,\n\t\t\t\t\tCONCAT_WS(' - ', a.code, a.generic) AS antiemetic_desc,\n\t\t\t\t\tCASE WHEN a.class = '5-HT3' THEN CONCAT_WS(' - ', a.code, a.generic) END AS ht3_desc,\n\t\t\t\t\tCASE WHEN a.class = 'CORT' THEN CONCAT_WS(' - ', a.code, a.generic) END AS cort_desc,\n\t\t\t\t\tCASE WHEN a.class = 'DOP' THEN CONCAT_WS(' - ', a.code, a.generic) END AS dop_desc,\n\t\t\t\t\tCASE WHEN a.class = 'NK1' THEN CONCAT_WS(' - ', a.code, a.generic) END AS nk1_desc,\n\t\t\t\t\tCASE WHEN a.class = 'OLZ' THEN CONCAT_WS(' - ', a.code, a.generic) END AS olz_desc,\n\t\t\t\t\tcl.claimlineservicestartdate AS antiemetic_date,\n\t\t\t\t\ta.class AS antiemetic_class,\n\t\t\t\t\tep.perf_period_key\n\t\t\t\tFROM qm2_emetics_details AS e\n\t\t\t\t\tINNER JOIN dev_dtx_gc.IC1.CLAIM AS c\n\t\t\t\t\t\tON e.memberid = c.memberid\n\t\t\t\t\tINNER JOIN dev_dtx_gc.IC1.CLAIMLINE AS cl\n\t\t\t\t\t\tON c.claimid = cl.claimid\n\t\t\t\t\t\t\tAND e.emetic_date <= cl.claimlineservicestartdate\n\t\t\t\t\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS ep\n\t\t\t\t\t\tON c.memberid = ep.memberid\n\t\t\t\t\t\t\tAND cl.claimlineservicestartdate >= ep.episode_start_date\n\t\t\t\t\t\t\tAND cl.claimlineservicestartdate <= ep.episode_end_date\n\t\t\t\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_antiemetics AS a\n\t\t\t\t\t\tON cl.claimlinehealthservicecode = a.code\n\t\t\t\t\t\t\tAND a.code_type = 'HCPCS'\n\t\t\t\tUNION ALL\n\t\t\t\tSELECT\n\t\t\t\t\te.memberid,\n\t\t\t\t\ta.code AS antiemetic_code,\n\t\t\t\t\tCONCAT_WS(' - ', a.code, a.generic) AS antiemetic_desc,\n\t\t\t\t\tCASE WHEN a.class = '5-HT3' THEN CONCAT_WS(' - ', a.code, a.generic) END AS ht3_desc,\n\t\t\t\t\tCASE WHEN a.class = 'CORT' THEN CONCAT_WS(' - ', a.code, a.generic) END AS cort_desc,\n\t\t\t\t\tCASE WHEN a.class = 'DOP' THEN CONCAT_WS(' - ', a.code, a.generic) END AS dop_desc,\n\t\t\t\t\tCASE WHEN a.class = 'NK1' THEN CONCAT_WS(' - ', a.code, a.generic) END AS nk1_desc,\n\t\t\t\t\tCASE WHEN a.class = 'OLZ' THEN CONCAT_WS(' - ', a.code, a.generic) END AS olz_desc,\n\t\t\t\t\tcp.claimprescriptionfilleddate AS antiemetic_date,\n\t\t\t\t\ta.class AS antiemetic_class,\n\t\t\t\t\tep.perf_period_key\n\t\t\t\tFROM qm2_emetics_details AS e\n\t\t\t\t\tINNER JOIN dev_dtx_gc.IC1.CLAIMPHARMACY AS cp\n\t\t\t\t\t\tON e.memberid = cp.memberid\n\t\t\t\t\t\t\tAND e.emetic_date <= cp.claimprescriptionfilleddate\n\t\t\t\t\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS ep\n\t\t\t\t\t\tON ep.memberid = cp.memberid\n\t\t\t\t\t\t\tAND ep.episode_start_date <= cp.claimprescriptionfilleddate\n\t\t\t\t\t\t\tAND ep.episode_end_date >= cp.claimprescriptionfilleddate\n\t\t\t\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_antiemetics AS a\n\t\t\t\t\t\tON a.code = LEFT(cp.claimpharmacygenericproductidentifier, 8)\n\t\t\t\t\t\t\tAND a.code_type = 'GPI_8_DIGITS'\n\t\t\t) AS ae\n\t\t\tON e.memberid = ae.memberid\n\t\t\t\tAND e.perf_period_key = ae.perf_period_key\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY e.memberid, e.perf_period_key, ae.antiemetic_class\n\t\t\tORDER BY ae.antiemetic_date ASC\n\t\t) = 1\n),\n\nsummarized_emetic_claims AS (          --- IC-16505: Summerizing Emetic and AntiEmetic records on patient level\n\tSELECT\n\t\tmemberid,\n\t\tperf_period_key,\n\t\tLISTAGG(DISTINCT emetic_desc, ', ') WITHIN GROUP (\n\t\t\tORDER BY emetic_desc\n\t\t) AS chemocode,  -- IC-16356 Emetics as chemocodes  and AntiEmetics as Drugs\n\t\tLISTAGG(DISTINCT consolidated_emetic_desc, ', ') WITHIN GROUP (\n\t\t\tORDER BY consolidated_emetic_desc\n\t\t) AS consolidated_emetic_desc,\n\t\tLISTAGG(DISTINCT emetic_date, ', ') WITHIN GROUP (\n\t\t\tORDER BY emetic_date\n\t\t) AS chemodate,\n\t\tLISTAGG(DISTINCT antiemetic_desc, ', ') WITHIN GROUP (\n\t\t\tORDER BY antiemetic_desc\n\t\t) AS drugsadministered,\n\t\tLISTAGG(DISTINCT antiemetic_date, ', ') WITHIN GROUP (\n\t\t\tORDER BY antiemetic_date\n\t\t) AS drugsadministereddates,\n\t\tMAX(ht3_desc) AS ht3_desc,\n\t\tMAX(cort_desc) AS cort_desc,\n\t\tMAX(dop_desc) AS dop_desc,\n\t\tMAX(nk1_desc) AS nk1_desc,\n\t\tMAX(olz_desc) AS olz_desc,\n\t\tSUM(CASE WHEN antiemetic_class = '5-HT3' THEN 1 ELSE 0 END) AS hte_count,\n\t\tSUM(CASE WHEN antiemetic_class = 'CORT' THEN 1 ELSE 0 END) AS cort_count,\n\t\tSUM(CASE WHEN antiemetic_class = 'DOP' THEN 1 ELSE 0 END) AS dop_count,\n\t\tSUM(CASE WHEN antiemetic_class = 'NK1' THEN 1 ELSE 0 END) AS nk1_count,\n\t\tSUM(CASE WHEN antiemetic_class = 'OLZ' THEN 1 ELSE 0 END) AS olz_count,\n\t\tSUM(CASE WHEN antiemetic_class IS NOT NULL THEN 1 ELSE 0 END) AS antiemetic_count,\n\t\tMAX(emetic_risk_number) AS max_emetic_risk\n\tFROM qm2_eme_antieme_details\n\tGROUP BY memberid, perf_period_key\n),\n\nmemberwithemeticrisk AS (\n\tSELECT\n\t\tec.memberid,\n\t\tec.perf_period_key,\n\t\tCASE WHEN ec.nk1_count = 0 THEN 1 ELSE 0 END AS low_risk_numerator, /*JIRA:IC-16504 | Antiemitics of class NK1 should not be there in the claim to qualify for low risk numerator*/\n\t\tCASE WHEN ec.nk1_count = 0 AND (LEAST(ec.hte_count, 1) + LEAST(ec.cort_count, 1) + LEAST(ec.dop_count, 1)) >= 1 THEN 1 ELSE 0 END AS moderate1_risk_numerator,\n\t\t/*JIRA:IC-14187 | Antiemitics of class NK1 should not be there, at least one of the three antiemitics (5-HT3, CORT, DOP) should be there in the claim to qualify for moderate risk numerator without carboplatin*/\n\t\tCASE WHEN LEAST(ec.nk1_count, 1) + LEAST(ec.hte_count, 1) + LEAST(ec.cort_count, 1) + LEAST(ec.dop_count, 1) + LEAST(ec.olz_count, 1) >= 2\n\t\t\t\tTHEN 1\n\t\t\tELSE 0\n\t\tEND AS moderate2_risk_numerator, /*JIRA:IC-14187 | At least two of the five antiemitics (NK1, 5-HT3, CORT, DOP, OLZ) should be there in the claim to qualify for moderate risk numerator without carboplatin*/\n\t\tCASE WHEN ec.nk1_count <> 0 AND ec.hte_count <> 0 AND ec.cort_count <> 0 THEN 1 ELSE 0 END AS high_risk_numerator,/*All the three antiemetics (NK1, 5-HT3, CORT) should be there in a claim to qualify for high risk numerator.*/\n\t\tNULLIF(chemocode, '') AS chemocode,\n\t\tec.consolidated_emetic_desc,\n\t\tNULLIF(chemodate, '') AS chemodate,\n\t\tNULLIF(drugsadministered, '') AS drugsadministered,\n\t\tNULLIF(drugsadministereddates, '') AS drugsadministereddates,\n\t\tec.nk1_count,\n\t\tec.hte_count,\n\t\tec.cort_count,\n\t\tec.dop_count,\n\t\tec.olz_count,\n\t\tec.max_emetic_risk, /*JIRA:IC-14187 | emetic risk would decide whether a member would qualify for low/moderate/high risk denominator*/\n\t\tec.ht3_desc,\n\t\tec.cort_desc,\n\t\tec.dop_desc,\n\t\tec.nk1_desc,\n\t\tec.olz_desc\n\tFROM summarized_emetic_claims AS ec\n),\n\nqm2_data_episode_mapping AS (\n\tSELECT\n\t\te.memberid,\n\t\tep.participatingprovidernpi,\n\t\tep.tin,\n\t\tep.principalcancercode,\n\t\tep.cancerdiagnosisgroupcode,\n\t\tep.lineofbusiness,\n\t\tep.perf_period_key,\n\t\tcm.month_first_date,\n\t\tep.episode_start_date,\n\t\tep.episode_end_date\n\tFROM memberwithemeticrisk AS e\n\t\tINNER JOIN dev_dtx_gc.staging.stg_episodes AS ep\n\t\t\tON e.memberid = ep.memberid\n\t\t\t\tAND e.chemodate >= ep.episode_start_date\n\t\t\t\tAND e.chemodate <= ep.episode_end_date\n\t\tINNER JOIN calendar_months AS cm\n\t\t\tON cm.month_first_date = DATE_TRUNC(MONTH, TO_DATE(e.chemodate))\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY e.memberid, ep.perf_period_key\n\t\t\tORDER BY\n\t\t\t\tABS(TO_DATE(e.chemodate) - cm.month_first_date) ASC, --to pick the closest attribution data to chemo\n\t\t\t\tcm.month_first_date DESC\n\t\t) = 1-- if incase chemo happened exactly between to attribution date, pick the latest (highly unlikely but got to cover) \n)\n\nSELECT\n\tm.memberid,\n\t1 AS denominator, /*Attributed members with Emetic risk would qualify for denominator*/\n\tCOALESCE(m.low_risk_numerator, 1) AS low_risk_numerator,\n\tCOALESCE(m.moderate1_risk_numerator, 0) AS moderate1_risk_numerator,\n\tCOALESCE(m.moderate2_risk_numerator, 0) AS moderate2_risk_numerator,\n\tCOALESCE(m.high_risk_numerator, 0) AS high_risk_numerator,\n\tCOALESCE(m.nk1_count, 0) AS nk1_count,\n\tCOALESCE(m.hte_count, 0) AS hte_count,\n\tCOALESCE(m.cort_count, 0) AS cort_count,\n\tCOALESCE(m.dop_count, 0) AS dop_count,\n\tCOALESCE(m.olz_count, 0) AS olz_count,\n\tCOALESCE(ht3_desc, 'No 5-HT3 Drugs found') AS ht3_desc,\n\tCOALESCE(cort_desc, 'No CORT Drugs found') AS cort_desc,\n\tCOALESCE(dop_desc, 'No DOP Drugs found') AS dop_desc,\n\tCOALESCE(nk1_desc, 'No NK1 Drugs found') AS nk1_desc,\n\tCOALESCE(olz_desc, 'No OLANZAPINE Drugs found') AS olz_desc,\n\tCOALESCE(m.max_emetic_risk, 1) AS max_emetic_risk,\n\tCOALESCE(m.chemocode, 'No Emetic Drugs found') AS chemocode,\n\tm.consolidated_emetic_desc,\n\tm.chemodate,\n\tCOALESCE(m.drugsadministered, 'No Anti-emetic Drugs found') AS drugsadministered,\n\tm.drugsadministereddates,\n\tem.participatingprovidernpi,\n\tem.perf_period_key,\n\tem.episode_start_date,\n\tem.episode_end_date,\n\tem.month_first_date AS contextdate,\n\tem.tin,\n\tem.principalcancercode,\n\tem.cancerdiagnosisgroupcode,\n\tem.lineofbusiness\nFROM memberwithemeticrisk AS m\n\tINNER JOIN qm2_data_episode_mapping AS em\n\t\tON m.memberid = em.memberid AND m.perf_period_key = em.perf_period_key",
    "raw_code": "{{ config( alias = 'stg_qm2', schema = 'staging') }}\r\n\r\nWITH calendar_months AS (\r\n\tSELECT DISTINCT DATE_TRUNC(MONTH, date) AS month_first_date\r\n\tFROM {{ ref('stg_dates') }}\r\n),\r\n\r\nqm2_raw_emetics_details AS (       --- IC-16505: Getting Highest Emetic risk available for each patient\r\n\tSELECT * FROM (\r\n\t\tSELECT\r\n\t\t\tc.memberid,\r\n\t\t\tep.perf_period_key,\r\n\t\t\te.code AS emetic_code,\r\n\t\t\tCONCAT_WS(' - ', e.code, e.agents) AS emetic_desc,\r\n\t\t\tcl.claimlineservicestartdate AS emetic_date,\r\n\t\t\te.emetic_risk,\r\n\t\t\tCASE WHEN emetic_risk = 'HIGH' THEN 4\r\n\t\t\t\tWHEN emetic_risk = 'MODERATE 2' THEN 3\r\n\t\t\t\tWHEN emetic_risk = 'MODERATE 1' THEN 2\r\n\t\t\t\tELSE 1\r\n\t\t\tEND AS emetic_risk_number\r\n\t\tFROM {{ source('IC1','CLAIM') }} AS c\r\n\t\t\tINNER JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\t\t\tON c.claimid = cl.claimid\r\n\t\t\tINNER JOIN {{ ref('stg_episodes') }} AS ep\r\n\t\t\t\tON c.memberid = ep.memberid\r\n\t\t\t\t\tAND cl.claimlineservicestartdate >= ep.episode_start_date\r\n\t\t\t\t\tAND cl.claimlineservicestartdate <= ep.episode_end_date\r\n\t\t\tINNER JOIN {{ ref('stg_seed_chemo_w_emeticrisk_codes') }} AS e\r\n\t\t\t\tON cl.claimlinehealthservicecode = e.code AND e.code_type = 'HCPCS'\r\n\t\tUNION ALL\r\n\t\tSELECT\r\n\t\t\tcp.memberid,\r\n\t\t\tep.perf_period_key,\r\n\t\t\te.code AS emetic_code,\r\n\t\t\tCONCAT_WS(' - ', e.code, e.agents) AS emetic_desc,\r\n\t\t\tcp.claimprescriptionfilleddate AS emetic_date,\r\n\t\t\te.emetic_risk,\r\n\t\t\tCASE WHEN emetic_risk = 'HIGH' THEN 4\r\n\t\t\t\tWHEN emetic_risk = 'MODERATE 2' THEN 3\r\n\t\t\t\tWHEN emetic_risk = 'MODERATE 1' THEN 2\r\n\t\t\t\tELSE 1\r\n\t\t\tEND AS emetic_risk_number\r\n\t\tFROM {{ source('IC1','CLAIMPHARMACY') }} AS cp\r\n\t\t\tINNER JOIN {{ ref('stg_episodes') }} AS ep\r\n\t\t\t\tON cp.memberid = ep.memberid\r\n\t\t\t\t\tAND cp.claimprescriptionfilleddate >= ep.episode_start_date\r\n\t\t\t\t\tAND cp.claimprescriptionfilleddate <= ep.episode_end_date\r\n\t\t\tINNER JOIN {{ ref('stg_seed_chemo_w_emeticrisk_codes') }} AS e\r\n\t\t\t\tON e.code = LEFT(cp.claimpharmacygenericproductidentifier, 10) AND e.code_type = 'GPI10'\r\n\t)\r\n),\r\n\r\nqualified_chemo AS (   --- Getting only one emetic record per patient based on Risk rank\r\n\tSELECT e.*\r\n\tFROM qm2_raw_emetics_details AS e\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY e.memberid, e.perf_period_key\r\n\t\t\tORDER BY e.emetic_risk_number DESC, e.emetic_date ASC\r\n\t\t) = 1\r\n),\r\n\r\nqualified_emetic_desc AS (   --- Getting all emetic records on Qualified Date to get consolidated Qualified Emetic desc\r\n\tSELECT\r\n\t\tqc.memberid,\r\n\t\tqc.perf_period_key,\r\n\t\tLISTAGG(DISTINCT re.emetic_desc, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY re.emetic_desc\r\n\t\t) AS qualified_emetic_desc\r\n\tFROM qualified_chemo AS qc\r\n\t\tLEFT OUTER JOIN qm2_raw_emetics_details AS re\r\n\t\t\tON qc.memberid = re.memberid AND qc.emetic_date = re.emetic_date AND qc.emetic_desc = re.emetic_desc\r\n\tGROUP BY qc.memberid, qc.perf_period_key\r\n),\r\n\r\nconsolidated_emetic_desc AS (   --- Getting all emetic records other than Qualified Date to get Consolidated Emetic desc\r\n\tSELECT\r\n\t\tqc.memberid,\r\n\t\tqc.perf_period_key,\r\n\t\tLISTAGG(DISTINCT re.emetic_desc, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY re.emetic_desc\r\n\t\t) AS consolidated_emetic_desc\r\n\tFROM qm2_raw_emetics_details AS re\r\n\t\tLEFT OUTER JOIN qualified_chemo AS qc\r\n\t\t\tON re.memberid = qc.memberid AND re.emetic_date = qc.emetic_date AND re.emetic_desc <> qc.emetic_desc\r\n\tGROUP BY qc.memberid, qc.perf_period_key\r\n),\r\n\r\nqm2_emetics_details AS (\r\n\tSELECT\r\n\t\te.*,\r\n\t\tqe.qualified_emetic_desc,\r\n\t\tCOALESCE(ce.consolidated_emetic_desc, 'None') AS consolidated_emetic_desc\r\n\tFROM qualified_chemo AS e\r\n\t\tLEFT OUTER JOIN qualified_emetic_desc AS qe\r\n\t\t\tON e.memberid = qe.memberid AND e.perf_period_key = qe.perf_period_key\r\n\t\tLEFT OUTER JOIN consolidated_emetic_desc AS ce\r\n\t\t\tON e.memberid = ce.memberid AND e.perf_period_key = ce.perf_period_key\r\n),\r\n\r\nqm2_eme_antieme_details AS (       --- IC-16505: Getting first Antiemetic per class on or after Highest Emetic risk for each patient\r\n\tSELECT\r\n\t\te.memberid,\r\n\t\te.perf_period_key,\r\n\t\te.emetic_code,\r\n\t\te.qualified_emetic_desc AS emetic_desc,\r\n\t\te.consolidated_emetic_desc,\r\n\t\te.emetic_date,\r\n\t\te.emetic_risk,\r\n\t\te.emetic_risk_number,\r\n\t\tae.antiemetic_code,\r\n\t\tae.antiemetic_desc,\r\n\t\tae.antiemetic_class,\r\n\t\tae.antiemetic_date,\r\n\t\tae.ht3_desc,\r\n\t\tae.cort_desc,\r\n\t\tae.dop_desc,\r\n\t\tae.nk1_desc,\r\n\t\tae.olz_desc\r\n\tFROM qm2_emetics_details AS e\r\n\t\tLEFT JOIN\r\n\t\t\t(\r\n\t\t\t\tSELECT\r\n\t\t\t\t\te.memberid,\r\n\t\t\t\t\ta.code AS antiemetic_code,\r\n\t\t\t\t\tCONCAT_WS(' - ', a.code, a.generic) AS antiemetic_desc,\r\n\t\t\t\t\tCASE WHEN a.class = '5-HT3' THEN CONCAT_WS(' - ', a.code, a.generic) END AS ht3_desc,\r\n\t\t\t\t\tCASE WHEN a.class = 'CORT' THEN CONCAT_WS(' - ', a.code, a.generic) END AS cort_desc,\r\n\t\t\t\t\tCASE WHEN a.class = 'DOP' THEN CONCAT_WS(' - ', a.code, a.generic) END AS dop_desc,\r\n\t\t\t\t\tCASE WHEN a.class = 'NK1' THEN CONCAT_WS(' - ', a.code, a.generic) END AS nk1_desc,\r\n\t\t\t\t\tCASE WHEN a.class = 'OLZ' THEN CONCAT_WS(' - ', a.code, a.generic) END AS olz_desc,\r\n\t\t\t\t\tcl.claimlineservicestartdate AS antiemetic_date,\r\n\t\t\t\t\ta.class AS antiemetic_class,\r\n\t\t\t\t\tep.perf_period_key\r\n\t\t\t\tFROM qm2_emetics_details AS e\r\n\t\t\t\t\tINNER JOIN {{ source('IC1','CLAIM') }} AS c\r\n\t\t\t\t\t\tON e.memberid = c.memberid\r\n\t\t\t\t\tINNER JOIN {{ source('IC1','CLAIMLINE') }} AS cl\r\n\t\t\t\t\t\tON c.claimid = cl.claimid\r\n\t\t\t\t\t\t\tAND e.emetic_date <= cl.claimlineservicestartdate\r\n\t\t\t\t\tINNER JOIN {{ ref('stg_episodes') }} AS ep\r\n\t\t\t\t\t\tON c.memberid = ep.memberid\r\n\t\t\t\t\t\t\tAND cl.claimlineservicestartdate >= ep.episode_start_date\r\n\t\t\t\t\t\t\tAND cl.claimlineservicestartdate <= ep.episode_end_date\r\n\t\t\t\t\tINNER JOIN {{ ref('stg_seed_antiemetics') }} AS a\r\n\t\t\t\t\t\tON cl.claimlinehealthservicecode = a.code\r\n\t\t\t\t\t\t\tAND a.code_type = 'HCPCS'\r\n\t\t\t\tUNION ALL\r\n\t\t\t\tSELECT\r\n\t\t\t\t\te.memberid,\r\n\t\t\t\t\ta.code AS antiemetic_code,\r\n\t\t\t\t\tCONCAT_WS(' - ', a.code, a.generic) AS antiemetic_desc,\r\n\t\t\t\t\tCASE WHEN a.class = '5-HT3' THEN CONCAT_WS(' - ', a.code, a.generic) END AS ht3_desc,\r\n\t\t\t\t\tCASE WHEN a.class = 'CORT' THEN CONCAT_WS(' - ', a.code, a.generic) END AS cort_desc,\r\n\t\t\t\t\tCASE WHEN a.class = 'DOP' THEN CONCAT_WS(' - ', a.code, a.generic) END AS dop_desc,\r\n\t\t\t\t\tCASE WHEN a.class = 'NK1' THEN CONCAT_WS(' - ', a.code, a.generic) END AS nk1_desc,\r\n\t\t\t\t\tCASE WHEN a.class = 'OLZ' THEN CONCAT_WS(' - ', a.code, a.generic) END AS olz_desc,\r\n\t\t\t\t\tcp.claimprescriptionfilleddate AS antiemetic_date,\r\n\t\t\t\t\ta.class AS antiemetic_class,\r\n\t\t\t\t\tep.perf_period_key\r\n\t\t\t\tFROM qm2_emetics_details AS e\r\n\t\t\t\t\tINNER JOIN {{ source('IC1','CLAIMPHARMACY') }} AS cp\r\n\t\t\t\t\t\tON e.memberid = cp.memberid\r\n\t\t\t\t\t\t\tAND e.emetic_date <= cp.claimprescriptionfilleddate\r\n\t\t\t\t\tINNER JOIN {{ ref('stg_episodes') }} AS ep\r\n\t\t\t\t\t\tON ep.memberid = cp.memberid\r\n\t\t\t\t\t\t\tAND ep.episode_start_date <= cp.claimprescriptionfilleddate\r\n\t\t\t\t\t\t\tAND ep.episode_end_date >= cp.claimprescriptionfilleddate\r\n\t\t\t\t\tINNER JOIN {{ ref('stg_seed_antiemetics') }} AS a\r\n\t\t\t\t\t\tON a.code = LEFT(cp.claimpharmacygenericproductidentifier, 8)\r\n\t\t\t\t\t\t\tAND a.code_type = 'GPI_8_DIGITS'\r\n\t\t\t) AS ae\r\n\t\t\tON e.memberid = ae.memberid\r\n\t\t\t\tAND e.perf_period_key = ae.perf_period_key\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY e.memberid, e.perf_period_key, ae.antiemetic_class\r\n\t\t\tORDER BY ae.antiemetic_date ASC\r\n\t\t) = 1\r\n),\r\n\r\nsummarized_emetic_claims AS (          --- IC-16505: Summerizing Emetic and AntiEmetic records on patient level\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\tperf_period_key,\r\n\t\tLISTAGG(DISTINCT emetic_desc, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY emetic_desc\r\n\t\t) AS chemocode,  -- IC-16356 Emetics as chemocodes  and AntiEmetics as Drugs\r\n\t\tLISTAGG(DISTINCT consolidated_emetic_desc, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY consolidated_emetic_desc\r\n\t\t) AS consolidated_emetic_desc,\r\n\t\tLISTAGG(DISTINCT emetic_date, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY emetic_date\r\n\t\t) AS chemodate,\r\n\t\tLISTAGG(DISTINCT antiemetic_desc, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY antiemetic_desc\r\n\t\t) AS drugsadministered,\r\n\t\tLISTAGG(DISTINCT antiemetic_date, ', ') WITHIN GROUP (\r\n\t\t\tORDER BY antiemetic_date\r\n\t\t) AS drugsadministereddates,\r\n\t\tMAX(ht3_desc) AS ht3_desc,\r\n\t\tMAX(cort_desc) AS cort_desc,\r\n\t\tMAX(dop_desc) AS dop_desc,\r\n\t\tMAX(nk1_desc) AS nk1_desc,\r\n\t\tMAX(olz_desc) AS olz_desc,\r\n\t\tSUM(CASE WHEN antiemetic_class = '5-HT3' THEN 1 ELSE 0 END) AS hte_count,\r\n\t\tSUM(CASE WHEN antiemetic_class = 'CORT' THEN 1 ELSE 0 END) AS cort_count,\r\n\t\tSUM(CASE WHEN antiemetic_class = 'DOP' THEN 1 ELSE 0 END) AS dop_count,\r\n\t\tSUM(CASE WHEN antiemetic_class = 'NK1' THEN 1 ELSE 0 END) AS nk1_count,\r\n\t\tSUM(CASE WHEN antiemetic_class = 'OLZ' THEN 1 ELSE 0 END) AS olz_count,\r\n\t\tSUM(CASE WHEN antiemetic_class IS NOT NULL THEN 1 ELSE 0 END) AS antiemetic_count,\r\n\t\tMAX(emetic_risk_number) AS max_emetic_risk\r\n\tFROM qm2_eme_antieme_details\r\n\tGROUP BY memberid, perf_period_key\r\n),\r\n\r\nmemberwithemeticrisk AS (\r\n\tSELECT\r\n\t\tec.memberid,\r\n\t\tec.perf_period_key,\r\n\t\tCASE WHEN ec.nk1_count = 0 THEN 1 ELSE 0 END AS low_risk_numerator, /*JIRA:IC-16504 | Antiemitics of class NK1 should not be there in the claim to qualify for low risk numerator*/\r\n\t\tCASE WHEN ec.nk1_count = 0 AND (LEAST(ec.hte_count, 1) + LEAST(ec.cort_count, 1) + LEAST(ec.dop_count, 1)) >= 1 THEN 1 ELSE 0 END AS moderate1_risk_numerator,\r\n\t\t/*JIRA:IC-14187 | Antiemitics of class NK1 should not be there, at least one of the three antiemitics (5-HT3, CORT, DOP) should be there in the claim to qualify for moderate risk numerator without carboplatin*/\r\n\t\tCASE WHEN LEAST(ec.nk1_count, 1) + LEAST(ec.hte_count, 1) + LEAST(ec.cort_count, 1) + LEAST(ec.dop_count, 1) + LEAST(ec.olz_count, 1) >= 2\r\n\t\t\t\tTHEN 1\r\n\t\t\tELSE 0\r\n\t\tEND AS moderate2_risk_numerator, /*JIRA:IC-14187 | At least two of the five antiemitics (NK1, 5-HT3, CORT, DOP, OLZ) should be there in the claim to qualify for moderate risk numerator without carboplatin*/\r\n\t\tCASE WHEN ec.nk1_count <> 0 AND ec.hte_count <> 0 AND ec.cort_count <> 0 THEN 1 ELSE 0 END AS high_risk_numerator,/*All the three antiemetics (NK1, 5-HT3, CORT) should be there in a claim to qualify for high risk numerator.*/\r\n\t\tNULLIF(chemocode, '') AS chemocode,\r\n\t\tec.consolidated_emetic_desc,\r\n\t\tNULLIF(chemodate, '') AS chemodate,\r\n\t\tNULLIF(drugsadministered, '') AS drugsadministered,\r\n\t\tNULLIF(drugsadministereddates, '') AS drugsadministereddates,\r\n\t\tec.nk1_count,\r\n\t\tec.hte_count,\r\n\t\tec.cort_count,\r\n\t\tec.dop_count,\r\n\t\tec.olz_count,\r\n\t\tec.max_emetic_risk, /*JIRA:IC-14187 | emetic risk would decide whether a member would qualify for low/moderate/high risk denominator*/\r\n\t\tec.ht3_desc,\r\n\t\tec.cort_desc,\r\n\t\tec.dop_desc,\r\n\t\tec.nk1_desc,\r\n\t\tec.olz_desc\r\n\tFROM summarized_emetic_claims AS ec\r\n),\r\n\r\nqm2_data_episode_mapping AS (\r\n\tSELECT\r\n\t\te.memberid,\r\n\t\tep.participatingprovidernpi,\r\n\t\tep.tin,\r\n\t\tep.principalcancercode,\r\n\t\tep.cancerdiagnosisgroupcode,\r\n\t\tep.lineofbusiness,\r\n\t\tep.perf_period_key,\r\n\t\tcm.month_first_date,\r\n\t\tep.episode_start_date,\r\n\t\tep.episode_end_date\r\n\tFROM memberwithemeticrisk AS e\r\n\t\tINNER JOIN {{ ref('stg_episodes') }} AS ep\r\n\t\t\tON e.memberid = ep.memberid\r\n\t\t\t\tAND e.chemodate >= ep.episode_start_date\r\n\t\t\t\tAND e.chemodate <= ep.episode_end_date\r\n\t\tINNER JOIN calendar_months AS cm\r\n\t\t\tON cm.month_first_date = DATE_TRUNC(MONTH, TO_DATE(e.chemodate))\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY e.memberid, ep.perf_period_key\r\n\t\t\tORDER BY\r\n\t\t\t\tABS(TO_DATE(e.chemodate) - cm.month_first_date) ASC, --to pick the closest attribution data to chemo\r\n\t\t\t\tcm.month_first_date DESC\r\n\t\t) = 1-- if incase chemo happened exactly between to attribution date, pick the latest (highly unlikely but got to cover) \r\n)\r\n\r\nSELECT\r\n\tm.memberid,\r\n\t1 AS denominator, /*Attributed members with Emetic risk would qualify for denominator*/\r\n\tCOALESCE(m.low_risk_numerator, 1) AS low_risk_numerator,\r\n\tCOALESCE(m.moderate1_risk_numerator, 0) AS moderate1_risk_numerator,\r\n\tCOALESCE(m.moderate2_risk_numerator, 0) AS moderate2_risk_numerator,\r\n\tCOALESCE(m.high_risk_numerator, 0) AS high_risk_numerator,\r\n\tCOALESCE(m.nk1_count, 0) AS nk1_count,\r\n\tCOALESCE(m.hte_count, 0) AS hte_count,\r\n\tCOALESCE(m.cort_count, 0) AS cort_count,\r\n\tCOALESCE(m.dop_count, 0) AS dop_count,\r\n\tCOALESCE(m.olz_count, 0) AS olz_count,\r\n\tCOALESCE(ht3_desc, 'No 5-HT3 Drugs found') AS ht3_desc,\r\n\tCOALESCE(cort_desc, 'No CORT Drugs found') AS cort_desc,\r\n\tCOALESCE(dop_desc, 'No DOP Drugs found') AS dop_desc,\r\n\tCOALESCE(nk1_desc, 'No NK1 Drugs found') AS nk1_desc,\r\n\tCOALESCE(olz_desc, 'No OLANZAPINE Drugs found') AS olz_desc,\r\n\tCOALESCE(m.max_emetic_risk, 1) AS max_emetic_risk,\r\n\tCOALESCE(m.chemocode, 'No Emetic Drugs found') AS chemocode,\r\n\tm.consolidated_emetic_desc,\r\n\tm.chemodate,\r\n\tCOALESCE(m.drugsadministered, 'No Anti-emetic Drugs found') AS drugsadministered,\r\n\tm.drugsadministereddates,\r\n\tem.participatingprovidernpi,\r\n\tem.perf_period_key,\r\n\tem.episode_start_date,\r\n\tem.episode_end_date,\r\n\tem.month_first_date AS contextdate,\r\n\tem.tin,\r\n\tem.principalcancercode,\r\n\tem.cancerdiagnosisgroupcode,\r\n\tem.lineofbusiness\r\nFROM memberwithemeticrisk AS m\r\n\tINNER JOIN qm2_data_episode_mapping AS em\r\n\t\tON m.memberid = em.memberid AND m.perf_period_key = em.perf_period_key",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_qm2",
    "description": "QM2 Informations",
    "columns": {
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "LOW_RISK_NUMERATOR": {
        "name": "LOW_RISK_NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MODERATE1_RISK_NUMERATOR": {
        "name": "MODERATE1_RISK_NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MODERATE2_RISK_NUMERATOR": {
        "name": "MODERATE2_RISK_NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "HIGH_RISK_NUMERATOR": {
        "name": "HIGH_RISK_NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.CLAIM",
        "source.anthem_dev.IC1.CLAIMPHARMACY",
        "source.anthem_dev.IC1.CLAIMLINE",
        "model.anthem_dev.stg_dates",
        "model.anthem_dev.stg_episodes",
        "model.anthem_dev.stg_seed_chemo_w_emeticrisk_codes",
        "model.anthem_dev.stg_seed_antiemetics"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_qm3_4",
    "name": "stg_qm3_4",
    "original_file_path": "models\\staging\\stg_qm3_4.sql",
    "compiled_code": "\n\n-- Denominator Logic:\n-- Members that are sent in Anthem\u2019s attribution file\n-- Numerator Logic: \n-- (qm3: >= one inpatient admission. qm4: >=one ed visit)\n-- AND\n-- \u00b7       >= one of the 10 qualifying conditions (i.e., anemia, dehydration, diarrhea, emesis, fever, nausea, neutropenia, pain, pneumonia, or sepsis)\n-- \u00b7       <= 30 days of non-ipatient chemotherapy treatment (non-inpatient POS code condition: \"!= 21\" )\n\nWITH months AS (\n\tSELECT DISTINCT DATE_TRUNC(MONTH, date) AS month\n\tFROM dev_dtx_gc.staging.stg_dates\n),\n\ninitial_qm_3_4 AS (\n\tSELECT\n\t\tep.memberid,\n\t\tep.episode_start_date,\n\t\tep.episode_end_date,\n\t\tad.dateofservice,\n\t\tad.admission_start_date,\n\t\tad.ipdateid,\n\t\tm.month AS contextdate,\n\t\tmc.chemodate,\n\t\tmc.chemocode,\n\t\tmc.chemodesc,\n\t\tDATEDIFF(DD, mc.chemodate, ad.dateofservice) AS chemodays,\n\t\tCASE\n\t\t\tWHEN chemodays >= 0\n\t\t\t\tAND chemodays <= 30\n\t\t\t\tAND ad.dateofservice IS NOT NULL\n\t\t\t\tTHEN 1\n\t\t\tELSE 0\n\t\tEND AS numerator,\n\t\tcoalesce(ad.admission_type,' ') AS pos,\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY\n\t\t\t\tep.memberid,\n\t\t\t\tep.episode_start_date,\n\t\t\t\tcontextdate,\n\t\t\t\tpos\n\t\t\tORDER BY\n\t\t\t\tnumerator DESC,\n\t\t\t\tad.dateofservice DESC,\n\t\t\t\tmc.chemodate DESC\n\t\t) AS row_no,\n\t\tCOUNT(DISTINCT pos) OVER (\n\t\t\tPARTITION BY ep.memberid, ep.episode_start_date, contextdate\n\t\t) AS distinct_pos_count,\n\t\tad.claimlineplaceofservicecode,\n\t\tep.participatingprovidernpi,\n\t\tep.principalcancercode,\n\t\tep.cancerdiagnosisgroupcode,\n\t\tep.tin,\n\t\tep.lineofbusiness,\n\t\tad.icd10code,\n\t\tad.icd10description,\n\t\tad.claimlinehealthservicecode,\n\t\tep.perf_period_key\n\tFROM dev_dtx_gc.staging.stg_episodes AS ep\n\t\tINNER JOIN months AS m\n\t\t\tON m.month BETWEEN DATE_TRUNC(MONTH, ep.episode_start_date)\n\t\t\t\tAND DATE_TRUNC(MONTH, ep.episode_end_date)\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_member_chemotherapy AS mc\n\t\t\tON ep.memberid = mc.memberid\n\t\t\t\tAND mc.claimlineplaceofservicecode <> 21\n\t\t\t\tAND mc.chemodate BETWEEN ep.episode_start_date AND ep.episode_end_date\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_avoidable_admissions AS ad\n\t\t\tON ep.memberid = ad.memberid\n\t\t\t\tAND ep.episode_start_date <= ad.admission_start_date\n\t\t\t\tAND ep.episode_end_date >= ad.admission_start_date\n\t\t\t\tAND DATE_TRUNC(MONTH, ad.admission_start_date) = m.month\n),\n\noneepisodepermonth AS (\n\tSELECT\n\t\tqm.memberid,\n\t\t1 AS denominator,\n\t\tCASE qm.pos\n\t\t\tWHEN 'IP'\n\t\t\t\tTHEN qm.numerator\n\t\t\tELSE 0\n\t\tEND AS numerator,\n\t\tqm.episode_start_date,\n\t\tqm.episode_end_date,\n\t\tqm.contextdate,\n\t\tqm.participatingprovidernpi,\n\t\tqm.perf_period_key,\n\t\tqm.principalcancercode,\n\t\tqm.cancerdiagnosisgroupcode,\n\t\tqm.tin,\n\t\tqm.lineofbusiness,\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.dateofservice END AS dateofservice,\n\t\tqm.chemodate,\n\t\tqm.chemocode,\n\t\tqm.chemodesc,\n\t\tqm.chemodays,\n\t\tqm.claimlineplaceofservicecode,\n\t\tqm.pos AS placeofservice,\n\t\t'QM3' AS qm_name,\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.icd10code END AS icd10code,\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.icd10description END AS icd10description,\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.claimlinehealthservicecode END AS claimlinehealthservicecode,\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.admission_start_date END AS admission_start_date,\n\t\tqm.ipdateid\n\tFROM initial_qm_3_4 AS qm\n\tWHERE qm.row_no = 1\n\t\tAND (distinct_pos_count = 1 OR qm.pos = 'IP') -- IC-15039: Added to avoid ED record for the patients having IP record\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY qm.memberid, qm.episode_start_date, qm.contextdate\n\t\t\tORDER BY numerator DESC, qm.dateofservice DESC\n\t\t) = 1\n\n\tUNION ALL\n\n\tSELECT\n\t\tqm.memberid,\n\t\t1 AS denominator,\n\t\tCASE\n\t\t\tWHEN qm.pos = 'ED' -- IC-14456 , Ask is to add POS=22 with Specific Revcodes and Hcpcs are consider as ED\n\t\t\t\tTHEN qm.numerator\n\t\t\tELSE 0\n\t\tEND AS numerator,\n\t\tqm.episode_start_date,\n\t\tqm.episode_end_date,\n\t\tqm.contextdate,\n\t\tqm.participatingprovidernpi,\n\t\tqm.perf_period_key,\n\t\tqm.principalcancercode,\n\t\tqm.cancerdiagnosisgroupcode,\n\t\tqm.tin,\n\t\tqm.lineofbusiness,\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.dateofservice END AS dateofservice,\n\t\tqm.chemodate,\n\t\tqm.chemocode,\n\t\tqm.chemodesc,\n\t\tqm.chemodays,\n\t\tqm.claimlineplaceofservicecode,\n\t\tqm.pos AS placeofservice,\n\t\t'QM4' AS qm_name,\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.icd10code END AS icd10code,\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.icd10description END AS icd10description,\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.claimlinehealthservicecode END AS claimlinehealthservicecode,\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.admission_start_date END AS admission_start_date,\n\t\tNULL AS ipdateid\n\tFROM initial_qm_3_4 AS qm\n\tWHERE qm.row_no = 1\n\t\tAND (distinct_pos_count = 1 OR qm.pos = 'ED') -- IC-15039: Added to avoid IP record for the patients having ED record\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY qm.memberid, qm.episode_start_date, qm.contextdate\n\t\t\tORDER BY numerator DESC, qm.dateofservice DESC\n\t\t) = 1\n)\n\nSELECT * FROM oneepisodepermonth",
    "raw_code": "{{ config( alias = 'stg_qm3_4', schema = 'staging') }}\r\n\r\n-- Denominator Logic:\r\n-- Members that are sent in Anthem\u2019s attribution file\r\n-- Numerator Logic: \r\n-- (qm3: >= one inpatient admission. qm4: >=one ed visit)\r\n-- AND\r\n-- \u00b7       >= one of the 10 qualifying conditions (i.e., anemia, dehydration, diarrhea, emesis, fever, nausea, neutropenia, pain, pneumonia, or sepsis)\r\n-- \u00b7       <= 30 days of non-ipatient chemotherapy treatment (non-inpatient POS code condition: \"!= 21\" )\r\n\r\nWITH months AS (\r\n\tSELECT DISTINCT DATE_TRUNC(MONTH, date) AS month\r\n\tFROM {{ ref('stg_dates') }}\r\n),\r\n\r\ninitial_qm_3_4 AS (\r\n\tSELECT\r\n\t\tep.memberid,\r\n\t\tep.episode_start_date,\r\n\t\tep.episode_end_date,\r\n\t\tad.dateofservice,\r\n\t\tad.admission_start_date,\r\n\t\tad.ipdateid,\r\n\t\tm.month AS contextdate,\r\n\t\tmc.chemodate,\r\n\t\tmc.chemocode,\r\n\t\tmc.chemodesc,\r\n\t\tDATEDIFF(DD, mc.chemodate, ad.dateofservice) AS chemodays,\r\n\t\tCASE\r\n\t\t\tWHEN chemodays >= 0\r\n\t\t\t\tAND chemodays <= 30\r\n\t\t\t\tAND ad.dateofservice IS NOT NULL\r\n\t\t\t\tTHEN 1\r\n\t\t\tELSE 0\r\n\t\tEND AS numerator,\r\n\t\tcoalesce(ad.admission_type,' ') AS pos,\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY\r\n\t\t\t\tep.memberid,\r\n\t\t\t\tep.episode_start_date,\r\n\t\t\t\tcontextdate,\r\n\t\t\t\tpos\r\n\t\t\tORDER BY\r\n\t\t\t\tnumerator DESC,\r\n\t\t\t\tad.dateofservice DESC,\r\n\t\t\t\tmc.chemodate DESC\r\n\t\t) AS row_no,\r\n\t\tCOUNT(DISTINCT pos) OVER (\r\n\t\t\tPARTITION BY ep.memberid, ep.episode_start_date, contextdate\r\n\t\t) AS distinct_pos_count,\r\n\t\tad.claimlineplaceofservicecode,\r\n\t\tep.participatingprovidernpi,\r\n\t\tep.principalcancercode,\r\n\t\tep.cancerdiagnosisgroupcode,\r\n\t\tep.tin,\r\n\t\tep.lineofbusiness,\r\n\t\tad.icd10code,\r\n\t\tad.icd10description,\r\n\t\tad.claimlinehealthservicecode,\r\n\t\tep.perf_period_key\r\n\tFROM {{ ref('stg_episodes') }} AS ep\r\n\t\tINNER JOIN months AS m\r\n\t\t\tON m.month BETWEEN DATE_TRUNC(MONTH, ep.episode_start_date)\r\n\t\t\t\tAND DATE_TRUNC(MONTH, ep.episode_end_date)\r\n\t\tLEFT JOIN {{ ref('stg_member_chemotherapy') }} AS mc\r\n\t\t\tON ep.memberid = mc.memberid\r\n\t\t\t\tAND mc.claimlineplaceofservicecode <> 21\r\n\t\t\t\tAND mc.chemodate BETWEEN ep.episode_start_date AND ep.episode_end_date\r\n\t\tLEFT JOIN {{ ref('stg_avoidable_admissions') }} AS ad\r\n\t\t\tON ep.memberid = ad.memberid\r\n\t\t\t\tAND ep.episode_start_date <= ad.admission_start_date\r\n\t\t\t\tAND ep.episode_end_date >= ad.admission_start_date\r\n\t\t\t\tAND DATE_TRUNC(MONTH, ad.admission_start_date) = m.month\r\n),\r\n\r\noneepisodepermonth AS (\r\n\tSELECT\r\n\t\tqm.memberid,\r\n\t\t1 AS denominator,\r\n\t\tCASE qm.pos\r\n\t\t\tWHEN 'IP'\r\n\t\t\t\tTHEN qm.numerator\r\n\t\t\tELSE 0\r\n\t\tEND AS numerator,\r\n\t\tqm.episode_start_date,\r\n\t\tqm.episode_end_date,\r\n\t\tqm.contextdate,\r\n\t\tqm.participatingprovidernpi,\r\n\t\tqm.perf_period_key,\r\n\t\tqm.principalcancercode,\r\n\t\tqm.cancerdiagnosisgroupcode,\r\n\t\tqm.tin,\r\n\t\tqm.lineofbusiness,\r\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.dateofservice END AS dateofservice,\r\n\t\tqm.chemodate,\r\n\t\tqm.chemocode,\r\n\t\tqm.chemodesc,\r\n\t\tqm.chemodays,\r\n\t\tqm.claimlineplaceofservicecode,\r\n\t\tqm.pos AS placeofservice,\r\n\t\t'QM3' AS qm_name,\r\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.icd10code END AS icd10code,\r\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.icd10description END AS icd10description,\r\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.claimlinehealthservicecode END AS claimlinehealthservicecode,\r\n\t\tCASE WHEN qm.pos = 'IP' THEN qm.admission_start_date END AS admission_start_date,\r\n\t\tqm.ipdateid\r\n\tFROM initial_qm_3_4 AS qm\r\n\tWHERE qm.row_no = 1\r\n\t\tAND (distinct_pos_count = 1 OR qm.pos = 'IP') -- IC-15039: Added to avoid ED record for the patients having IP record\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY qm.memberid, qm.episode_start_date, qm.contextdate\r\n\t\t\tORDER BY numerator DESC, qm.dateofservice DESC\r\n\t\t) = 1\r\n\r\n\tUNION ALL\r\n\r\n\tSELECT\r\n\t\tqm.memberid,\r\n\t\t1 AS denominator,\r\n\t\tCASE\r\n\t\t\tWHEN qm.pos = 'ED' -- IC-14456 , Ask is to add POS=22 with Specific Revcodes and Hcpcs are consider as ED\r\n\t\t\t\tTHEN qm.numerator\r\n\t\t\tELSE 0\r\n\t\tEND AS numerator,\r\n\t\tqm.episode_start_date,\r\n\t\tqm.episode_end_date,\r\n\t\tqm.contextdate,\r\n\t\tqm.participatingprovidernpi,\r\n\t\tqm.perf_period_key,\r\n\t\tqm.principalcancercode,\r\n\t\tqm.cancerdiagnosisgroupcode,\r\n\t\tqm.tin,\r\n\t\tqm.lineofbusiness,\r\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.dateofservice END AS dateofservice,\r\n\t\tqm.chemodate,\r\n\t\tqm.chemocode,\r\n\t\tqm.chemodesc,\r\n\t\tqm.chemodays,\r\n\t\tqm.claimlineplaceofservicecode,\r\n\t\tqm.pos AS placeofservice,\r\n\t\t'QM4' AS qm_name,\r\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.icd10code END AS icd10code,\r\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.icd10description END AS icd10description,\r\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.claimlinehealthservicecode END AS claimlinehealthservicecode,\r\n\t\tCASE WHEN qm.pos = 'ED' THEN qm.admission_start_date END AS admission_start_date,\r\n\t\tNULL AS ipdateid\r\n\tFROM initial_qm_3_4 AS qm\r\n\tWHERE qm.row_no = 1\r\n\t\tAND (distinct_pos_count = 1 OR qm.pos = 'ED') -- IC-15039: Added to avoid IP record for the patients having ED record\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY qm.memberid, qm.episode_start_date, qm.contextdate\r\n\t\t\tORDER BY numerator DESC, qm.dateofservice DESC\r\n\t\t) = 1\r\n)\r\n\r\nSELECT * FROM oneepisodepermonth",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_qm3_4",
    "description": "QM3 & QM4 Informations",
    "columns": {
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NUMERATOR": {
        "name": "NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TIN": {
        "name": "TIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_dates",
        "model.anthem_dev.stg_episodes",
        "model.anthem_dev.stg_member_chemotherapy",
        "model.anthem_dev.stg_avoidable_admissions"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_qm5",
    "name": "stg_qm5",
    "original_file_path": "models\\staging\\stg_qm5.sql",
    "compiled_code": "\n\n-- Denominator Logic:\n-- . Member attribution \n-- AND\n-- . Date of death\n-- Numerator Logic:\n-- Count of all patients that died minus the unique count of patients that received chemotherapy treatment in the last 14 days of death by comparing death date to date of service of chemo administration claim.\n\nWITH member_chemo AS (\n\tSELECT\n\t\teol.memberid,\n\t\teol.episode_start_date,\n\t\teol.episode_end_date,\n\t\tCASE\n\t\t\tWHEN mc.memberid IS NULL\n\t\t\t\tTHEN 0\n\t\t\tELSE 1\n\t\tEND AS chemo_exists,\n\t\teol.memberdeathdate,\n\t\tmc.chemodate,\n\t\tmc.chemocode,\n\t\teol.participatingprovidernpi,\n\t\teol.perf_period_key,\n\t\teol.principalcancercode,\n\t\teol.cancerdiagnosisgroupcode,\n\t\teol.tin,\n\t\teol.lineofbusiness,\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY eol.memberid\n\t\t\tORDER BY chemo_exists DESC\n\t\t) AS row_no\n\tFROM dev_dtx_gc.staging.stg_eol_members AS eol\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_member_chemotherapy AS mc\n\t\t\tON eol.memberid = mc.memberid\n\t\t\t\tAND mc.chemodate >= DATEADD(DAY, -14, eol.memberdeathdate)\n\t\t\t\tAND eol.memberdeathdate >= mc.chemodate\n)\n\nSELECT\n\tmc.memberid,\n\t1 AS denominator,\n\tCASE mc.chemo_exists\n\t\tWHEN 0\n\t\t\tTHEN 1\n\t\tELSE 0\n\tEND AS numerator,\n\tmc.episode_start_date,\n\tmc.episode_end_date,\n\tmc.participatingprovidernpi,\n\tmc.perf_period_key,\n\tmc.principalcancercode,\n\tmc.cancerdiagnosisgroupcode,\n\tmc.tin,\n\tmc.lineofbusiness,\n\tmc.memberdeathdate,\n\tDATE_TRUNC(MONTH, mc.memberdeathdate) AS contextdate,\n\tmc.chemodate,\n\tmc.chemocode\nFROM member_chemo AS mc\nWHERE mc.row_no = 1",
    "raw_code": "{{ config( alias = 'stg_qm5', schema = 'staging') }}\r\n\r\n-- Denominator Logic:\r\n-- . Member attribution \r\n-- AND\r\n-- . Date of death\r\n-- Numerator Logic:\r\n-- Count of all patients that died minus the unique count of patients that received chemotherapy treatment in the last 14 days of death by comparing death date to date of service of chemo administration claim.\r\n\r\nWITH member_chemo AS (\r\n\tSELECT\r\n\t\teol.memberid,\r\n\t\teol.episode_start_date,\r\n\t\teol.episode_end_date,\r\n\t\tCASE\r\n\t\t\tWHEN mc.memberid IS NULL\r\n\t\t\t\tTHEN 0\r\n\t\t\tELSE 1\r\n\t\tEND AS chemo_exists,\r\n\t\teol.memberdeathdate,\r\n\t\tmc.chemodate,\r\n\t\tmc.chemocode,\r\n\t\teol.participatingprovidernpi,\r\n\t\teol.perf_period_key,\r\n\t\teol.principalcancercode,\r\n\t\teol.cancerdiagnosisgroupcode,\r\n\t\teol.tin,\r\n\t\teol.lineofbusiness,\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY eol.memberid\r\n\t\t\tORDER BY chemo_exists DESC\r\n\t\t) AS row_no\r\n\tFROM {{ ref('stg_eol_members') }} AS eol\r\n\t\tLEFT JOIN {{ ref('stg_member_chemotherapy') }} AS mc\r\n\t\t\tON eol.memberid = mc.memberid\r\n\t\t\t\tAND mc.chemodate >= DATEADD(DAY, -14, eol.memberdeathdate)\r\n\t\t\t\tAND eol.memberdeathdate >= mc.chemodate\r\n)\r\n\r\nSELECT\r\n\tmc.memberid,\r\n\t1 AS denominator,\r\n\tCASE mc.chemo_exists\r\n\t\tWHEN 0\r\n\t\t\tTHEN 1\r\n\t\tELSE 0\r\n\tEND AS numerator,\r\n\tmc.episode_start_date,\r\n\tmc.episode_end_date,\r\n\tmc.participatingprovidernpi,\r\n\tmc.perf_period_key,\r\n\tmc.principalcancercode,\r\n\tmc.cancerdiagnosisgroupcode,\r\n\tmc.tin,\r\n\tmc.lineofbusiness,\r\n\tmc.memberdeathdate,\r\n\tDATE_TRUNC(MONTH, mc.memberdeathdate) AS contextdate,\r\n\tmc.chemodate,\r\n\tmc.chemocode\r\nFROM member_chemo AS mc\r\nWHERE mc.row_no = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_qm5",
    "description": "QM5 Informations",
    "columns": {
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NUMERATOR": {
        "name": "NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TIN": {
        "name": "TIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_eol_members",
        "model.anthem_dev.stg_member_chemotherapy"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_qm6",
    "name": "stg_qm6",
    "original_file_path": "models\\staging\\stg_qm6.sql",
    "compiled_code": "\n\n-- Denominator Logic:\n-- . Member attribution \n-- AND\n-- . Date of death\n-- Numerator Logic:\n/*This measure involves calculating an outcome to determine\n members who had fewer than two emergency department visits\n in the last 30 days of life. \u201cPerformance Met\u201d for this\n numerator indicates the member had fewer than two emergency\n department visits in the last 30 days of life: indicating a high quality of care.\n*/\n\nWITH ed_visits AS (\n\tSELECT\n\t\teol.memberid,\n\t\teol.episode_start_date,\n\t\teol.episode_end_date,\n\t\teol.memberdeathdate,\n\t\teol.participatingprovidernpi,\n\t\teol.perf_period_key,\n\t\teol.principalcancercode,\n\t\teol.cancerdiagnosisgroupcode,\n\t\teol.tin,\n\t\teol.lineofbusiness,\n\t\tSUM(CASE\n\t\t\tWHEN ad.dateofservice IS NULL\n\t\t\t\tTHEN 0\n\t\t\tELSE 1\n\t\tEND) OVER (\n\t\t\tPARTITION BY\n\t\t\t\teol.memberid,\n\t\t\t\teol.episode_start_date\n\t\t) AS ed_visit_count,\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY eol.memberid\n\t\t\tORDER BY ad.dateofservice DESC\n\t\t) AS row_no,\n\t\tad.dateofservice\n\tFROM dev_dtx_gc.staging.stg_eol_members AS eol\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_member_admissions AS ad\n\t\t\tON eol.memberid = ad.memberid\n\t\t\t\tAND (\n\t\t\t\t\tad.claimlineplaceofservicecode IN (22, 23)\n\t\t\t\t\tAND (\n\t\t\t\t\t\tad.claimlinerevenuecode IN ('0450', '0451', '0452', '0453', '0454', '0455', '0457', '0458', '0459')\n\t\t\t\t\t\tOR (ad.claimlinerevenuecode = '0456' AND ad.claimlinehealthservicecode IN ('99281', '99282', '99283', '99284', '99285'))\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\tAND ad.dateofservice >= eol.memberdeathdate - 30\n\t\t\t\tAND eol.memberdeathdate >= ad.dateofservice\n)\n\nSELECT\n\tev.memberid,\n\t1 AS denominator,\n\tCASE\n\t\tWHEN ev.ed_visit_count <= 1\n\t\t\tTHEN 1\n\t\tELSE 0\n\tEND AS numerator,\n\tev.episode_start_date,\n\tev.episode_end_date,\n\tev.participatingprovidernpi,\n\tev.perf_period_key,\n\tev.principalcancercode,\n\tev.cancerdiagnosisgroupcode,\n\tev.tin,\n\tev.lineofbusiness,\n\tev.memberdeathdate,\n\tDATE_TRUNC(MONTH, ev.memberdeathdate) AS contextdate,\n\tev.dateofservice AS lastedvisitdate\nFROM ed_visits AS ev\nWHERE ev.row_no = 1",
    "raw_code": "{{ config( alias = 'stg_qm6', schema = 'staging') }}\r\n\r\n-- Denominator Logic:\r\n-- . Member attribution \r\n-- AND\r\n-- . Date of death\r\n-- Numerator Logic:\r\n/*This measure involves calculating an outcome to determine\r\n members who had fewer than two emergency department visits\r\n in the last 30 days of life. \u201cPerformance Met\u201d for this\r\n numerator indicates the member had fewer than two emergency\r\n department visits in the last 30 days of life: indicating a high quality of care.\r\n*/\r\n\r\nWITH ed_visits AS (\r\n\tSELECT\r\n\t\teol.memberid,\r\n\t\teol.episode_start_date,\r\n\t\teol.episode_end_date,\r\n\t\teol.memberdeathdate,\r\n\t\teol.participatingprovidernpi,\r\n\t\teol.perf_period_key,\r\n\t\teol.principalcancercode,\r\n\t\teol.cancerdiagnosisgroupcode,\r\n\t\teol.tin,\r\n\t\teol.lineofbusiness,\r\n\t\tSUM(CASE\r\n\t\t\tWHEN ad.dateofservice IS NULL\r\n\t\t\t\tTHEN 0\r\n\t\t\tELSE 1\r\n\t\tEND) OVER (\r\n\t\t\tPARTITION BY\r\n\t\t\t\teol.memberid,\r\n\t\t\t\teol.episode_start_date\r\n\t\t) AS ed_visit_count,\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY eol.memberid\r\n\t\t\tORDER BY ad.dateofservice DESC\r\n\t\t) AS row_no,\r\n\t\tad.dateofservice\r\n\tFROM {{ ref('stg_eol_members') }} AS eol\r\n\t\tLEFT JOIN {{ ref('stg_member_admissions') }} AS ad\r\n\t\t\tON eol.memberid = ad.memberid\r\n\t\t\t\tAND (\r\n\t\t\t\t\tad.claimlineplaceofservicecode IN (22, 23)\r\n\t\t\t\t\tAND (\r\n\t\t\t\t\t\tad.claimlinerevenuecode IN ('0450', '0451', '0452', '0453', '0454', '0455', '0457', '0458', '0459')\r\n\t\t\t\t\t\tOR (ad.claimlinerevenuecode = '0456' AND ad.claimlinehealthservicecode IN ('99281', '99282', '99283', '99284', '99285'))\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t\tAND ad.dateofservice >= eol.memberdeathdate - 30\r\n\t\t\t\tAND eol.memberdeathdate >= ad.dateofservice\r\n)\r\n\r\nSELECT\r\n\tev.memberid,\r\n\t1 AS denominator,\r\n\tCASE\r\n\t\tWHEN ev.ed_visit_count <= 1\r\n\t\t\tTHEN 1\r\n\t\tELSE 0\r\n\tEND AS numerator,\r\n\tev.episode_start_date,\r\n\tev.episode_end_date,\r\n\tev.participatingprovidernpi,\r\n\tev.perf_period_key,\r\n\tev.principalcancercode,\r\n\tev.cancerdiagnosisgroupcode,\r\n\tev.tin,\r\n\tev.lineofbusiness,\r\n\tev.memberdeathdate,\r\n\tDATE_TRUNC(MONTH, ev.memberdeathdate) AS contextdate,\r\n\tev.dateofservice AS lastedvisitdate\r\nFROM ed_visits AS ev\r\nWHERE ev.row_no = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_qm6",
    "description": "QM6 Informations",
    "columns": {
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NUMERATOR": {
        "name": "NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TIN": {
        "name": "TIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_eol_members",
        "model.anthem_dev.stg_member_admissions"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_qm7",
    "name": "stg_qm7",
    "original_file_path": "models\\staging\\stg_qm7.sql",
    "compiled_code": "\n\n-- Denominator Logic:\n-- . Member attribution \n-- AND\n-- . Date of death\n-- Numerator Logic:\n/* This measure involves calculating an outcome to determine\n members did not have an ICU admission in the last 30 days\n  of life. \u201cPerformance Met\u201d for this numerator indicates the member\n  did not have an ICU admission in the last 30 days of life: indicating a high quality of care.\n*/\n\nWITH icu_visits AS (\n\tSELECT\n\t\teol.memberid,\n\t\teol.episode_start_date,\n\t\teol.episode_end_date,\n\t\tCASE\n\t\t\tWHEN ad.dateofservice IS NULL\n\t\t\t\tTHEN 0\n\t\t\tELSE 1\n\t\tEND AS icu_visit_count,\n\t\teol.memberdeathdate,\n\t\teol.participatingprovidernpi,\n\t\teol.perf_period_key,\n\t\teol.principalcancercode,\n\t\teol.cancerdiagnosisgroupcode,\n\t\teol.tin,\n\t\teol.lineofbusiness,\n\t\tad.dateofservice,\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY\n\t\t\t\teol.memberid\n\t\t\tORDER BY\n\t\t\t\ticu_visit_count DESC,\n\t\t\t\tad.dateofservice DESC\n\t\t) AS row_no\n\tFROM dev_dtx_gc.staging.stg_eol_members AS eol\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_member_admissions AS ad\n\t\t\tON eol.memberid = ad.memberid\n\t\t\t\tAND ad.claimlineplaceofservicecode = 21\n\t\t\t\tAND (\n\t\t\t\t\tad.claimlinerevenuecode >= 200\n\t\t\t\t\tAND ad.claimlinerevenuecode <= 209\n\t\t\t\t)\n\t\t\t\tAND ad.dateofservice >= eol.memberdeathdate - 30\n\t\t\t\tAND eol.memberdeathdate >= ad.dateofservice\n)\n\nSELECT\n\tiv.memberid,\n\t1 AS denominator,\n\tCASE\n\t\tWHEN iv.icu_visit_count = 0\n\t\t\tTHEN 1\n\t\tELSE 0\n\tEND AS numerator,\n\tiv.episode_start_date,\n\tiv.episode_end_date,\n\tiv.participatingprovidernpi,\n\tiv.perf_period_key,\n\tiv.principalcancercode,\n\tiv.cancerdiagnosisgroupcode,\n\tiv.tin,\n\tiv.lineofbusiness,\n\tiv.memberdeathdate,\n\tDATE_TRUNC(MONTH, iv.memberdeathdate) AS contextdate,\n\tiv.dateofservice AS lasticuvisitdate\nFROM icu_visits AS iv\nWHERE iv.row_no = 1",
    "raw_code": "{{ config( alias = 'stg_qm7', schema = 'staging') }}\r\n\r\n-- Denominator Logic:\r\n-- . Member attribution \r\n-- AND\r\n-- . Date of death\r\n-- Numerator Logic:\r\n/* This measure involves calculating an outcome to determine\r\n members did not have an ICU admission in the last 30 days\r\n  of life. \u201cPerformance Met\u201d for this numerator indicates the member\r\n  did not have an ICU admission in the last 30 days of life: indicating a high quality of care.\r\n*/\r\n\r\nWITH icu_visits AS (\r\n\tSELECT\r\n\t\teol.memberid,\r\n\t\teol.episode_start_date,\r\n\t\teol.episode_end_date,\r\n\t\tCASE\r\n\t\t\tWHEN ad.dateofservice IS NULL\r\n\t\t\t\tTHEN 0\r\n\t\t\tELSE 1\r\n\t\tEND AS icu_visit_count,\r\n\t\teol.memberdeathdate,\r\n\t\teol.participatingprovidernpi,\r\n\t\teol.perf_period_key,\r\n\t\teol.principalcancercode,\r\n\t\teol.cancerdiagnosisgroupcode,\r\n\t\teol.tin,\r\n\t\teol.lineofbusiness,\r\n\t\tad.dateofservice,\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY\r\n\t\t\t\teol.memberid\r\n\t\t\tORDER BY\r\n\t\t\t\ticu_visit_count DESC,\r\n\t\t\t\tad.dateofservice DESC\r\n\t\t) AS row_no\r\n\tFROM {{ ref('stg_eol_members') }} AS eol\r\n\t\tLEFT JOIN {{ ref('stg_member_admissions') }} AS ad\r\n\t\t\tON eol.memberid = ad.memberid\r\n\t\t\t\tAND ad.claimlineplaceofservicecode = 21\r\n\t\t\t\tAND (\r\n\t\t\t\t\tad.claimlinerevenuecode >= 200\r\n\t\t\t\t\tAND ad.claimlinerevenuecode <= 209\r\n\t\t\t\t)\r\n\t\t\t\tAND ad.dateofservice >= eol.memberdeathdate - 30\r\n\t\t\t\tAND eol.memberdeathdate >= ad.dateofservice\r\n)\r\n\r\nSELECT\r\n\tiv.memberid,\r\n\t1 AS denominator,\r\n\tCASE\r\n\t\tWHEN iv.icu_visit_count = 0\r\n\t\t\tTHEN 1\r\n\t\tELSE 0\r\n\tEND AS numerator,\r\n\tiv.episode_start_date,\r\n\tiv.episode_end_date,\r\n\tiv.participatingprovidernpi,\r\n\tiv.perf_period_key,\r\n\tiv.principalcancercode,\r\n\tiv.cancerdiagnosisgroupcode,\r\n\tiv.tin,\r\n\tiv.lineofbusiness,\r\n\tiv.memberdeathdate,\r\n\tDATE_TRUNC(MONTH, iv.memberdeathdate) AS contextdate,\r\n\tiv.dateofservice AS lasticuvisitdate\r\nFROM icu_visits AS iv\r\nWHERE iv.row_no = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_qm7",
    "description": "QM7 Informations",
    "columns": {
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NUMERATOR": {
        "name": "NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TIN": {
        "name": "TIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_eol_members",
        "model.anthem_dev.stg_member_admissions"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_qm8",
    "name": "stg_qm8",
    "original_file_path": "models\\staging\\stg_qm8.sql",
    "compiled_code": "\n\n-- Denominator Logic:\n-- . Member attribution \n-- AND\n-- . Date of death\n-- Numerator Logic:\n/* This measure involves calculating an outcome to determine\n members who utilized hospice during the measurement period.\n  \u201cPerformance Met\u201d for this numerator indicates the member utilized\n   hospice during the measurement period: indicating a high quality of care.\n*/\n\nWITH groupon            -- grouped continuous dates to each admission\nAS (\n\tSELECT\n\t\tem.memberid,\n\t\tem.memberdeathdate,\n\t\th.dateofservice,\n\t\th.dateofserviceend,\n\t\tDATEDIFF(\n\t\t\tDAY,\n\t\t\tMIN(h.dateofservice) OVER (PARTITION BY em.memberid),\n\t\t\th.dateofservice\n\t\t)\n\t\t- ROW_NUMBER() OVER (\n\t\t\tPARTITION BY em.memberid\n\t\t\tORDER BY h.dateofservice ASC\n\t\t) AS admissiongroup\n\tFROM dev_dtx_gc.staging.stg_eol_members AS em\n\t\tINNER JOIN dev_dtx_gc.staging.stg_hospice_members AS h\n\t\t\tON em.memberid = h.memberid AND em.lineofbusiness = h.lineofbusiness AND em.perf_period_key = h.perf_period_key\n)\n\n,\nlatesthospiceadmission              -- picking latest admission\nAS (\n\tSELECT\n\t\tmemberid,\n\t\tmemberdeathdate,\n\t\tdateofservice,\n\t\tdateofserviceend,\n\t\tadmissiongroup,\n\t\tRANK() OVER (\n\t\t\tPARTITION BY memberid\n\t\t\tORDER BY admissiongroup DESC\n\t\t) AS rank\n\tFROM groupon\n)\n\n,\nfinalqm8 AS (\n\tSELECT\n\t\tmemberid,\n\t\tmemberdeathdate,\n\t\t1 AS numerator,\n\t\tMIN(dateofservice) AS hospicestart,\n\t\tMAX(dateofserviceend) AS hospiceend,\n\t\tDATEDIFF(DAY, hospicestart, memberdeathdate) AS hospicedays\n\tFROM latesthospiceadmission\n\tWHERE rank = 1\n\tGROUP BY\n\t\tmemberid,\n\t\tmemberdeathdate\n)\n\nSELECT\n\tem.memberid,\n\t1 AS denominator,\n\tCOALESCE(h.numerator, 0) AS numerator,\n\tem.episode_start_date,\n\tem.episode_end_date,\n\tem.participatingprovidernpi,\n\tem.perf_period_key,\n\tem.principalcancercode,\n\tem.cancerdiagnosisgroupcode,\n\tem.tin,\n\tem.lineofbusiness,\n\tem.memberdeathdate,\n\tDATE_TRUNC(MONTH, em.memberdeathdate) AS contextdate,\n\th.hospicestart AS hospicedate,\n\th.hospiceend AS hospiceenddate\nFROM dev_dtx_gc.staging.stg_eol_members AS em\n\tLEFT OUTER JOIN finalqm8 AS h\n\t\tON em.memberid = h.memberid",
    "raw_code": "{{ config( alias = 'stg_qm8', schema = 'staging') }}\r\n\r\n-- Denominator Logic:\r\n-- . Member attribution \r\n-- AND\r\n-- . Date of death\r\n-- Numerator Logic:\r\n/* This measure involves calculating an outcome to determine\r\n members who utilized hospice during the measurement period.\r\n  \u201cPerformance Met\u201d for this numerator indicates the member utilized\r\n   hospice during the measurement period: indicating a high quality of care.\r\n*/\r\n\r\nWITH groupon            -- grouped continuous dates to each admission\r\nAS (\r\n\tSELECT\r\n\t\tem.memberid,\r\n\t\tem.memberdeathdate,\r\n\t\th.dateofservice,\r\n\t\th.dateofserviceend,\r\n\t\tDATEDIFF(\r\n\t\t\tDAY,\r\n\t\t\tMIN(h.dateofservice) OVER (PARTITION BY em.memberid),\r\n\t\t\th.dateofservice\r\n\t\t)\r\n\t\t- ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY em.memberid\r\n\t\t\tORDER BY h.dateofservice ASC\r\n\t\t) AS admissiongroup\r\n\tFROM {{ ref('stg_eol_members') }} AS em\r\n\t\tINNER JOIN {{ ref('stg_hospice_members') }} AS h\r\n\t\t\tON em.memberid = h.memberid AND em.lineofbusiness = h.lineofbusiness AND em.perf_period_key = h.perf_period_key\r\n)\r\n\r\n,\r\nlatesthospiceadmission              -- picking latest admission\r\nAS (\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\tmemberdeathdate,\r\n\t\tdateofservice,\r\n\t\tdateofserviceend,\r\n\t\tadmissiongroup,\r\n\t\tRANK() OVER (\r\n\t\t\tPARTITION BY memberid\r\n\t\t\tORDER BY admissiongroup DESC\r\n\t\t) AS rank\r\n\tFROM groupon\r\n)\r\n\r\n,\r\nfinalqm8 AS (\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\tmemberdeathdate,\r\n\t\t1 AS numerator,\r\n\t\tMIN(dateofservice) AS hospicestart,\r\n\t\tMAX(dateofserviceend) AS hospiceend,\r\n\t\tDATEDIFF(DAY, hospicestart, memberdeathdate) AS hospicedays\r\n\tFROM latesthospiceadmission\r\n\tWHERE rank = 1\r\n\tGROUP BY\r\n\t\tmemberid,\r\n\t\tmemberdeathdate\r\n)\r\n\r\nSELECT\r\n\tem.memberid,\r\n\t1 AS denominator,\r\n\tCOALESCE(h.numerator, 0) AS numerator,\r\n\tem.episode_start_date,\r\n\tem.episode_end_date,\r\n\tem.participatingprovidernpi,\r\n\tem.perf_period_key,\r\n\tem.principalcancercode,\r\n\tem.cancerdiagnosisgroupcode,\r\n\tem.tin,\r\n\tem.lineofbusiness,\r\n\tem.memberdeathdate,\r\n\tDATE_TRUNC(MONTH, em.memberdeathdate) AS contextdate,\r\n\th.hospicestart AS hospicedate,\r\n\th.hospiceend AS hospiceenddate\r\nFROM {{ ref('stg_eol_members') }} AS em\r\n\tLEFT OUTER JOIN finalqm8 AS h\r\n\t\tON em.memberid = h.memberid",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_qm8",
    "description": "QM8 Informations",
    "columns": {
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NUMERATOR": {
        "name": "NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TIN": {
        "name": "TIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_eol_members",
        "model.anthem_dev.stg_hospice_members"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_qm9",
    "name": "stg_qm9",
    "original_file_path": "models\\staging\\stg_qm9.sql",
    "compiled_code": "\n\n-- Denominator Logic:\n-- . Member attribution \n-- AND\n-- . Date of death\n-- Numerator Logic:\n-- This measure involves calculating an outcome to determine members who utilized hospice during the measurement period. \n-- \u201cPerformance Met\u201d for this numerator indicates the member was admitted to hospice >= 14 continuous days prior to death indicating a high quality of care.\n\nWITH groupon            -- grouped continuous dates to each admission\nAS (\n\tSELECT\n\t\tem.memberid,\n\t\tem.memberdeathdate,\n\t\th.dateofservice,\n\t\th.dateofserviceend,\n\t\tDATEDIFF(\n\t\t\tDAY,\n\t\t\tMIN(h.dateofservice) OVER (PARTITION BY em.memberid),\n\t\t\th.dateofservice\n\t\t)\n\t\t- ROW_NUMBER() OVER (\n\t\t\tPARTITION BY em.memberid\n\t\t\tORDER BY h.dateofservice ASC\n\t\t) AS admissiongroup\n\tFROM dev_dtx_gc.staging.stg_eol_members AS em\n\t\tINNER JOIN dev_dtx_gc.staging.stg_hospice_members AS h\n\t\t\tON em.memberid = h.memberid AND em.lineofbusiness = h.lineofbusiness AND em.perf_period_key = h.perf_period_key\n)\n\n,\nlatesthospiceadmission              -- picking latest admission\nAS (\n\tSELECT\n\t\tmemberid,\n\t\tmemberdeathdate,\n\t\tdateofservice,\n\t\tdateofserviceend,\n\t\tadmissiongroup,\n\t\tRANK() OVER (\n\t\t\tPARTITION BY memberid\n\t\t\tORDER BY admissiongroup DESC\n\t\t) AS rank\n\tFROM groupon\n)\n\n,\nfinalqm9 AS (\n\tSELECT\n\t\tmemberid,\n\t\tmemberdeathdate,\n\t\tMIN(dateofservice) AS hospicestart,\n\t\tMAX(dateofserviceend) AS hospiceend,\n\t\tDATEDIFF(DAY, hospicestart, memberdeathdate) AS hospicedays,\n\t\tCASE\n\t\t\tWHEN\n\t\t\t\thospicedays >= 14\n\t\t\t\tAND memberdeathdate <= hospiceend\n\t\t\t\tTHEN 1\n\t\t\tELSE 0\n\t\tEND AS numerator\n\tFROM latesthospiceadmission\n\tWHERE rank = 1\n\tGROUP BY\n\t\tmemberid,\n\t\tmemberdeathdate\n)\n\nSELECT\n\tem.memberid,\n\t1 AS denominator,\n\tCOALESCE(h.numerator, 0) AS numerator,\n\tem.episode_start_date,\n\tem.episode_end_date,\n\tem.participatingprovidernpi,\n\tem.perf_period_key,\n\tem.principalcancercode,\n\tem.cancerdiagnosisgroupcode,\n\tem.tin,\n\tem.lineofbusiness,\n\tem.memberdeathdate,\n\tDATE_TRUNC(MONTH, em.memberdeathdate) AS contextdate,\n\th.hospicestart AS lastnohospicedate,\n\th.hospiceend AS lastnohospiceenddate,\n\th.hospicedays AS daysinhospice\nFROM dev_dtx_gc.staging.stg_eol_members AS em\n\tLEFT OUTER JOIN finalqm9 AS h\n\t\tON em.memberid = h.memberid",
    "raw_code": "{{ config( alias = 'stg_qm9', schema = 'staging') }}\r\n\r\n-- Denominator Logic:\r\n-- . Member attribution \r\n-- AND\r\n-- . Date of death\r\n-- Numerator Logic:\r\n-- This measure involves calculating an outcome to determine members who utilized hospice during the measurement period. \r\n-- \u201cPerformance Met\u201d for this numerator indicates the member was admitted to hospice >= 14 continuous days prior to death indicating a high quality of care.\r\n\r\nWITH groupon            -- grouped continuous dates to each admission\r\nAS (\r\n\tSELECT\r\n\t\tem.memberid,\r\n\t\tem.memberdeathdate,\r\n\t\th.dateofservice,\r\n\t\th.dateofserviceend,\r\n\t\tDATEDIFF(\r\n\t\t\tDAY,\r\n\t\t\tMIN(h.dateofservice) OVER (PARTITION BY em.memberid),\r\n\t\t\th.dateofservice\r\n\t\t)\r\n\t\t- ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY em.memberid\r\n\t\t\tORDER BY h.dateofservice ASC\r\n\t\t) AS admissiongroup\r\n\tFROM {{ ref('stg_eol_members') }} AS em\r\n\t\tINNER JOIN {{ ref('stg_hospice_members') }} AS h\r\n\t\t\tON em.memberid = h.memberid AND em.lineofbusiness = h.lineofbusiness AND em.perf_period_key = h.perf_period_key\r\n)\r\n\r\n,\r\nlatesthospiceadmission              -- picking latest admission\r\nAS (\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\tmemberdeathdate,\r\n\t\tdateofservice,\r\n\t\tdateofserviceend,\r\n\t\tadmissiongroup,\r\n\t\tRANK() OVER (\r\n\t\t\tPARTITION BY memberid\r\n\t\t\tORDER BY admissiongroup DESC\r\n\t\t) AS rank\r\n\tFROM groupon\r\n)\r\n\r\n,\r\nfinalqm9 AS (\r\n\tSELECT\r\n\t\tmemberid,\r\n\t\tmemberdeathdate,\r\n\t\tMIN(dateofservice) AS hospicestart,\r\n\t\tMAX(dateofserviceend) AS hospiceend,\r\n\t\tDATEDIFF(DAY, hospicestart, memberdeathdate) AS hospicedays,\r\n\t\tCASE\r\n\t\t\tWHEN\r\n\t\t\t\thospicedays >= 14\r\n\t\t\t\tAND memberdeathdate <= hospiceend\r\n\t\t\t\tTHEN 1\r\n\t\t\tELSE 0\r\n\t\tEND AS numerator\r\n\tFROM latesthospiceadmission\r\n\tWHERE rank = 1\r\n\tGROUP BY\r\n\t\tmemberid,\r\n\t\tmemberdeathdate\r\n)\r\n\r\nSELECT\r\n\tem.memberid,\r\n\t1 AS denominator,\r\n\tCOALESCE(h.numerator, 0) AS numerator,\r\n\tem.episode_start_date,\r\n\tem.episode_end_date,\r\n\tem.participatingprovidernpi,\r\n\tem.perf_period_key,\r\n\tem.principalcancercode,\r\n\tem.cancerdiagnosisgroupcode,\r\n\tem.tin,\r\n\tem.lineofbusiness,\r\n\tem.memberdeathdate,\r\n\tDATE_TRUNC(MONTH, em.memberdeathdate) AS contextdate,\r\n\th.hospicestart AS lastnohospicedate,\r\n\th.hospiceend AS lastnohospiceenddate,\r\n\th.hospicedays AS daysinhospice\r\nFROM {{ ref('stg_eol_members') }} AS em\r\n\tLEFT OUTER JOIN finalqm9 AS h\r\n\t\tON em.memberid = h.memberid",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_qm9",
    "description": "QM9 Informations",
    "columns": {
      "DENOMINATOR": {
        "name": "DENOMINATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NUMERATOR": {
        "name": "NUMERATOR",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PERF_PERIOD_KEY": {
        "name": "PERF_PERIOD_KEY",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PARTICIPATINGPROVIDERNPI": {
        "name": "PARTICIPATINGPROVIDERNPI",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TIN": {
        "name": "TIN",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_eol_members",
        "model.anthem_dev.stg_hospice_members"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_quintile_legend",
    "name": "stg_quintile_legend",
    "original_file_path": "models\\staging\\stg_quintile_legend.sql",
    "compiled_code": "\n\nSELECT\n\tqmid,\n\t'Performance (Commercial)' AS type,\n\tqmname,\n\t'0% to ' || (quintile_1 * 100) || '%' AS quintile_1,\n\t(quintile_1 * 100)\n\t+ 0.01\n\t|| '% to '\n\t|| (quintile_2 * 100)\n\t|| '%' AS quintile_2,\n\t(quintile_2 * 100)\n\t+ 0.01\n\t|| '% to '\n\t|| (quintile_3 * 100)\n\t|| '%' AS quintile_3,\n\t(quintile_3 * 100)\n\t+ 0.01\n\t|| '% to '\n\t|| (quintile_4 * 100)\n\t|| '%' AS quintile_4,\n\t(quintile_4 * 100)\n\t+ 0.01\n\t|| '% to '\n\t|| (quintile_5 * 100)\n\t|| '%' AS quintile_5\nFROM dev_dtx_gc.staging.stg_seed_quality_measures\nWHERE qmid IN (1, 2, 3, 4, 14)\n\nUNION ALL\n\nSELECT\n\tqmid,\n\t'Performance (Medicare Advantage)' AS type,\n\tqmname,\n\t'0% to ' || (quintile_1_ma * 100) || '%' AS quintile_1,\n\t(quintile_1_ma * 100)\n\t+ 0.01\n\t|| '% to '\n\t|| (quintile_2_ma * 100)\n\t|| '%' AS quintile_2,\n\t(quintile_2_ma * 100)\n\t+ 0.01\n\t|| '% to '\n\t|| (quintile_3_ma * 100)\n\t|| '%' AS quintile_3,\n\t(quintile_3_ma * 100)\n\t+ 0.01\n\t|| '% to '\n\t|| (quintile_4_ma * 100)\n\t|| '%' AS quintile_4,\n\t(quintile_4_ma * 100)\n\t+ 0.01\n\t|| '% to '\n\t|| (quintile_5_ma * 100)\n\t|| '%' AS quintile_5\nFROM dev_dtx_gc.staging.stg_seed_quality_measures\nWHERE qmid IN (1, 2, 3, 4, 14)\n\nUNION ALL\n\nSELECT\n\tqmid,\n\t'Points' AS type,\n\tqmname,\n\tTO_VARCHAR(group1score) AS quintile_1,\n\tTO_VARCHAR(group2score) AS quintile_2,\n\tTO_VARCHAR(group3score) AS quintile_3,\n\tTO_VARCHAR(group4score) AS quintile_4,\n\tTO_VARCHAR(group5score) AS quintile_5\nFROM dev_dtx_gc.staging.stg_seed_quality_measures\nWHERE qmid IN (1, 2, 3, 4, 14)",
    "raw_code": "{{ config( alias = 'stg_quintile_legend', schema = 'staging') }}\r\n\r\nSELECT\r\n\tqmid,\r\n\t'Performance (Commercial)' AS type,\r\n\tqmname,\r\n\t'0% to ' || (quintile_1 * 100) || '%' AS quintile_1,\r\n\t(quintile_1 * 100)\r\n\t+ 0.01\r\n\t|| '% to '\r\n\t|| (quintile_2 * 100)\r\n\t|| '%' AS quintile_2,\r\n\t(quintile_2 * 100)\r\n\t+ 0.01\r\n\t|| '% to '\r\n\t|| (quintile_3 * 100)\r\n\t|| '%' AS quintile_3,\r\n\t(quintile_3 * 100)\r\n\t+ 0.01\r\n\t|| '% to '\r\n\t|| (quintile_4 * 100)\r\n\t|| '%' AS quintile_4,\r\n\t(quintile_4 * 100)\r\n\t+ 0.01\r\n\t|| '% to '\r\n\t|| (quintile_5 * 100)\r\n\t|| '%' AS quintile_5\r\nFROM {{ ref('stg_seed_quality_measures') }}\r\nWHERE qmid IN (1, 2, 3, 4, 14)\r\n\r\nUNION ALL\r\n\r\nSELECT\r\n\tqmid,\r\n\t'Performance (Medicare Advantage)' AS type,\r\n\tqmname,\r\n\t'0% to ' || (quintile_1_ma * 100) || '%' AS quintile_1,\r\n\t(quintile_1_ma * 100)\r\n\t+ 0.01\r\n\t|| '% to '\r\n\t|| (quintile_2_ma * 100)\r\n\t|| '%' AS quintile_2,\r\n\t(quintile_2_ma * 100)\r\n\t+ 0.01\r\n\t|| '% to '\r\n\t|| (quintile_3_ma * 100)\r\n\t|| '%' AS quintile_3,\r\n\t(quintile_3_ma * 100)\r\n\t+ 0.01\r\n\t|| '% to '\r\n\t|| (quintile_4_ma * 100)\r\n\t|| '%' AS quintile_4,\r\n\t(quintile_4_ma * 100)\r\n\t+ 0.01\r\n\t|| '% to '\r\n\t|| (quintile_5_ma * 100)\r\n\t|| '%' AS quintile_5\r\nFROM {{ ref('stg_seed_quality_measures') }}\r\nWHERE qmid IN (1, 2, 3, 4, 14)\r\n\r\nUNION ALL\r\n\r\nSELECT\r\n\tqmid,\r\n\t'Points' AS type,\r\n\tqmname,\r\n\tTO_VARCHAR(group1score) AS quintile_1,\r\n\tTO_VARCHAR(group2score) AS quintile_2,\r\n\tTO_VARCHAR(group3score) AS quintile_3,\r\n\tTO_VARCHAR(group4score) AS quintile_4,\r\n\tTO_VARCHAR(group5score) AS quintile_5\r\nFROM {{ ref('stg_seed_quality_measures') }}\r\nWHERE qmid IN (1, 2, 3, 4, 14)",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_quintile_legend",
    "description": "Quintile details for Hovering functionality",
    "columns": {
      "QMID": {
        "name": "QMID",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QMNAME": {
        "name": "QMNAME",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TYPE": {
        "name": "TYPE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QUINTILE_1": {
        "name": "QUINTILE_1",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QUINTILE_2": {
        "name": "QUINTILE_2",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QUINTILE_3": {
        "name": "QUINTILE_3",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QUINTILE_4": {
        "name": "QUINTILE_4",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QUINTILE_5": {
        "name": "QUINTILE_5",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_seed_quality_measures"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_recon",
    "name": "stg_recon",
    "original_file_path": "models\\staging\\stg_recon.sql",
    "compiled_code": "\n\nWITH recon_source AS (\n\n\tSELECT *\n\tFROM dev_dtx_gc.staging.stg_ic1_recon_source\n\n),\n\nrecon_population AS (\n\t-- This CTE will get the memberid from recon and the mapped TIN from the Seed file    \n\tSELECT\n\t\tmt.memberid,\n\t\tmt.attributedprovidertaxid,\n\t\tmt.performanceperiodstartdate,\n\t\tmt.performanceperiodenddate,\n\t\tmt.participatingprovidernpinumber,\n\t\tmb.membername AS patientname,\n\t\tmb.memberbirthdate AS patientbirthdate,\n\t\tmb.memberrace AS patientracetext,\n\t\tmb.subscriberid,\n\t\tpp.perf_period_key,\n\t\tmt.episodename AS cancer_type,\n\t\tCASE\n\t\t\tWHEN mb.memberbirthdate < CURRENT_DATE()\n\t\t\t\tTHEN FLOOR(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tDATEDIFF(MONTH, mb.memberbirthdate, CURRENT_DATE())\n\t\t\t\t\t\t\t-\n\t\t\t\t\t\t\tTO_NUMERIC(\n\t\t\t\t\t\t\t\tDATE_PART(DAY, CURRENT_DATE())\n\t\t\t\t\t\t\t\t< DATE_PART(DAY, mb.memberbirthdate)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) / 12\n\t\t\t\t\t)\n\t\tEND AS patientagevalue,\n\t\tCASE\n\t\t\tWHEN mb.membergendercode = 'M' THEN 'MALE'\n\t\t\tWHEN mb.membergendercode = 'F' THEN 'FEMALE'\n\t\t\tELSE 'UNKNOWN'\n\t\tEND AS patientgendertext,\n\t\tCOALESCE(c.icd10code, 'N/A') AS cancerdiagnosisgroupcode\n\tFROM recon_source AS mt\n\t\tINNER JOIN dev_dtx_gc.staging.STG_MEMBER AS mb\n\t\t\tON mt.memberid = mb.memberid\n\t\tLEFT JOIN dev_dtx_gc.staging.stg_seed_ocm_cancer_types AS c\n\t\t\t-- all by two cancertypes match\n\t\t\tON mt.episodename = REPLACE(c.cancer_type, ',', '')\n\t\tINNER JOIN dev_dtx_gc.staging.stg_seed_performance_period AS pp\n\t\t\tON\n\t\t\t\tmt.performanceperiodstartdate BETWEEN pp.perf_period_start_date AND pp.perf_period_end_date\n\n\tQUALIFY\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY mt.memberid, mt.performanceperiodstartdate\n\t\t\tORDER BY c.icd10code\n\t\t) = 1\n\n),\n\nattributedprovider AS (\n\tSELECT\n\t\tr.memberid,\n\t\tr.attributedprovidertaxid,\n\t\ta.attributednpiproviderid AS participatingprovidernpinumber\n\tFROM recon_population AS r\n\t\tLEFT JOIN dev_dtx_gc.IC1.ATTRIBUTION AS a\n\t\t\tON r.memberid = a.memberid\n\n\tQUALIFY ROW_NUMBER() OVER (\n\t\t\tPARTITION BY r.memberid, r.attributedprovidertaxid\n\t\t\tORDER BY\n\t\t\t\tIFF(r.attributedprovidertaxid = a.attributedprovidertaxid, 1, 2),\n\t\t\t\ta.attributednpiproviderid\n\t\t) = 1\n\n),\n\nrecon_population_with_provider AS (\n\tSELECT\n\t\tr.memberid,\n\t\tr.attributedprovidertaxid,\n\t\tr.performanceperiodstartdate,\n\t\tr.performanceperiodenddate,\n\t\ta.participatingprovidernpinumber,\n\t\tr.patientname,\n\t\tr.patientbirthdate,\n\t\tr.patientagevalue,\n\t\tr.patientgendertext,\n\t\tr.patientracetext,\n\t\tr.subscriberid,\n\t\tr.perf_period_key,\n\t\tr.cancer_type,\n\t\tr.cancerdiagnosisgroupcode\n\tFROM recon_population AS r\n\t\tLEFT JOIN attributedprovider AS a\n\t\t\tON\n\t\t\t\tr.memberid = a.memberid\n\t\t\t\tAND r.attributedprovidertaxid = a.attributedprovidertaxid\n)\n\nSELECT\n\tp.memberid,\n\ta.perf_period_key,\n\ta.subscriberid,\n\tp.filerunid,\n\tp.contractid,\n\tp.lineofbusinessidentifier AS lob,\n\tp.administrativetaxidnumber,\n\tp.contractstatecode,\n\tp.performanceperiodstartdate,\n\tp.performanceperiodenddate,\n\tp.contractperiodstartdate,\n\tp.contractperiodenddate,\n\tp.programid,\n\tp.providergroupingidentifier,\n\tp.contractname,\n\tp.episodecount,\n\tp.budgetamount,\n\tp.trenddescription,\n\tp.noveladjustmentdescription,\n\tp.benchmarkpriceamount,\n\tp.administrativediscountpercent,\n\tp.targetpriceamount,\n\tp.totalallowedactualcostamount,\n\tp.episodeactualtotargetdifferenceamount,\n\tp.sharedsavingspercent,\n\tp.savingspoolamount,\n\tp.sharedsavingsmultipliervalue,\n\tp.sharedsavingsexpenseamount,\n\tp.episodeid,\n\ta.participatingprovidernpinumber,\n\ta.attributedprovidertaxid,\n\t--participatingprovidername from Dim_Participating_Provider\n\ta.patientname,\n\ta.patientbirthdate,\n\ta.patientagevalue,\n\ta.patientgendertext,\n\ta.patientracetext,\n\tp.patientstatename,\n\ta.cancerdiagnosisgroupcode AS cancerdiagnosiscode,\n\ta.cancer_type AS cancerdiagnosisdescriptiontext,\n\tp.timeperioddates,\n\tp.episodename AS cancertype,\n\tp.qm1code,\n\tp.qm1performanceratevalue,\n\tp.qm1numeratorvalue,\n\tp.qm1denominatorvalue,\n\tp.qm2code,\n\tp.qm2performanceratevalue,\n\tp.qm2numeratorvalue,\n\tp.qm2denominatorvalue,\n\tp.qm3code,\n\tp.qm3performanceratevalue,\n\tp.qm3numeratorvalue,\n\tp.qm3denominatorvalue,\n\tp.qm4code,\n\tp.qm4performanceratevalue,\n\tp.qm4numeratorvalue,\n\tp.qm4denominatorvalue,\n\tp.qm5code,\n\tp.qm5pointsvalue,\n\tp.qm5performanceratevalue,\n\tp.qm5numeratorvalue,\n\tp.qm5denominatorvalue,\n\tp.qm6code,\n\tp.qm6pointsvalue,\n\tp.qm6performanceratevalue,\n\tp.qm6numeratorvalue,\n\tp.qm6denominatorvalue,\n\tp.qm7code,\n\tp.qm7pointsvalue,\n\tp.qm7performanceratevalue,\n\tp.qm7numeratorvalue,\n\tp.qm7denominatorvalue,\n\tp.qm8code,\n\tp.qm8pointsvalue,\n\tp.qm8performanceratevalue,\n\tp.qm8numeratorvalue,\n\tp.qm8denominatorvalue,\n\tp.qm9code,\n\tp.qm9pointsvalue,\n\tp.qm9performanceratevalue,\n\tp.qm9numeratorvalue,\n\tp.qm9denominatorvalue,\n\tp.qm10code,\n\tp.qm10pointsvalue,\n\tp.qm10performanceratevalue,\n\tp.qm10numeratorvalue,\n\tp.qm10denominatorvalue,\n\tp.qm11code,\n\tp.qm11pointsvalue,\n\tp.qm11performanceratevalue,\n\tp.qm11numeratorvalue,\n\tp.qm11denominatorvalue,\n\tp.qmtotalpointsvalue,\n\tCOALESCE(p.qm1pointsvalue, 0) AS qm1pointsvalue,\n\tCOALESCE(p.qm2pointsvalue, 0) AS qm2pointsvalue,\n\tCOALESCE(p.qm3pointsvalue, 0) AS qm3pointsvalue,\n\tCOALESCE(p.qm4pointsvalue, 0) AS qm4pointsvalue,\n\tCOALESCE(p.qmaggregatequalityscorevalue, 0) AS qmaggregatequalityscorevalue,\n\thm.ishospicemember,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tCONCAT(p.memberid, '_', a.attributedprovidertaxid)\n\t\tAS memberid_attributedtin,\n\tCONCAT(\n\t\tCOALESCE(TO_VARCHAR(a.participatingprovidernpinumber), ''),\n\t\t'_',\n\t\ta.attributedprovidertaxid\n\t) AS participatingnpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\n\t\tp.all_other_medical,\n\t\tp.all_other_medical_count,\n\t\tp.amb_surg,\n\t\tp.amb_surg_count,\n\t\tp.attributed_oncologist,\n\t\tp.avoid_ed_ane_allowed,\n\t\tp.avoid_ed_ane_count,\n\t\tp.avoid_ed_deh_allowed,\n\t\tp.avoid_ed_deh_count,\n\t\tp.avoid_ed_die_allowed,\n\t\tp.avoid_ed_die_count,\n\t\tp.avoid_ed_eme_allowed,\n\t\tp.avoid_ed_eme_count,\n\t\tp.avoid_ed_fev_allowed,\n\t\tp.avoid_ed_fev_count,\n\t\tp.avoid_ed_nau_allowed,\n\t\tp.avoid_ed_nau_count,\n\t\tp.avoid_ed_neu_allowed,\n\t\tp.avoid_ed_neu_count,\n\t\tp.avoid_ed_pai_allowed,\n\t\tp.avoid_ed_pai_count,\n\t\tp.avoid_ed_pne_allowed,\n\t\tp.avoid_ed_pne_count,\n\t\tp.avoid_ed_sep_allowed,\n\t\tp.avoid_ed_sep_count,\n\t\tp.avoid_ip_ane_allowed,\n\t\tp.avoid_ip_deh_allowed,\n\t\tp.avoid_ip_deh_count,\n\t\tp.avoid_ip_die_allowed,\n\t\tp.avoid_ip_die_count,\n\t\tp.avoid_ip_eme_allowed,\n\t\tp.avoid_ip_eme_count,\n\t\tp.avoid_ip_fev_allowed,\n\t\tp.avoid_ip_fev_count,\n\t\tp.avoid_ip_nau_allowed,\n\t\tp.avoid_ip_nau_count,\n\t\tp.avoid_ip_neu_allowed,\n\t\tp.avoid_ip_neu_count,\n\t\tp.avoid_ip_pai_allowed,\n\t\tp.avoid_ip_pai_count,\n\t\tp.avoid_ip_pne_allowed,\n\t\tp.avoid_ip_pne_count,\n\t\tp.avoid_ip_sep_allowed,\n\t\tp.avoid_ip_sep_count,\n\t\tp.avoidable_admits_allowed,\n\t\tp.avoidable_ed_allowed,\n\t\tp.avoidable_ed_count,\n\t\tp.birth_date,\n\t\tp.ccf_paid,\n\t\tp.chemo_allowed,\n\t\tp.chemo_count,\n\t\tp.chemo_drugs_medical,\n\t\tp.chemo_drugs_medical_count,\n\t\tp.chemotherapy_type,\n\t\tp.dod,\n\t\tp.ed_allowed,\n\t\tp.ed_visits,\n\t\tp.emergencyroomtotalvisits,\n\t\tp.eol_chemo_allowed,\n\t\tp.eol_chemo_count,\n\t\tp.eol_ed_allowed,\n\t\tp.eol_ed_visits,\n\t\tp.eol_icu_allowed,\n\t\tp.eol_icu_count,\n\t\tp.episode_end_date,\n\t\tp.episode_start_date,\n\t\tp.er,\n\t\tp.er_count,\n\t\tp.gender,\n\t\tp.home,\n\t\tp.inpatient,\n\t\tp.home_count,\n\t\tp.hospice_allowed,\n\t\tp.hospice_claim_admits,\n\t\tp.hospice_los,\n\t\tp.icu_allowed,\n\t\tp.icu_claim_admits,\n\t\tp.icu_los,\n\t\tp.inpatient__all_other_inpatient,\n\t\tp.inpatient__cardiology,\n\t\tp.inpatient__detailed_coded_drugs,\n\t\tp.inpatient__emergency_room,\n\t\tp.inpatient__icu,\n\t\tp.inpatient__imaging,\n\t\tp.inpatient__lab_pathology,\n\t\tp.inpatient__med_surg_supplies,\n\t\tp.inpatient__operation,\n\t\tp.inpatient__pharmacy,\n\t\tp.inpatient__other,\n\t\tp.inpatient__radiation_therapy,\n\t\tp.inpatient__respiratory_pt_ot_st,\n\t\tp.inpatient__room_and_board,\n\t\tp.inpatient_count,\n\t\tp.inpatient_count__all_other_inpatient,\n\t\tp.inpatient_count__cardiology,\n\t\tp.inpatient_count__detailed_coded_drugs,\n\t\tp.inpatient_count__emergency_room,\n\t\tp.inpatient_count__icu,\n\t\tp.inpatient_count__imaging,\n\t\tp.inpatient_count__lab_pathology,\n\t\tp.inpatient_count__med_surg_supplies,\n\t\tp.inpatient_count__operation,\n\t\tp.inpatient_count__other,\n\t\tp.inpatient_count__pharmacy,\n\t\tp.inpatient_count__radiation_therapy,\n\t\tp.inpatient_count__respiratory_pt_ot_st,\n\t\tp.inpatient_count__room_and_board,\n\t\tp.avoidable_admits_count,\n\t\tp.inpatient_drugs_requiring_coding,\n\t\tp.avoid_ip_ane_count,\n\t\tp.ip_allowed,\n\t\tp.ip_claim_admits,\n\t\tp.ip_clusters,\n\t\tp.ip_los,\n\t\tp.lab,\n\t\tp.lab_count,\n\t\tp.min_risk_corridor,\n\t\tp.novel_allowed,\n\t\tp.office,\n\t\tp.office__all_other_office,\n\t\tp.office__cardiovascular_procedures,\n\t\tp.office__drug_admin,\n\t\tp.office__e_and_m,\n\t\tp.office__radioactive_agents,\n\t\tp.office__other,\n\t\tp.office__radiology_mammography,\n\t\tp.office__pathology_and_lab,\n\t\tp.office__psychiatry,\n\t\tp.office__radiation_treatment,\n\t\tp.office__radiology_diagnostic,\n\t\tp.office__radiology_guidance,\n\t\tp.office__radiology_nuclear_medicine,\n\t\tp.office__radiology_other,\n\t\tp.office__radiology_rad_onc_treatment,\n\t\tp.office__surgery,\n\t\tp.office__therapeutic_activities,\n\t\tp.office_count,\n\t\tp.office_count__all_other_office,\n\t\tp.office_count__cardiovascular_procedures,\n\t\tp.office_count__drug_admin,\n\t\tp.office_count__e_and_m,\n\t\tp.office_count__other,\n\t\tp.office_count__pathology_and_lab,\n\t\tp.office_count__psychiatry,\n\t\tp.office_count__radiation_treatment,\n\t\tp.office_count__radioactive_agents,\n\t\tp.office_count__radiology_diagnostic,\n\t\tp.office_count__radiology_guidance,\n\t\tp.office_count__radiology_mammography,\n\t\tp.office_count__radiology_nuclear_medicine,\n\t\tp.office_count__radiology_other,\n\t\tp.office_count__radiology_rad_onc_treatment,\n\t\tp.office_count__surgery,\n\t\tp.office_count__therapeutic_activities,\n\t\tp.operating_room_services_count,\n\t\tp.outpatient,\n\t\tp.outpatient__all_other_outpatient,\n\t\tp.outpatient__chemo_admin,\n\t\tp.outpatient__detailed_coded_drugs,\n\t\tp.outpatient__gastrointestinal,\n\t\tp.outpatient__imaging,\n\t\tp.outpatient__iv_therapy,\n\t\tp.outpatient__lab_pathology,\n\t\tp.outpatient__med_surg_supplies,\n\t\tp.outpatient__nuclear_medicine,\n\t\tp.outpatient__operation,\n\t\tp.outpatient__other,\n\t\tp.outpatient__pharmacy,\n\t\tp.outpatient__radiation_therapy,\n\t\tp.outpatient_count,\n\t\tp.outpatient_count__all_other_outpatient,\n\t\tp.outpatient_count__chemo_admin,\n\t\tp.outpatient_count__detailed_coded_drugs,\n\t\tp.outpatient_count__gastrointestinal,\n\t\tp.outpatient_count__imaging,\n\t\tp.outpatient_count__iv_therapy,\n\t\tp.outpatient_count__lab_pathology,\n\t\tp.outpatient_count__med_surg_supplies,\n\t\tp.outpatient_count__nuclear_medicine,\n\t\tp.outpatient_count__operation,\n\t\tp.outpatient_count__other,\n\t\tp.outpatient_count__pharmacy,\n\t\tp.outpatient_count__radiation_therapy,\n\t\tp.practice,\n\t\tp.prediction,\n\t\tp.retail_pharm,\n\t\tp.retail_pharm_count,\n\t\tp.ssav_expns_amt_no_cap,\n\t\tp.telehealth,\n\t\tp.telehealth_count,\n\t\tp.total_allowed_wind,\n\t\tp.totalallowedamtcostall,\n\t\tp.transportation,\n\t\tp.transportation_count,\n\t\tp.uc,\n\t\tp.uc_count\nFROM recon_source AS p\n\tINNER JOIN recon_population_with_provider AS a\n\t\tON\n\t\t\tp.memberid = a.memberid\n\t\t\tAND p.performanceperiodstartdate = a.performanceperiodstartdate\n\tLEFT JOIN\n\t\tdev_dtx_gc.staging.stg_member_hospice_mapping AS hm\n\t\tON p.memberid = hm.memberid AND a.perf_period_key = hm.perf_period_key AND p.lineofbusinessidentifier = hm.lineofbusiness\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON a.attributedprovidertaxid = map.tin",
    "raw_code": "{{ config( alias = 'stg_recon', schema = 'staging') }}\r\n\r\nWITH recon_source AS (\r\n\r\n\tSELECT *\r\n\tFROM {{ ref(\"stg_ic1_recon_source\") }}\r\n\r\n),\r\n\r\nrecon_population AS (\r\n\t-- This CTE will get the memberid from recon and the mapped TIN from the Seed file    \r\n\tSELECT\r\n\t\tmt.memberid,\r\n\t\tmt.attributedprovidertaxid,\r\n\t\tmt.performanceperiodstartdate,\r\n\t\tmt.performanceperiodenddate,\r\n\t\tmt.participatingprovidernpinumber,\r\n\t\tmb.membername AS patientname,\r\n\t\tmb.memberbirthdate AS patientbirthdate,\r\n\t\tmb.memberrace AS patientracetext,\r\n\t\tmb.subscriberid,\r\n\t\tpp.perf_period_key,\r\n\t\tmt.episodename AS cancer_type,\r\n\t\tCASE\r\n\t\t\tWHEN mb.memberbirthdate < CURRENT_DATE()\r\n\t\t\t\tTHEN FLOOR(\r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\tDATEDIFF(MONTH, mb.memberbirthdate, CURRENT_DATE())\r\n\t\t\t\t\t\t\t-\r\n\t\t\t\t\t\t\tTO_NUMERIC(\r\n\t\t\t\t\t\t\t\tDATE_PART(DAY, CURRENT_DATE())\r\n\t\t\t\t\t\t\t\t< DATE_PART(DAY, mb.memberbirthdate)\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t) / 12\r\n\t\t\t\t\t)\r\n\t\tEND AS patientagevalue,\r\n\t\tCASE\r\n\t\t\tWHEN mb.membergendercode = 'M' THEN 'MALE'\r\n\t\t\tWHEN mb.membergendercode = 'F' THEN 'FEMALE'\r\n\t\t\tELSE 'UNKNOWN'\r\n\t\tEND AS patientgendertext,\r\n\t\tCOALESCE(c.icd10code, 'N/A') AS cancerdiagnosisgroupcode\r\n\tFROM recon_source AS mt\r\n\t\tINNER JOIN {{ ref('stg_member') }} AS mb\r\n\t\t\tON mt.memberid = mb.memberid\r\n\t\tLEFT JOIN {{ ref('stg_seed_ocm_cancer_types') }} AS c\r\n\t\t\t-- all by two cancertypes match\r\n\t\t\tON mt.episodename = REPLACE(c.cancer_type, ',', '')\r\n\t\tINNER JOIN {{ ref('stg_seed_performance_period') }} AS pp\r\n\t\t\tON\r\n\t\t\t\tmt.performanceperiodstartdate BETWEEN pp.perf_period_start_date AND pp.perf_period_end_date\r\n\r\n\tQUALIFY\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY mt.memberid, mt.performanceperiodstartdate\r\n\t\t\tORDER BY c.icd10code\r\n\t\t) = 1\r\n\r\n),\r\n\r\nattributedprovider AS (\r\n\tSELECT\r\n\t\tr.memberid,\r\n\t\tr.attributedprovidertaxid,\r\n\t\ta.attributednpiproviderid AS participatingprovidernpinumber\r\n\tFROM recon_population AS r\r\n\t\tLEFT JOIN {{ source(\"IC1\",\"ATTRIBUTION\") }} AS a\r\n\t\t\tON r.memberid = a.memberid\r\n\r\n\tQUALIFY ROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY r.memberid, r.attributedprovidertaxid\r\n\t\t\tORDER BY\r\n\t\t\t\tIFF(r.attributedprovidertaxid = a.attributedprovidertaxid, 1, 2),\r\n\t\t\t\ta.attributednpiproviderid\r\n\t\t) = 1\r\n\r\n),\r\n\r\nrecon_population_with_provider AS (\r\n\tSELECT\r\n\t\tr.memberid,\r\n\t\tr.attributedprovidertaxid,\r\n\t\tr.performanceperiodstartdate,\r\n\t\tr.performanceperiodenddate,\r\n\t\ta.participatingprovidernpinumber,\r\n\t\tr.patientname,\r\n\t\tr.patientbirthdate,\r\n\t\tr.patientagevalue,\r\n\t\tr.patientgendertext,\r\n\t\tr.patientracetext,\r\n\t\tr.subscriberid,\r\n\t\tr.perf_period_key,\r\n\t\tr.cancer_type,\r\n\t\tr.cancerdiagnosisgroupcode\r\n\tFROM recon_population AS r\r\n\t\tLEFT JOIN attributedprovider AS a\r\n\t\t\tON\r\n\t\t\t\tr.memberid = a.memberid\r\n\t\t\t\tAND r.attributedprovidertaxid = a.attributedprovidertaxid\r\n)\r\n\r\nSELECT\r\n\tp.memberid,\r\n\ta.perf_period_key,\r\n\ta.subscriberid,\r\n\tp.filerunid,\r\n\tp.contractid,\r\n\tp.lineofbusinessidentifier AS lob,\r\n\tp.administrativetaxidnumber,\r\n\tp.contractstatecode,\r\n\tp.performanceperiodstartdate,\r\n\tp.performanceperiodenddate,\r\n\tp.contractperiodstartdate,\r\n\tp.contractperiodenddate,\r\n\tp.programid,\r\n\tp.providergroupingidentifier,\r\n\tp.contractname,\r\n\tp.episodecount,\r\n\tp.budgetamount,\r\n\tp.trenddescription,\r\n\tp.noveladjustmentdescription,\r\n\tp.benchmarkpriceamount,\r\n\tp.administrativediscountpercent,\r\n\tp.targetpriceamount,\r\n\tp.totalallowedactualcostamount,\r\n\tp.episodeactualtotargetdifferenceamount,\r\n\tp.sharedsavingspercent,\r\n\tp.savingspoolamount,\r\n\tp.sharedsavingsmultipliervalue,\r\n\tp.sharedsavingsexpenseamount,\r\n\tp.episodeid,\r\n\ta.participatingprovidernpinumber,\r\n\ta.attributedprovidertaxid,\r\n\t--participatingprovidername from Dim_Participating_Provider\r\n\ta.patientname,\r\n\ta.patientbirthdate,\r\n\ta.patientagevalue,\r\n\ta.patientgendertext,\r\n\ta.patientracetext,\r\n\tp.patientstatename,\r\n\ta.cancerdiagnosisgroupcode AS cancerdiagnosiscode,\r\n\ta.cancer_type AS cancerdiagnosisdescriptiontext,\r\n\tp.timeperioddates,\r\n\tp.episodename AS cancertype,\r\n\tp.qm1code,\r\n\tp.qm1performanceratevalue,\r\n\tp.qm1numeratorvalue,\r\n\tp.qm1denominatorvalue,\r\n\tp.qm2code,\r\n\tp.qm2performanceratevalue,\r\n\tp.qm2numeratorvalue,\r\n\tp.qm2denominatorvalue,\r\n\tp.qm3code,\r\n\tp.qm3performanceratevalue,\r\n\tp.qm3numeratorvalue,\r\n\tp.qm3denominatorvalue,\r\n\tp.qm4code,\r\n\tp.qm4performanceratevalue,\r\n\tp.qm4numeratorvalue,\r\n\tp.qm4denominatorvalue,\r\n\tp.qm5code,\r\n\tp.qm5pointsvalue,\r\n\tp.qm5performanceratevalue,\r\n\tp.qm5numeratorvalue,\r\n\tp.qm5denominatorvalue,\r\n\tp.qm6code,\r\n\tp.qm6pointsvalue,\r\n\tp.qm6performanceratevalue,\r\n\tp.qm6numeratorvalue,\r\n\tp.qm6denominatorvalue,\r\n\tp.qm7code,\r\n\tp.qm7pointsvalue,\r\n\tp.qm7performanceratevalue,\r\n\tp.qm7numeratorvalue,\r\n\tp.qm7denominatorvalue,\r\n\tp.qm8code,\r\n\tp.qm8pointsvalue,\r\n\tp.qm8performanceratevalue,\r\n\tp.qm8numeratorvalue,\r\n\tp.qm8denominatorvalue,\r\n\tp.qm9code,\r\n\tp.qm9pointsvalue,\r\n\tp.qm9performanceratevalue,\r\n\tp.qm9numeratorvalue,\r\n\tp.qm9denominatorvalue,\r\n\tp.qm10code,\r\n\tp.qm10pointsvalue,\r\n\tp.qm10performanceratevalue,\r\n\tp.qm10numeratorvalue,\r\n\tp.qm10denominatorvalue,\r\n\tp.qm11code,\r\n\tp.qm11pointsvalue,\r\n\tp.qm11performanceratevalue,\r\n\tp.qm11numeratorvalue,\r\n\tp.qm11denominatorvalue,\r\n\tp.qmtotalpointsvalue,\r\n\tCOALESCE(p.qm1pointsvalue, 0) AS qm1pointsvalue,\r\n\tCOALESCE(p.qm2pointsvalue, 0) AS qm2pointsvalue,\r\n\tCOALESCE(p.qm3pointsvalue, 0) AS qm3pointsvalue,\r\n\tCOALESCE(p.qm4pointsvalue, 0) AS qm4pointsvalue,\r\n\tCOALESCE(p.qmaggregatequalityscorevalue, 0) AS qmaggregatequalityscorevalue,\r\n\thm.ishospicemember,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tCONCAT(p.memberid, '_', a.attributedprovidertaxid)\r\n\t\tAS memberid_attributedtin,\r\n\tCONCAT(\r\n\t\tCOALESCE(TO_VARCHAR(a.participatingprovidernpinumber), ''),\r\n\t\t'_',\r\n\t\ta.attributedprovidertaxid\r\n\t) AS participatingnpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc,\r\n\t\tp.all_other_medical,\r\n\t\tp.all_other_medical_count,\r\n\t\tp.amb_surg,\r\n\t\tp.amb_surg_count,\r\n\t\tp.attributed_oncologist,\r\n\t\tp.avoid_ed_ane_allowed,\r\n\t\tp.avoid_ed_ane_count,\r\n\t\tp.avoid_ed_deh_allowed,\r\n\t\tp.avoid_ed_deh_count,\r\n\t\tp.avoid_ed_die_allowed,\r\n\t\tp.avoid_ed_die_count,\r\n\t\tp.avoid_ed_eme_allowed,\r\n\t\tp.avoid_ed_eme_count,\r\n\t\tp.avoid_ed_fev_allowed,\r\n\t\tp.avoid_ed_fev_count,\r\n\t\tp.avoid_ed_nau_allowed,\r\n\t\tp.avoid_ed_nau_count,\r\n\t\tp.avoid_ed_neu_allowed,\r\n\t\tp.avoid_ed_neu_count,\r\n\t\tp.avoid_ed_pai_allowed,\r\n\t\tp.avoid_ed_pai_count,\r\n\t\tp.avoid_ed_pne_allowed,\r\n\t\tp.avoid_ed_pne_count,\r\n\t\tp.avoid_ed_sep_allowed,\r\n\t\tp.avoid_ed_sep_count,\r\n\t\tp.avoid_ip_ane_allowed,\r\n\t\tp.avoid_ip_deh_allowed,\r\n\t\tp.avoid_ip_deh_count,\r\n\t\tp.avoid_ip_die_allowed,\r\n\t\tp.avoid_ip_die_count,\r\n\t\tp.avoid_ip_eme_allowed,\r\n\t\tp.avoid_ip_eme_count,\r\n\t\tp.avoid_ip_fev_allowed,\r\n\t\tp.avoid_ip_fev_count,\r\n\t\tp.avoid_ip_nau_allowed,\r\n\t\tp.avoid_ip_nau_count,\r\n\t\tp.avoid_ip_neu_allowed,\r\n\t\tp.avoid_ip_neu_count,\r\n\t\tp.avoid_ip_pai_allowed,\r\n\t\tp.avoid_ip_pai_count,\r\n\t\tp.avoid_ip_pne_allowed,\r\n\t\tp.avoid_ip_pne_count,\r\n\t\tp.avoid_ip_sep_allowed,\r\n\t\tp.avoid_ip_sep_count,\r\n\t\tp.avoidable_admits_allowed,\r\n\t\tp.avoidable_ed_allowed,\r\n\t\tp.avoidable_ed_count,\r\n\t\tp.birth_date,\r\n\t\tp.ccf_paid,\r\n\t\tp.chemo_allowed,\r\n\t\tp.chemo_count,\r\n\t\tp.chemo_drugs_medical,\r\n\t\tp.chemo_drugs_medical_count,\r\n\t\tp.chemotherapy_type,\r\n\t\tp.dod,\r\n\t\tp.ed_allowed,\r\n\t\tp.ed_visits,\r\n\t\tp.emergencyroomtotalvisits,\r\n\t\tp.eol_chemo_allowed,\r\n\t\tp.eol_chemo_count,\r\n\t\tp.eol_ed_allowed,\r\n\t\tp.eol_ed_visits,\r\n\t\tp.eol_icu_allowed,\r\n\t\tp.eol_icu_count,\r\n\t\tp.episode_end_date,\r\n\t\tp.episode_start_date,\r\n\t\tp.er,\r\n\t\tp.er_count,\r\n\t\tp.gender,\r\n\t\tp.home,\r\n\t\tp.inpatient,\r\n\t\tp.home_count,\r\n\t\tp.hospice_allowed,\r\n\t\tp.hospice_claim_admits,\r\n\t\tp.hospice_los,\r\n\t\tp.icu_allowed,\r\n\t\tp.icu_claim_admits,\r\n\t\tp.icu_los,\r\n\t\tp.inpatient__all_other_inpatient,\r\n\t\tp.inpatient__cardiology,\r\n\t\tp.inpatient__detailed_coded_drugs,\r\n\t\tp.inpatient__emergency_room,\r\n\t\tp.inpatient__icu,\r\n\t\tp.inpatient__imaging,\r\n\t\tp.inpatient__lab_pathology,\r\n\t\tp.inpatient__med_surg_supplies,\r\n\t\tp.inpatient__operation,\r\n\t\tp.inpatient__pharmacy,\r\n\t\tp.inpatient__other,\r\n\t\tp.inpatient__radiation_therapy,\r\n\t\tp.inpatient__respiratory_pt_ot_st,\r\n\t\tp.inpatient__room_and_board,\r\n\t\tp.inpatient_count,\r\n\t\tp.inpatient_count__all_other_inpatient,\r\n\t\tp.inpatient_count__cardiology,\r\n\t\tp.inpatient_count__detailed_coded_drugs,\r\n\t\tp.inpatient_count__emergency_room,\r\n\t\tp.inpatient_count__icu,\r\n\t\tp.inpatient_count__imaging,\r\n\t\tp.inpatient_count__lab_pathology,\r\n\t\tp.inpatient_count__med_surg_supplies,\r\n\t\tp.inpatient_count__operation,\r\n\t\tp.inpatient_count__other,\r\n\t\tp.inpatient_count__pharmacy,\r\n\t\tp.inpatient_count__radiation_therapy,\r\n\t\tp.inpatient_count__respiratory_pt_ot_st,\r\n\t\tp.inpatient_count__room_and_board,\r\n\t\tp.avoidable_admits_count,\r\n\t\tp.inpatient_drugs_requiring_coding,\r\n\t\tp.avoid_ip_ane_count,\r\n\t\tp.ip_allowed,\r\n\t\tp.ip_claim_admits,\r\n\t\tp.ip_clusters,\r\n\t\tp.ip_los,\r\n\t\tp.lab,\r\n\t\tp.lab_count,\r\n\t\tp.min_risk_corridor,\r\n\t\tp.novel_allowed,\r\n\t\tp.office,\r\n\t\tp.office__all_other_office,\r\n\t\tp.office__cardiovascular_procedures,\r\n\t\tp.office__drug_admin,\r\n\t\tp.office__e_and_m,\r\n\t\tp.office__radioactive_agents,\r\n\t\tp.office__other,\r\n\t\tp.office__radiology_mammography,\r\n\t\tp.office__pathology_and_lab,\r\n\t\tp.office__psychiatry,\r\n\t\tp.office__radiation_treatment,\r\n\t\tp.office__radiology_diagnostic,\r\n\t\tp.office__radiology_guidance,\r\n\t\tp.office__radiology_nuclear_medicine,\r\n\t\tp.office__radiology_other,\r\n\t\tp.office__radiology_rad_onc_treatment,\r\n\t\tp.office__surgery,\r\n\t\tp.office__therapeutic_activities,\r\n\t\tp.office_count,\r\n\t\tp.office_count__all_other_office,\r\n\t\tp.office_count__cardiovascular_procedures,\r\n\t\tp.office_count__drug_admin,\r\n\t\tp.office_count__e_and_m,\r\n\t\tp.office_count__other,\r\n\t\tp.office_count__pathology_and_lab,\r\n\t\tp.office_count__psychiatry,\r\n\t\tp.office_count__radiation_treatment,\r\n\t\tp.office_count__radioactive_agents,\r\n\t\tp.office_count__radiology_diagnostic,\r\n\t\tp.office_count__radiology_guidance,\r\n\t\tp.office_count__radiology_mammography,\r\n\t\tp.office_count__radiology_nuclear_medicine,\r\n\t\tp.office_count__radiology_other,\r\n\t\tp.office_count__radiology_rad_onc_treatment,\r\n\t\tp.office_count__surgery,\r\n\t\tp.office_count__therapeutic_activities,\r\n\t\tp.operating_room_services_count,\r\n\t\tp.outpatient,\r\n\t\tp.outpatient__all_other_outpatient,\r\n\t\tp.outpatient__chemo_admin,\r\n\t\tp.outpatient__detailed_coded_drugs,\r\n\t\tp.outpatient__gastrointestinal,\r\n\t\tp.outpatient__imaging,\r\n\t\tp.outpatient__iv_therapy,\r\n\t\tp.outpatient__lab_pathology,\r\n\t\tp.outpatient__med_surg_supplies,\r\n\t\tp.outpatient__nuclear_medicine,\r\n\t\tp.outpatient__operation,\r\n\t\tp.outpatient__other,\r\n\t\tp.outpatient__pharmacy,\r\n\t\tp.outpatient__radiation_therapy,\r\n\t\tp.outpatient_count,\r\n\t\tp.outpatient_count__all_other_outpatient,\r\n\t\tp.outpatient_count__chemo_admin,\r\n\t\tp.outpatient_count__detailed_coded_drugs,\r\n\t\tp.outpatient_count__gastrointestinal,\r\n\t\tp.outpatient_count__imaging,\r\n\t\tp.outpatient_count__iv_therapy,\r\n\t\tp.outpatient_count__lab_pathology,\r\n\t\tp.outpatient_count__med_surg_supplies,\r\n\t\tp.outpatient_count__nuclear_medicine,\r\n\t\tp.outpatient_count__operation,\r\n\t\tp.outpatient_count__other,\r\n\t\tp.outpatient_count__pharmacy,\r\n\t\tp.outpatient_count__radiation_therapy,\r\n\t\tp.practice,\r\n\t\tp.prediction,\r\n\t\tp.retail_pharm,\r\n\t\tp.retail_pharm_count,\r\n\t\tp.ssav_expns_amt_no_cap,\r\n\t\tp.telehealth,\r\n\t\tp.telehealth_count,\r\n\t\tp.total_allowed_wind,\r\n\t\tp.totalallowedamtcostall,\r\n\t\tp.transportation,\r\n\t\tp.transportation_count,\r\n\t\tp.uc,\r\n\t\tp.uc_count\r\nFROM recon_source AS p\r\n\tINNER JOIN recon_population_with_provider AS a\r\n\t\tON\r\n\t\t\tp.memberid = a.memberid\r\n\t\t\tAND p.performanceperiodstartdate = a.performanceperiodstartdate\r\n\tLEFT JOIN\r\n\t\t{{ ref('stg_member_hospice_mapping') }} AS hm\r\n\t\tON p.memberid = hm.memberid AND a.perf_period_key = hm.perf_period_key AND p.lineofbusinessidentifier = hm.lineofbusiness\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON a.attributedprovidertaxid = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_recon",
    "description": "Reconcillation data",
    "columns": {
      "memberid": {
        "name": "memberid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "perf_period_key": {
        "name": "perf_period_key",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "filerunid": {
        "name": "filerunid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractid": {
        "name": "contractid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "lob": {
        "name": "lob",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "administrativetaxidnumber": {
        "name": "administrativetaxidnumber",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractstatecode": {
        "name": "contractstatecode",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "performanceperiodstartdate": {
        "name": "performanceperiodstartdate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "performanceperiodenddate": {
        "name": "performanceperiodenddate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractperiodstartdate": {
        "name": "contractperiodstartdate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "contractperiodenddate": {
        "name": "contractperiodenddate",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "programid": {
        "name": "programid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "providergroupingidentifier": {
        "name": "providergroupingidentifier",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episodecount": {
        "name": "episodecount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "budgetamount": {
        "name": "budgetamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "trenddescription": {
        "name": "trenddescription",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "noveladjustmentdescription": {
        "name": "noveladjustmentdescription",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "benchmarkpriceamount": {
        "name": "benchmarkpriceamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "administrativediscountpercent": {
        "name": "administrativediscountpercent",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "targetpriceamount": {
        "name": "targetpriceamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "totalallowedactualcostamount": {
        "name": "totalallowedactualcostamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episodeactualtotargetdifferenceamount": {
        "name": "episodeactualtotargetdifferenceamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "sharedsavingspercent": {
        "name": "sharedsavingspercent",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "savingspoolamount": {
        "name": "savingspoolamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "sharedsavingsmultipliervalue": {
        "name": "sharedsavingsmultipliervalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "sharedsavingsexpenseamount": {
        "name": "sharedsavingsexpenseamount",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "episodeid": {
        "name": "episodeid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "participatingprovidernpinumber": {
        "name": "participatingprovidernpinumber",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "attributedprovidertaxid": {
        "name": "attributedprovidertaxid",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": [],
        "test": [
          "not_null"
        ]
      },
      "cancerdiagnosiscode": {
        "name": "cancerdiagnosiscode",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "cancerdiagnosisdescriptiontext": {
        "name": "cancerdiagnosisdescriptiontext",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "timeperioddates": {
        "name": "timeperioddates",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "cancertype": {
        "name": "cancertype",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1code": {
        "name": "qm1code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1pointsvalue": {
        "name": "qm1pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1performanceratevalue": {
        "name": "qm1performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1numeratorvalue": {
        "name": "qm1numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm1denominatorvalue": {
        "name": "qm1denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2code": {
        "name": "qm2code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2pointsvalue": {
        "name": "qm2pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2performanceratevalue": {
        "name": "qm2performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2numeratorvalue": {
        "name": "qm2numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm2denominatorvalue": {
        "name": "qm2denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3code": {
        "name": "qm3code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3pointsvalue": {
        "name": "qm3pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3performanceratevalue": {
        "name": "qm3performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3nominatorvalue": {
        "name": "qm3nominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm3denominatorvalue": {
        "name": "qm3denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4code": {
        "name": "qm4code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4pointsvalue": {
        "name": "qm4pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4performanceratevalue": {
        "name": "qm4performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4numeratorvalue": {
        "name": "qm4numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm4denominatorvalue": {
        "name": "qm4denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5code - not_null": {
        "name": "qm5code - not_null",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5pointsvalue": {
        "name": "qm5pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5performanceratevalue": {
        "name": "qm5performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5numeratorvalue": {
        "name": "qm5numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm5denominatorvalue": {
        "name": "qm5denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6code": {
        "name": "qm6code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6pointsvalue": {
        "name": "qm6pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6performanceratevalue": {
        "name": "qm6performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6numeratorvalue": {
        "name": "qm6numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm6denominatorvalue": {
        "name": "qm6denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7code": {
        "name": "qm7code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7pointsvalue": {
        "name": "qm7pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7performanceratevalue": {
        "name": "qm7performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7numeratorvalue": {
        "name": "qm7numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm7denominatorvalue": {
        "name": "qm7denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8code": {
        "name": "qm8code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8pointsvalue": {
        "name": "qm8pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8performanceratevalue": {
        "name": "qm8performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8numeratorvalue": {
        "name": "qm8numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm8denominatorvalue": {
        "name": "qm8denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9code": {
        "name": "qm9code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9pointsvalue": {
        "name": "qm9pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9performanceratevalue": {
        "name": "qm9performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9numeratorvalue": {
        "name": "qm9numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm9denominatorvalue": {
        "name": "qm9denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10code": {
        "name": "qm10code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10pointsvalue": {
        "name": "qm10pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10performanceratevalue": {
        "name": "qm10performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10numeratorvalue": {
        "name": "qm10numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm10denominatorvalue": {
        "name": "qm10denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11code": {
        "name": "qm11code",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11pointsvalue": {
        "name": "qm11pointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11performanceratevalue": {
        "name": "qm11performanceratevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11numeratorvalue": {
        "name": "qm11numeratorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qm11denominatorvalue": {
        "name": "qm11denominatorvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qmtotalpointsvalue": {
        "name": "qmtotalpointsvalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "qmaggregatequalityscorevalue": {
        "name": "qmaggregatequalityscorevalue",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "isHospiceMember": {
        "name": "isHospiceMember",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC1.ATTRIBUTION",
        "model.anthem_dev.stg_ic1_recon_source",
        "model.anthem_dev.stg_member",
        "model.anthem_dev.stg_seed_ocm_cancer_types",
        "model.anthem_dev.stg_seed_performance_period",
        "model.anthem_dev.stg_member_hospice_mapping",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_rendering_provider",
    "name": "stg_rendering_provider",
    "original_file_path": "models\\staging\\stg_rendering_provider.sql",
    "compiled_code": "\n\nWITH distinctprovider AS (\n\tSELECT DISTINCT\n\t\tclaimrenderingprovidernpinumber,\n\t\tmedicalfacilitytin\n\tFROM dev_dtx_gc.staging.stg_claims\n\tWHERE medicalfacilitytin IS NOT NULL\n)\n\nSELECT\n\tp.claimrenderingprovidernpinumber AS npi,\n\tsp.provider_name,\n\tsp.provider_city_name,\n\tsp.provider_state_name,\n\tsp.provider_postal_code,\n\tsp.taxonomy_code,\n\tsp.npi_deactivation_date,\n\tsp.provider_specialty,\n\tNULL AS region,\n\tp.medicalfacilitytin,\n\tmap.tin_group_1,\n\tmap.tin_group_2,\n\tmap.tin_group_3,\n\tCONCAT(\n\t\tCOALESCE(p.claimrenderingprovidernpinumber, ''),\n\t\t'_',\n\t\tp.medicalfacilitytin\n\t) AS renderingnpi_attributedtin,\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\nFROM distinctprovider AS p\n\tLEFT JOIN dev_dtx_gc.staging.stg_provider AS sp\n\t\tON p.claimrenderingprovidernpinumber = sp.npi\n\tLEFT JOIN dev_dtx_gc.staging.stg_client_tin_mapping AS map\n\t\tON p.medicalfacilitytin = map.tin",
    "raw_code": "{{ config( alias = 'stg_rendering_provider', schema = 'staging') }}\r\n\r\nWITH distinctprovider AS (\r\n\tSELECT DISTINCT\r\n\t\tclaimrenderingprovidernpinumber,\r\n\t\tmedicalfacilitytin\r\n\tFROM {{ ref('stg_claims') }}\r\n\tWHERE medicalfacilitytin IS NOT NULL\r\n)\r\n\r\nSELECT\r\n\tp.claimrenderingprovidernpinumber AS npi,\r\n\tsp.provider_name,\r\n\tsp.provider_city_name,\r\n\tsp.provider_state_name,\r\n\tsp.provider_postal_code,\r\n\tsp.taxonomy_code,\r\n\tsp.npi_deactivation_date,\r\n\tsp.provider_specialty,\r\n\tNULL AS region,\r\n\tp.medicalfacilitytin,\r\n\tmap.tin_group_1,\r\n\tmap.tin_group_2,\r\n\tmap.tin_group_3,\r\n\tCONCAT(\r\n\t\tCOALESCE(p.claimrenderingprovidernpinumber, ''),\r\n\t\t'_',\r\n\t\tp.medicalfacilitytin\r\n\t) AS renderingnpi_attributedtin,\r\n\tDATE_TRUNC('seconds', SYSDATE()) AS recordinsertiondate_utc\r\nFROM distinctprovider AS p\r\n\tLEFT JOIN {{ ref('stg_provider') }} AS sp\r\n\t\tON p.claimrenderingprovidernpinumber = sp.npi\r\n\tLEFT JOIN {{ ref('stg_client_tin_mapping') }} AS map\r\n\t\tON p.medicalfacilitytin = map.tin",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_rendering_provider",
    "description": "Provider details",
    "columns": {
      "RenderingNPI_AttributedTIN": {
        "name": "RenderingNPI_AttributedTIN",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "RECORDINSERTIONDATE_UTC": {
        "name": "RECORDINSERTIONDATE_UTC",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_claims",
        "model.anthem_dev.stg_provider",
        "model.anthem_dev.stg_client_tin_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_revenue_code",
    "name": "stg_revenue_code",
    "original_file_path": "models\\staging\\stg_revenue_code.sql",
    "compiled_code": "\n\nSELECT *\nFROM PROD_INTELLIGENCE_DTX.IC_TO_ANTHEM.CONCEPT\nWHERE domain_id = 'Revenue Code' AND vocabulary_id = 'Revenue Code'",
    "raw_code": "{{ config( alias = 'stg_revenue_code', schema = 'staging') }}\r\n\r\nSELECT *\r\nFROM {{ source('IC_TO_ANTHEM','CONCEPT') }}\r\nWHERE domain_id = 'Revenue Code' AND vocabulary_id = 'Revenue Code'",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_revenue_code",
    "description": "",
    "columns": {},
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "source.anthem_dev.IC_TO_ANTHEM.CONCEPT"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_anthem_excluded_cancer_code",
    "name": "stg_seed_anthem_excluded_cancer_code",
    "original_file_path": "models\\staging\\seed\\stg_seed_anthem_excluded_cancer_code.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_anthem_excluded_cancer_code",
    "raw_code": "{{ config( alias = 'stg_seed_anthem_excluded_cancer_code', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_anthem_excluded_cancer_code') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_anthem_excluded_cancer_code",
    "description": "Excluded cancer diagnosis details from Anthem project",
    "columns": {
      "CancerCode": {
        "name": "CancerCode",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ExclusionStartDate": {
        "name": "ExclusionStartDate",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ExclusionEndDate": {
        "name": "ExclusionEndDate",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_anthem_excluded_cancer_code"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_anthem_salesforce_apm_enrollees",
    "name": "stg_seed_anthem_salesforce_apm_enrollees",
    "original_file_path": "models\\staging\\seed\\stg_seed_anthem_salesforce_apm_enrollees.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_anthem_salesforce_apm_enrollees",
    "raw_code": "{{ config( alias = 'stg_seed_anthem_salesforce_apm_enrollees', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_anthem_salesforce_apm_enrollees') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_anthem_salesforce_apm_enrollees",
    "description": "",
    "columns": {
      "tax_id": {
        "name": "tax_id",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "COMPLETED_IMPROVEMENT_PLAN": {
        "name": "COMPLETED_IMPROVEMENT_PLAN",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_anthem_salesforce_apm_enrollees"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_anthem_tins",
    "name": "stg_seed_anthem_tins",
    "original_file_path": "models\\staging\\seed\\stg_seed_anthem_tins.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_anthem_tins",
    "raw_code": "{{ config( alias = 'stg_seed_anthem_tins', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_anthem_tins') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_anthem_tins",
    "description": "",
    "columns": {
      "ATTRIB_TIN": {
        "name": "ATTRIB_TIN",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIB_NAME": {
        "name": "ATTRIB_NAME",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ATTRIB_ST": {
        "name": "ATTRIB_ST",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_anthem_tins"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_antiemetics",
    "name": "stg_seed_antiemetics",
    "original_file_path": "models\\staging\\seed\\stg_seed_antiemetics.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_antiemetics",
    "raw_code": "{{ config( alias = 'stg_seed_antiemetics', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_antiemetics') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_antiemetics",
    "description": "",
    "columns": {
      "GENERIC": {
        "name": "GENERIC",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE": {
        "name": "CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DRUG_CATEGORY": {
        "name": "DRUG_CATEGORY",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CLASS": {
        "name": "CLASS",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_antiemetics"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_chemo_codes",
    "name": "stg_seed_chemo_codes",
    "original_file_path": "models\\staging\\seed\\stg_seed_chemo_codes.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_chemo_codes",
    "raw_code": "{{ config( alias = 'stg_seed_chemo_codes', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_chemo_codes') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_chemo_codes",
    "description": "",
    "columns": {},
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_chemo_codes"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_chemo_w_emeticrisk_codes",
    "name": "stg_seed_chemo_w_emeticrisk_codes",
    "original_file_path": "models\\staging\\seed\\stg_seed_chemo_w_emeticrisk_codes.sql",
    "compiled_code": "\n\nWITH concept AS (\n\tSELECT DISTINCT\n\t\ts.code,\n\t\t-- Upper to be consistent and TRIM to remove trailing Balnks\n\t\ts.code_type,\n\t\tCOALESCE(s.agents, c.concept_name)\n\t\t\tAS agents,\n\t\tTRIM(UPPER(s.emetic_risk)) AS emetic_risk,\n\t\tROW_NUMBER() OVER (\n\t\t\tPARTITION BY s.code\n\t\t\tORDER BY\n\t\t\t\tc.valid_end_date DESC,\n\t\t\t\tc.concept_id ASC,\n\t\t\t\tc.concept_name DESC\n\t\t) AS row_no\n\tFROM dev_dtx_gc.anthemreporting_seed.seed_chemo_w_emeticrisk_codes AS s\n\t\tLEFT JOIN prod_intelligence_dtx.ic_to_anthem.concept AS c\n\t\t\tON\n\t\t\t\ts.code = c.concept_code\n\t\t\t\tAND c.vocabulary_id = 'HCPCS'\n-- DO-2081, 1st priority is the EndDate, 2nd is Low ConceptID, 3rd is Name\n)\n\nSELECT\n\tagents,\n\temetic_risk,\n\tcode,\n\tcode_type\nFROM concept\nWHERE row_no = 1",
    "raw_code": "{{ config( alias = 'stg_seed_chemo_w_emeticrisk_codes', schema = 'staging') }}\r\n\r\nWITH concept AS (\r\n\tSELECT DISTINCT\r\n\t\ts.code,\r\n\t\t-- Upper to be consistent and TRIM to remove trailing Balnks\r\n\t\ts.code_type,\r\n\t\tCOALESCE(s.agents, c.concept_name)\r\n\t\t\tAS agents,\r\n\t\tTRIM(UPPER(s.emetic_risk)) AS emetic_risk,\r\n\t\tROW_NUMBER() OVER (\r\n\t\t\tPARTITION BY s.code\r\n\t\t\tORDER BY\r\n\t\t\t\tc.valid_end_date DESC,\r\n\t\t\t\tc.concept_id ASC,\r\n\t\t\t\tc.concept_name DESC\r\n\t\t) AS row_no\r\n\tFROM {{ ref('seed_chemo_w_emeticrisk_codes') }} AS s\r\n\t\tLEFT JOIN prod_intelligence_dtx.ic_to_anthem.concept AS c\r\n\t\t\tON\r\n\t\t\t\ts.code = c.concept_code\r\n\t\t\t\tAND c.vocabulary_id = 'HCPCS'\r\n-- DO-2081, 1st priority is the EndDate, 2nd is Low ConceptID, 3rd is Name\r\n)\r\n\r\nSELECT\r\n\tagents,\r\n\temetic_risk,\r\n\tcode,\r\n\tcode_type\r\nFROM concept\r\nWHERE row_no = 1",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_chemo_w_emeticrisk_codes",
    "description": "",
    "columns": {
      "EMETIC_RISK": {
        "name": "EMETIC_RISK",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE": {
        "name": "CODE",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_chemo_w_emeticrisk_codes"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_comorbidities",
    "name": "stg_seed_comorbidities",
    "original_file_path": "models\\staging\\seed\\stg_seed_comorbidities.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_comorbidities",
    "raw_code": "{{ config( alias = 'stg_seed_comorbidities', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_comorbidities') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_comorbidities",
    "description": "",
    "columns": {
      "GENERAL_DESCRIPTION": {
        "name": "GENERAL_DESCRIPTION",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE_SYSTEM": {
        "name": "CODE_SYSTEM",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_comorbidities"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_comorbidtiy_hcc",
    "name": "stg_seed_comorbidtiy_hcc",
    "original_file_path": "models\\staging\\seed\\stg_seed_comorbidtiy_hcc.sql",
    "compiled_code": "\n\nSELECT *\nFROM dev_dtx_gc.anthemreporting_seed.seed_comorbidities_hhc",
    "raw_code": "{{ config( alias = 'stg_seed_comorbidtiy_hcc', schema = 'staging') }}\r\n\r\nSELECT *\r\nFROM {{ ref('seed_comorbidities_hhc') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_comorbidtiy_hcc",
    "description": "",
    "columns": {
      "Comorbidity": {
        "name": "Comorbidity",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "HCC_Codes": {
        "name": "HCC_Codes",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_comorbidities_hhc"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_costcategory",
    "name": "stg_seed_costcategory",
    "original_file_path": "models\\staging\\seed\\stg_seed_costcategory.sql",
    "compiled_code": "\n\nSELECT DISTINCT place_of_service_name AS costcategory\nFROM dev_dtx_gc.staging.stg_seed_place_of_service_mapping\nUNION ALL\nSELECT 'Chemo & Drugs (Medical)'\nUNION ALL\nSELECT 'Retail Pharmacy'",
    "raw_code": "{{ config( alias = 'stg_seed_costcategory', schema = 'staging') }}\r\n\r\nSELECT DISTINCT place_of_service_name AS costcategory\r\nFROM {{ ref('stg_seed_place_of_service_mapping') }}\r\nUNION ALL\r\nSELECT 'Chemo & Drugs (Medical)'\r\nUNION ALL\r\nSELECT 'Retail Pharmacy'",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_costcategory",
    "description": "List cost categories for dimension table",
    "columns": {
      "costcategory": {
        "name": "costcategory",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "model.anthem_dev.stg_seed_place_of_service_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_hcc_mapping_hcc_and_rxhcc",
    "name": "stg_seed_hcc_mapping_hcc_and_rxhcc",
    "original_file_path": "models\\staging\\seed\\stg_seed_hcc_mapping_hcc_and_rxhcc.sql",
    "compiled_code": "\n\n--this is needed to see which diagnosis have both HCC and RxHCC\nSELECT\n\ts.diagnosis_code,\n\ts.description,\n\ts.cms_hcc_v24_2022,\n\ts.rxhcc_v08_2022,\n\t'HCC' || s.cms_hcc_v24 AS hcc_code,\n\t'RxHCC' || s.rxhcc_v08 AS rxhcc_code\nFROM dev_dtx_gc.anthemreporting_seed.seed_hccmapping AS s",
    "raw_code": "{{ config( alias = 'stg_seed_hcc_mapping_hcc_and_rxhcc', schema = 'staging') }}\r\n\r\n--this is needed to see which diagnosis have both HCC and RxHCC\r\nSELECT\r\n\ts.diagnosis_code,\r\n\ts.description,\r\n\ts.cms_hcc_v24_2022,\r\n\ts.rxhcc_v08_2022,\r\n\t'HCC' || s.cms_hcc_v24 AS hcc_code,\r\n\t'RxHCC' || s.rxhcc_v08 AS rxhcc_code\r\nFROM {{ ref('seed_hccmapping') }} AS s",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_hcc_mapping_hcc_and_rxhcc",
    "description": "",
    "columns": {
      "DIAGNOSIS_CODE": {
        "name": "DIAGNOSIS_CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DESCRIPTION": {
        "name": "DESCRIPTION",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_hccmapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_hcpcs",
    "name": "stg_seed_hcpcs",
    "original_file_path": "models\\staging\\seed\\stg_seed_hcpcs.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_hcpcs",
    "raw_code": "{{ config( alias = 'stg_seed_hcpcs', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_hcpcs') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_hcpcs",
    "description": "",
    "columns": {
      "CODE": {
        "name": "CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PROCEDURE_NAME": {
        "name": "PROCEDURE_NAME",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PROCEDURE_CATEGORY": {
        "name": "PROCEDURE_CATEGORY",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_hcpcs"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_hormone_therapy",
    "name": "stg_seed_hormone_therapy",
    "original_file_path": "models\\staging\\seed\\stg_seed_hormone_therapy.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_hormone_therapy",
    "raw_code": "{{ config( alias = 'stg_seed_hormone_therapy', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_hormone_therapy') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_hormone_therapy",
    "description": "",
    "columns": {
      "HORMONE_THERAPY": {
        "name": "HORMONE_THERAPY",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CANCER_TYPE": {
        "name": "CANCER_TYPE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_hormone_therapy"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_hospice_admission",
    "name": "stg_seed_hospice_admission",
    "original_file_path": "models\\staging\\seed\\stg_seed_hospice_admission.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_hospice_admission",
    "raw_code": "{{ config( alias = 'stg_seed_hospice_admission', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_hospice_admission') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_hospice_admission",
    "description": "Holds fields for Filter Option for Hospice",
    "columns": {
      "ishospicemember": {
        "name": "ishospicemember",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_hospice_admission"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_icd10cm_codes",
    "name": "stg_seed_icd10cm_codes",
    "original_file_path": "models\\staging\\seed\\stg_seed_icd10cm_codes.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_icd10cm_codes",
    "raw_code": "{{ config( alias = 'stg_seed_icd10cm_codes', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_icd10cm_codes') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_icd10cm_codes",
    "description": "",
    "columns": {
      "CONCEPT_CODE": {
        "name": "CONCEPT_CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CONCEPT_NAME": {
        "name": "CONCEPT_NAME",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_icd10cm_codes"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_ndc_drug",
    "name": "stg_seed_ndc_drug",
    "original_file_path": "models\\staging\\seed\\stg_seed_ndc_drug.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_ndc_drug",
    "raw_code": "{{ config( alias = 'stg_seed_ndc_drug', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_ndc_drug') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_ndc_drug",
    "description": "",
    "columns": {
      "NDC_CODE": {
        "name": "NDC_CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_ndc_drug"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_novel_therapies",
    "name": "stg_seed_novel_therapies",
    "original_file_path": "models\\staging\\seed\\stg_seed_novel_therapies.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_novel_therapies",
    "raw_code": "{{ config( alias = 'stg_seed_novel_therapies', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_novel_therapies') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_novel_therapies",
    "description": "",
    "columns": {
      "INGREDIENT": {
        "name": "INGREDIENT",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CANCER_TYPE": {
        "name": "CANCER_TYPE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE_TYPE": {
        "name": "CODE_TYPE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE": {
        "name": "CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "START_DT": {
        "name": "START_DT",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "END_DT": {
        "name": "END_DT",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_novel_therapies"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_ocm_cancer_types",
    "name": "stg_seed_ocm_cancer_types",
    "original_file_path": "models\\staging\\seed\\stg_seed_ocm_cancer_types.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_ocm_cancer_types",
    "raw_code": "{{ config( alias = 'stg_seed_ocm_cancer_types', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_ocm_cancer_types') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_ocm_cancer_types",
    "description": "",
    "columns": {
      "CANCER_TYPE": {
        "name": "CANCER_TYPE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ICD10CODE": {
        "name": "ICD10CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "START_DT": {
        "name": "START_DT",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "END_DT": {
        "name": "END_DT",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_ocm_cancer_types"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_ocm_initiators_hcpcs",
    "name": "stg_seed_ocm_initiators_hcpcs",
    "original_file_path": "models\\staging\\seed\\stg_seed_ocm_initiators_hcpcs.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_ocm_initiators_hcpcs",
    "raw_code": "{{ config( alias = 'stg_seed_ocm_initiators_hcpcs', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_ocm_initiators_hcpcs') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_ocm_initiators_hcpcs",
    "description": "",
    "columns": {
      "GENERIC_DRUG": {
        "name": "GENERIC_DRUG",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "HCPCS_CODE": {
        "name": "HCPCS_CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_ocm_initiators_hcpcs"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_ocm_initiators_ndc",
    "name": "stg_seed_ocm_initiators_ndc",
    "original_file_path": "models\\staging\\seed\\stg_seed_ocm_initiators_ndc.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_ocm_initiators_ndc",
    "raw_code": "{{ config( alias = 'stg_seed_ocm_initiators_ndc', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_ocm_initiators_ndc') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_ocm_initiators_ndc",
    "description": "",
    "columns": {
      "GENERIC_DRUG": {
        "name": "GENERIC_DRUG",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NDC_TEXT": {
        "name": "NDC_TEXT",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NDC_CODE": {
        "name": "NDC_CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_ocm_initiators_ndc"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_performance_multiplier",
    "name": "stg_seed_performance_multiplier",
    "original_file_path": "models\\staging\\seed\\stg_seed_performance_multiplier.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_performance_multiplier",
    "raw_code": "{{ config( alias = 'stg_seed_performance_multiplier', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_performance_multiplier') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_performance_multiplier",
    "description": "Performance multiplier",
    "columns": {
      "total_score": {
        "name": "total_score",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "multiplier": {
        "name": "multiplier",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_performance_multiplier"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_performance_period",
    "name": "stg_seed_performance_period",
    "original_file_path": "models\\staging\\seed\\stg_seed_performance_period.sql",
    "compiled_code": "\n\nSELECT\n\tperf_period_key,\n\tperf_period_name,\n\tperf_period_name_range,\n\tccf_version,\n\tCAST(perf_period_start_date AS date) AS perf_period_start_date,\n\tCAST(perf_period_end_date AS date) AS perf_period_end_date\nFROM dev_dtx_gc.anthemreporting_seed.seed_performance_period",
    "raw_code": "{{ config( alias = 'stg_seed_performance_period', schema = 'staging') }}\r\n\r\nSELECT\r\n\tperf_period_key,\r\n\tperf_period_name,\r\n\tperf_period_name_range,\r\n\tccf_version,\r\n\tCAST(perf_period_start_date AS date) AS perf_period_start_date,\r\n\tCAST(perf_period_end_date AS date) AS perf_period_end_date\r\nFROM {{ ref('seed_performance_period') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_performance_period",
    "description": "Performance period details",
    "columns": {
      "perf_period_key": {
        "name": "perf_period_key",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "perf_period_name": {
        "name": "perf_period_name",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "perf_period_start_date": {
        "name": "perf_period_start_date",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "perf_period_end_date": {
        "name": "perf_period_end_date",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "perf_period_name_range": {
        "name": "perf_period_name_range",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ccf_version": {
        "name": "ccf_version",
        "description": "Based on this column, the logic to fetch ccf value is decided",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_performance_period"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_place_of_service_mapping",
    "name": "stg_seed_place_of_service_mapping",
    "original_file_path": "models\\staging\\seed\\stg_seed_place_of_service_mapping.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_place_of_service_mapping",
    "raw_code": "{{ config( alias = 'stg_seed_place_of_service_mapping', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_place_of_service_mapping') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_place_of_service_mapping",
    "description": "List of codes for place of service and details",
    "columns": {
      "Place_of_Service_Code": {
        "name": "Place_of_Service_Code",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "Place_of_Service_Name": {
        "name": "Place_of_Service_Name",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "Place_of_Service_Description": {
        "name": "Place_of_Service_Description",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_place_of_service_mapping"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_procedures",
    "name": "stg_seed_procedures",
    "original_file_path": "models\\staging\\seed\\stg_seed_procedures.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_procedures",
    "raw_code": "{{ config( alias = 'stg_seed_procedures', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_procedures') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_procedures",
    "description": "",
    "columns": {
      "CODE": {
        "name": "CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE_TYPE": {
        "name": "CODE_TYPE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "NAME": {
        "name": "NAME",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_procedures"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_procedure_treatment_exclusions",
    "name": "stg_seed_procedure_treatment_exclusions",
    "original_file_path": "models\\staging\\seed\\stg_seed_procedure_treatment_exclusions.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_procedure_treatment_exclusions",
    "raw_code": "{{ config( alias = 'stg_seed_procedure_treatment_exclusions', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_procedure_treatment_exclusions') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_procedure_treatment_exclusions",
    "description": "",
    "columns": {
      "EXCLUSION_GROUP": {
        "name": "EXCLUSION_GROUP",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE": {
        "name": "CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE_TYPE": {
        "name": "CODE_TYPE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_procedure_treatment_exclusions"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_qm_avoidable_diagnosis",
    "name": "stg_seed_qm_avoidable_diagnosis",
    "original_file_path": "models\\staging\\seed\\stg_seed_qm_avoidable_diagnosis.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_qm_avoidable_diagnosis",
    "raw_code": "{{ config( alias = 'stg_seed_qm_avoidable_diagnosis', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_qm_avoidable_diagnosis') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_qm_avoidable_diagnosis",
    "description": "Avoidable diagnosis details",
    "columns": {
      "ICD10CODE": {
        "name": "ICD10CODE",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "ICD10DESCRIPTION": {
        "name": "ICD10DESCRIPTION",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_qm_avoidable_diagnosis"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_qualifying_chemo",
    "name": "stg_seed_qualifying_chemo",
    "original_file_path": "models\\staging\\seed\\stg_seed_qualifying_chemo.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_qualifying_chemo",
    "raw_code": "{{ config( alias = 'stg_seed_qualifying_chemo', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_qualifying_chemo') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_qualifying_chemo",
    "description": "",
    "columns": {
      "CODE": {
        "name": "CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "CODE_TYPE": {
        "name": "CODE_TYPE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PROCEDURE_NAME": {
        "name": "PROCEDURE_NAME",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PROCEDURE_DESC": {
        "name": "PROCEDURE_DESC",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "PROCEDURE_CATEGORY": {
        "name": "PROCEDURE_CATEGORY",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_qualifying_chemo"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_quality_measures",
    "name": "stg_seed_quality_measures",
    "original_file_path": "models\\staging\\seed\\stg_seed_quality_measures.sql",
    "compiled_code": "\n\nSELECT\n\tqmid,\n\tqmname,\n\tdecsription,\n\ttargetscore,\n\tmeasureid,\n\tcustommeasureid,\n\t-- Demo Report process \n\t\n\t\tmeasurename,\n\t\n\t-- Demo Report process \n\tgroup1score,\n\tgroup2score,\n\tgroup3score,\n\tgroup4score,\n\tgroup5score,\n\tqmsort,\n\tquintile_1,\n\tquintile_2,\n\tquintile_3,\n\tquintile_4,\n\tquintile_5,\n\tquintile_1_ma,\n\tquintile_2_ma,\n\tquintile_3_ma,\n\tquintile_4_ma,\n\tquintile_5_ma,\n\tqmweight,\n\tqmhoverdesc,\n\tqmshortdesc\nFROM dev_dtx_gc.anthemreporting_seed.seed_quality_measures",
    "raw_code": "{{ config( alias = 'stg_seed_quality_measures', schema = 'staging') }}\r\n\r\nSELECT\r\n\tqmid,\r\n\tqmname,\r\n\tdecsription,\r\n\ttargetscore,\r\n\tmeasureid,\r\n\tcustommeasureid,\r\n\t-- Demo Report process \r\n\t{% if '_DEMO' in target.database %}\r\n    REPLACE(MEASURENAME,'CCQP ','') AS MEASURENAME,\r\n{% else %}\r\n\t\tmeasurename,\r\n\t{% endif %}\r\n\t-- Demo Report process \r\n\tgroup1score,\r\n\tgroup2score,\r\n\tgroup3score,\r\n\tgroup4score,\r\n\tgroup5score,\r\n\tqmsort,\r\n\tquintile_1,\r\n\tquintile_2,\r\n\tquintile_3,\r\n\tquintile_4,\r\n\tquintile_5,\r\n\tquintile_1_ma,\r\n\tquintile_2_ma,\r\n\tquintile_3_ma,\r\n\tquintile_4_ma,\r\n\tquintile_5_ma,\r\n\tqmweight,\r\n\tqmhoverdesc,\r\n\tqmshortdesc\r\nFROM {{ ref('seed_quality_measures') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_quality_measures",
    "description": "Quality metrics details with targets",
    "columns": {
      "QMID": {
        "name": "QMID",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "QMNAME": {
        "name": "QMNAME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DECSRIPTION": {
        "name": "DECSRIPTION",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "TARGETSCORE": {
        "name": "TARGETSCORE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "MEASURENAME": {
        "name": "MEASURENAME",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "GROUP1SCORE": {
        "name": "GROUP1SCORE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "GROUP2SCORE": {
        "name": "GROUP2SCORE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "GROUP3SCORE": {
        "name": "GROUP3SCORE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "GROUP4SCORE": {
        "name": "GROUP4SCORE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "GROUP5SCORE": {
        "name": "GROUP5SCORE",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_quality_measures"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_racevalueset",
    "name": "stg_seed_racevalueset",
    "original_file_path": "models\\staging\\seed\\stg_seed_racevalueset.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_racevalueset",
    "raw_code": "{{ config( alias = 'stg_seed_racevalueset', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_racevalueset') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_racevalueset",
    "description": "",
    "columns": {
      "CODE": {
        "name": "CODE",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "DESCRIPTION": {
        "name": "DESCRIPTION",
        "description": "",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_racevalueset"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_reconciliation_calculation",
    "name": "stg_seed_reconciliation_calculation",
    "original_file_path": "models\\staging\\seed\\stg_seed_reconciliation_calculation.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_reconciliation_calculation",
    "raw_code": "{{ config( alias = 'stg_seed_reconciliation_calculation', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_reconciliation_calculation') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_reconciliation_calculation",
    "description": "reconciliation calculation",
    "columns": {
      "ic_id": {
        "name": "ic_id",
        "description": "The primary key for this table",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      },
      "description": {
        "name": "description",
        "description": "Expecting a NOT NULL value, ideally",
        "meta": {},
        "data_type": null,
        "constraints": [],
        "quote": null,
        "config": {
          "meta": {},
          "tags": []
        },
        "tags": [],
        "granularity": null,
        "doc_blocks": []
      }
    },
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_reconciliation_calculation"
      ]
    }
  },
  {
    "node_id": "model.anthem_dev.stg_seed_reconpp2_name_tin_mapping",
    "name": "stg_seed_reconpp2_name_tin_mapping",
    "original_file_path": "models\\staging\\seed\\stg_seed_reconpp2_name_tin_mapping.sql",
    "compiled_code": "\n\nSELECT * FROM dev_dtx_gc.anthemreporting_seed.seed_recon_pp2_contractname_tinmap",
    "raw_code": "{{ config( alias = 'stg_seed_reconpp2_name_tin_mapping', schema = 'staging') }}\r\n\r\nSELECT * FROM {{ ref('seed_recon_pp2_contractname_tinmap') }}",
    "database": "dev_dtx_gc",
    "schema": "staging",
    "alias": "stg_seed_reconpp2_name_tin_mapping",
    "description": "",
    "columns": {},
    "tags": [],
    "depends_on": {
      "macros": [],
      "nodes": [
        "seed.anthem_dev.seed_recon_pp2_contractname_tinmap"
      ]
    }
  }
]