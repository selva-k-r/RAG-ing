<mxfile host="app.diagrams.net" modified="2024-11-20T00:00:00.000Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36" etag="POC_v0.2_Hierarchical_RAG" version="29.0.3" type="device">
  <diagram name="1. Main Search Flow with Smart Routing" id="main-search-flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- User Query Start -->
        <mxCell id="search-1" value="User Submits Query" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="40" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Load Preferences -->
        <mxCell id="search-2" value="Load User Preferences&#xa;(localStorage)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="140" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Activity Logger - Start Session -->
        <mxCell id="search-3" value="Log Search Event&#xa;(ActivityLogger)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="240" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Query Processing -->
        <mxCell id="search-4" value="Generate Query Embedding&#xa;(Azure OpenAI)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="340" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Hybrid Search -->
        <mxCell id="search-5" value="Hybrid Search&#xa;(Semantic + BM25)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="440" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Semantic Search Branch -->
        <mxCell id="search-6" value="Semantic Search&#xa;(ChromaDB)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b1ddf0;strokeColor=#10739e;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="280" y="560" width="160" height="50" as="geometry" />
        </mxCell>
        
        <!-- BM25 Search Branch -->
        <mxCell id="search-7" value="BM25 Search&#xa;(Keyword)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#b1ddf0;strokeColor=#10739e;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="720" y="560" width="160" height="50" as="geometry" />
        </mxCell>
        
        <!-- Merge Results -->
        <mxCell id="search-8" value="Merge Results&#xa;(Weighted: 0.6 semantic + 0.4 keyword)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="650" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Reranking -->
        <mxCell id="search-9" value="Rerank Results&#xa;(cross-encoder)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="750" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- LLM Generation -->
        <mxCell id="search-10" value="Generate Response&#xa;(Azure OpenAI GPT-4)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="850" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Log Results -->
        <mxCell id="search-11" value="Log Results + Response&#xa;(ActivityLogger)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="950" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Display to User -->
        <mxCell id="search-12" value="Display Results to User" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="1050" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Feedback Decision -->
        <mxCell id="search-13" value="User Provides&#xa;Feedback?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="505" y="1150" width="150" height="100" as="geometry" />
        </mxCell>
        
        <!-- Log Feedback -->
        <mxCell id="search-14" value="Log Feedback&#xa;(Positive/Negative)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="760" y="1170" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- End -->
        <mxCell id="search-15" value="End" style="ellipse;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1;fontColor=#333333" vertex="1" parent="1">
          <mxGeometry x="520" y="1290" width="120" height="60" as="geometry" />
        </mxCell>
        
        <!-- Arrows -->
        <mxCell id="arrow-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-1" target="search-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-2" target="search-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-3" target="search-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-4" target="search-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-5" target="search-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-5" target="search-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-6" target="search-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-7" target="search-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-8" target="search-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-9" target="search-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-10" target="search-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-11" target="search-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-12" target="search-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-13" target="search-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-14-label" value="Yes" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="arrow-14">
          <mxGeometry x="-0.2" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-13" target="search-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-15-label" value="No" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="arrow-15">
          <mxGeometry x="-0.2" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="search-14" target="search-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-1" value="User Interaction" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="legend-2" value="Preference/UI" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="130" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="legend-3" value="Activity Logging" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="180" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="legend-4" value="RAG Processing" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="230" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="legend-5" value="LLM Generation" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="280" width="140" height="40" as="geometry" />
        </mxCell>
        
        <!-- Version Info -->
        <mxCell id="version-info-1" value="PoC v0.2&#xa;Updated: Nov 2024&#xa;Version: 29.0.3" style="text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;fontFamily=Courier New;fontColor=#333333" vertex="1" parent="1">
          <mxGeometry x="1000" y="40" width="140" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  
  <diagram name="2. Document Ingestion + Duplicate Detection + Summary Extraction" id="ingestion-flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Start -->
        <mxCell id="ingest-1" value="Upload Document&#xa;(Confluence/Local)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="40" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Parse Document -->
        <mxCell id="ingest-2" value="Parse Document&#xa;(PDF/MD/HTML/TXT)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="140" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Extract Content -->
        <mxCell id="ingest-3" value="Extract Text Content" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="240" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Stage 1: Exact Duplicate Check -->
        <mxCell id="ingest-4" value="Stage 1: Exact Duplicate?&#xa;(SHA256 Hash Check)" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="455" y="340" width="250" height="100" as="geometry" />
        </mxCell>
        
        <!-- Skip if Exact Duplicate -->
        <mxCell id="ingest-5" value="Skip Document&#xa;(Already Exists)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="800" y="360" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- Store Hash -->
        <mxCell id="ingest-6" value="Store Document Hash&#xa;(document_hashes.db)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="480" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Chunk Document -->
        <mxCell id="ingest-7" value="Chunk Document&#xa;(1200 tokens, 100 overlap)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="580" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Stage 2: Fuzzy Duplicate Loop -->
        <mxCell id="ingest-8" value="For Each Chunk" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="680" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Stage 2: Fuzzy Check -->
        <mxCell id="ingest-9" value="Stage 2: Fuzzy Duplicate?&#xa;(95% similarity threshold)" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="455" y="780" width="250" height="100" as="geometry" />
        </mxCell>
        
        <!-- Skip Fuzzy Duplicate -->
        <mxCell id="ingest-10" value="Skip Chunk&#xa;(Near-Duplicate)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="800" y="800" width="140" height="60" as="geometry" />
        </mxCell>
        
        <!-- Generate Embedding -->
        <mxCell id="ingest-11" value="Generate Embedding&#xa;(Azure OpenAI ada-002)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="920" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Stage 3: Semantic Duplicate -->
        <mxCell id="ingest-12" value="Stage 3: Semantic Duplicate?&#xa;(98% embedding similarity)" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="455" y="1020" width="250" height="100" as="geometry" />
        </mxCell>
        
        <!-- Skip Semantic Duplicate -->
        <mxCell id="ingest-13" value="Skip Chunk&#xa;(Semantic Duplicate)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="800" y="1040" width="140" height="60" as="geometry" />
        </mxCell>
        
        <!-- Store in ChromaDB -->
        <mxCell id="ingest-14" value="Store in Vector DB&#xa;(ChromaDB)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="1160" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- More Chunks? -->
        <mxCell id="ingest-15" value="More Chunks?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="505" y="1260" width="150" height="80" as="geometry" />
        </mxCell>
        
        <!-- Log Activity -->
        <mxCell id="ingest-16" value="Log Ingestion Activity&#xa;(document count, time)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="1380" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- End -->
        <mxCell id="ingest-17" value="Ingestion Complete" style="ellipse;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1;fontColor=#333333" vertex="1" parent="1">
          <mxGeometry x="495" y="1480" width="170" height="60" as="geometry" />
        </mxCell>
        
        <!-- Arrows -->
        <mxCell id="ingest-arrow-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-1" target="ingest-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-2" target="ingest-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-3" target="ingest-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-4" target="ingest-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-4-label" value="Yes (Duplicate)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="ingest-arrow-4">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-4" target="ingest-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-5-label" value="No (New)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="ingest-arrow-5">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-6" target="ingest-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-7" target="ingest-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-8" target="ingest-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-9" target="ingest-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-9-label" value="Yes" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="ingest-arrow-9">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-9" target="ingest-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-10-label" value="No" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="ingest-arrow-10">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-11" target="ingest-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-12" target="ingest-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-12-label" value="Yes" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="ingest-arrow-12">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-12" target="ingest-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-13-label" value="No" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="ingest-arrow-13">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-14" target="ingest-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-15" target="ingest-8">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="420" y="1300" />
              <mxPoint x="420" y="710" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-15-label" value="Yes" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="ingest-arrow-15">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-15" target="ingest-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ingest-arrow-16-label" value="No" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="ingest-arrow-16">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ingest-arrow-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="ingest-16" target="ingest-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Side annotations -->
        <mxCell id="ingest-note-1" value="3 Stages of&#xa;Duplicate Detection" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="640" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="ingest-note-2" value="Stage 1: Exact Match&#xa;(Document level)" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="360" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ingest-note-3" value="Stage 2: Fuzzy Match&#xa;(Chunk level - 95%)" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="805" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ingest-note-4" value="Stage 3: Semantic&#xa;(Embedding - 98%)" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="1045" width="140" height="50" as="geometry" />
        </mxCell>
        
        <!-- Version Info -->
        <mxCell id="version-info-2" value="PoC v0.2 - Week 1&#xa;Summary Extraction: gpt-4o-mini&#xa;Cost: $0.003/doc&#xa;Version: 29.0.3" style="text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;fontFamily=Courier New;fontColor=#333333" vertex="1" parent="1">
          <mxGeometry x="1000" y="40" width="160" height="80" as="geometry" />
        </mxCell>
        
        <!-- Note about Summary -->
        <mxCell id="ingest-note-5" value="NEW: After chunking&#xa;Extract summary + tags&#xa;Single LLM call&#xa;Store in doc_summaries" style="text;html=1;strokeColor=#82b366;fillColor=#d5e8d4;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="40" y="1120" width="140" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  
  <diagram name="3. Activity Logging Architecture" id="logging-flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="log-title" value="Activity Logging Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="350" height="40" as="geometry" />
        </mxCell>
        
        <!-- User Actions -->
        <mxCell id="log-1" value="User Actions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="140" y="100" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- Search Query -->
        <mxCell id="log-2" value="Search Query" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="140" y="200" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Feedback -->
        <mxCell id="log-3" value="Feedback&#xa;(ðŸ‘/ðŸ‘Ž)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="140" y="260" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Source Click -->
        <mxCell id="log-4" value="Source Click" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="140" y="320" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Session -->
        <mxCell id="log-5" value="Session Start/End" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="140" y="380" width="120" height="40" as="geometry" />
        </mxCell>
        
        <!-- Activity Logger -->
        <mxCell id="log-6" value="ActivityLogger" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="240" width="160" height="80" as="geometry" />
        </mxCell>
        
        <!-- Event Schema -->
        <mxCell id="log-7" value="Event Schema" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="700" y="100" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- Schema Fields -->
        <mxCell id="log-8" value="â€¢ event_id (UUID)&#xa;â€¢ timestamp&#xa;â€¢ session_id&#xa;â€¢ event_type&#xa;â€¢ query details&#xa;â€¢ results metadata&#xa;â€¢ response text&#xa;â€¢ feedback&#xa;â€¢ context" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="700" y="180" width="160" height="180" as="geometry" />
        </mxCell>
        
        <!-- JSONL Storage -->
        <mxCell id="log-9" value="JSONL Storage" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="420" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- Daily Files -->
        <mxCell id="log-10" value="./logs/user_activity/&#xa;2025-01-15.jsonl" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;fontFamily=Courier New;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="510" width="160" height="50" as="geometry" />
        </mxCell>
        
        <!-- Analysis -->
        <mxCell id="log-11" value="Analysis &amp; Fine-tuning" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="650" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- Use Cases -->
        <mxCell id="log-12" value="Use Cases" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="100" y="500" width="100" height="30" as="geometry" />
        </mxCell>
        
        <!-- Use Case 1 -->
        <mxCell id="log-13" value="ðŸ“Š Search Quality Metrics" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="100" y="540" width="180" height="35" as="geometry" />
        </mxCell>
        
        <!-- Use Case 2 -->
        <mxCell id="log-14" value="ðŸŽ¯ Fine-tuning Data Prep" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="100" y="585" width="180" height="35" as="geometry" />
        </mxCell>
        
        <!-- Use Case 3 -->
        <mxCell id="log-15" value="ðŸ” User Behavior Analysis" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="100" y="630" width="180" height="35" as="geometry" />
        </mxCell>
        
        <!-- Use Case 4 -->
        <mxCell id="log-16" value="âš¡ Performance Monitoring" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="100" y="675" width="180" height="35" as="geometry" />
        </mxCell>
        
        <!-- Arrows -->
        <mxCell id="log-arrow-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="log-2" target="log-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="log-arrow-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="log-3" target="log-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="log-arrow-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="log-4" target="log-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="log-arrow-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="log-5" target="log-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="log-arrow-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="log-6" target="log-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="log-arrow-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="log-9" target="log-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="log-arrow-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="log-10" target="log-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="log-arrow-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1" edge="1" parent="1" source="log-6" target="log-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="log-arrow-8-label" value="uses" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="log-arrow-8">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- Metrics Box -->
        <mxCell id="log-metrics" value="Key Metrics Tracked" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1;align=center;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="700" y="420" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="log-metrics-list" value="â€¢ Search success rate&#xa;â€¢ Avg response time&#xa;â€¢ Source relevance&#xa;â€¢ Repeat searches&#xa;â€¢ Feedback ratio&#xa;â€¢ Token usage" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="700" y="470" width="160" height="120" as="geometry" />
        </mxCell>
        
        <!-- Version Info -->
        <mxCell id="version-info-3" value="PoC v0.2 - Week 2&#xa;JSONL Format&#xa;Retention: 90 days&#xa;Version: 29.0.3" style="text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;fontFamily=Courier New;fontColor=#333333" vertex="1" parent="1">
          <mxGeometry x="900" y="40" width="160" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  
  <diagram name="4. Vector Database Storage Architecture" id="vector-storage-flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="vec-title" value="Vector Database: 2-Collection Architecture (Summaries + Chunks)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="200" y="20" width="750" height="40" as="geometry" />
        </mxCell>
        
        <!-- LEFT SIDE: STORAGE FLOW -->
        <mxCell id="vec-storage-title" value="STORAGE PROCESS" style="text;html=1;strokeColor=#82b366;fillColor=#d5e8d4;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="280" height="40" as="geometry" />
        </mxCell>
        
        <!-- Document Input -->
        <mxCell id="vec-1" value="Document Chunks&#xa;(After Processing)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="80" y="150" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Generate Embeddings -->
        <mxCell id="vec-2" value="Generate Embeddings&#xa;Azure OpenAI ada-002&#xa;(1536 dimensions)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="80" y="240" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Prepare Metadata -->
        <mxCell id="vec-3" value="Prepare Metadata&#xa;â€¢ source&#xa;â€¢ title&#xa;â€¢ chunk_id&#xa;â€¢ timestamp&#xa;â€¢ doc_hash" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="80" y="340" width="200" height="100" as="geometry" />
        </mxCell>
        
        <!-- ChromaDB Collection -->
        <mxCell id="vec-4" value="ChromaDB Collection&#xa;&quot;rag_documents&quot;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="95" y="480" width="170" height="80" as="geometry" />
        </mxCell>
        
        <!-- Storage Success -->
        <mxCell id="vec-5" value="âœ“ Stored Successfully" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="100" y="600" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- CENTER: VECTOR DATABASE -->
        <mxCell id="vec-db-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;opacity=30;" vertex="1" parent="1">
          <mxGeometry x="380" y="120" width="300" height="560" as="geometry" />
        </mxCell>
        
        <mxCell id="vec-db-title" value="ChromaDB Vector Store" style="text;html=1;strokeColor=#9673a6;fillColor=#e1d5e7;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="140" width="220" height="40" as="geometry" />
        </mxCell>
        
        <!-- Vector Index -->
        <mxCell id="vec-db-1" value="Vector Index&#xa;(HNSW Algorithm)&#xa;Fast similarity search" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="200" width="220" height="70" as="geometry" />
        </mxCell>
        
        <!-- Embeddings Storage -->
        <mxCell id="vec-db-2" value="Embeddings Storage&#xa;1536-dimensional vectors&#xa;Normalized &amp; Indexed" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="290" width="220" height="70" as="geometry" />
        </mxCell>
        
        <!-- Metadata Store -->
        <mxCell id="vec-db-3" value="Metadata Store&#xa;Document info&#xa;Source tracking&#xa;Timestamps" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="380" width="220" height="70" as="geometry" />
        </mxCell>
        
        <!-- SQLite Backend -->
        <mxCell id="vec-db-4" value="SQLite Backend&#xa;./vector_store/chroma.sqlite3&#xa;Persistent storage" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;fontFamily=Courier New;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="470" width="220" height="60" as="geometry" />
        </mxCell>
        
        <!-- Statistics -->
        <mxCell id="vec-db-5" value="Collection Stats&#xa;â€¢ Total chunks: N&#xa;â€¢ Avg vector size: 1536&#xa;â€¢ Index type: HNSW&#xa;â€¢ Distance: Cosine" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=9;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="420" y="550" width="220" height="100" as="geometry" />
        </mxCell>
        
        <!-- RIGHT SIDE: RETRIEVAL FLOW -->
        <mxCell id="vec-retrieval-title" value="RETRIEVAL PROCESS" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="760" y="80" width="280" height="40" as="geometry" />
        </mxCell>
        
        <!-- User Query -->
        <mxCell id="vec-6" value="User Query&#xa;&quot;How to configure FHIR?&quot;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="800" y="150" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Query Embedding -->
        <mxCell id="vec-7" value="Generate Query Embedding&#xa;Azure OpenAI ada-002&#xa;(1536 dimensions)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="800" y="240" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Similarity Search -->
        <mxCell id="vec-8" value="Similarity Search&#xa;Cosine Distance&#xa;Top K = 20" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="800" y="340" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Filter by Metadata -->
        <mxCell id="vec-9" value="Filter by Metadata&#xa;â€¢ Source type&#xa;â€¢ Date range&#xa;â€¢ Document type" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="800" y="440" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Return Results -->
        <mxCell id="vec-10" value="Return Ranked Results&#xa;with Metadata&#xa;&amp; Relevance Scores" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="800" y="540" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Retrieval Success -->
        <mxCell id="vec-11" value="âœ“ Results Retrieved" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="820" y="640" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- ARROWS - Storage Flow -->
        <mxCell id="vec-arrow-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#6c8ebf" edge="1" parent="1" source="vec-1" target="vec-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#6c8ebf" edge="1" parent="1" source="vec-2" target="vec-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#82b366" edge="1" parent="1" source="vec-3" target="vec-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#82b366" edge="1" parent="1" source="vec-4" target="vec-5">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="180" y="570" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- ARROWS - Storage to DB -->
        <mxCell id="vec-arrow-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#9673a6;dashed=1" edge="1" parent="1" source="vec-4" target="vec-db-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-5-label" value="Write" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#000000" vertex="1" connectable="0" parent="vec-arrow-5">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- ARROWS - Retrieval Flow -->
        <mxCell id="vec-arrow-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#6c8ebf" edge="1" parent="1" source="vec-6" target="vec-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#6c8ebf" edge="1" parent="1" source="vec-7" target="vec-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#b85450" edge="1" parent="1" source="vec-8" target="vec-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#82b366" edge="1" parent="1" source="vec-9" target="vec-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#82b366" edge="1" parent="1" source="vec-10" target="vec-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- ARROWS - DB to Retrieval -->
        <mxCell id="vec-arrow-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#9673a6;dashed=1" edge="1" parent="1" source="vec-db-1" target="vec-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-11-label" value="Search" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#000000" vertex="1" connectable="0" parent="vec-arrow-11">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="vec-arrow-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#9673a6;dashed=1" edge="1" parent="1" source="vec-db-3" target="vec-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vec-arrow-12-label" value="Filter" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#000000" vertex="1" connectable="0" parent="vec-arrow-12">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- BOTTOM: Key Features -->
        <mxCell id="vec-features-title" value="Vector Database Features" style="text;html=1;strokeColor=#9673a6;fillColor=#e1d5e7;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="80" y="720" width="920" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="vec-feature-1" value="âš¡ Fast Similarity Search&#xa;HNSW algorithm for O(log n) search" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="80" y="760" width="210" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="vec-feature-2" value="ðŸ’¾ Persistent Storage&#xa;SQLite backend with atomic writes" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="310" y="760" width="210" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="vec-feature-3" value="ðŸ” Metadata Filtering&#xa;Filter by source, date, type" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="540" y="760" width="210" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="vec-feature-4" value="ðŸ“Š Collection Management&#xa;Multiple collections, easy CRUD" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="770" y="760" width="210" height="50" as="geometry" />
        </mxCell>
        
        <!-- Version Info -->
        <mxCell id="version-info-4" value="ChromaDB 1.3.4+&#xa;Collections: 2&#xa;- doc_summaries (NEW)&#xa;- doc_chunks&#xa;Version: 29.0.3" style="text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;fontFamily=Courier New;fontColor=#333333" vertex="1" parent="1">
          <mxGeometry x="1000" y="40" width="160" height="90" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  
  <diagram name="5. Hierarchical Storage &amp; Retrieval (Simple 2-Level)" id="hierarchical-flow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="hier-title" value="Simple 2-Level Hierarchical Architecture (PoC v0.2)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="280" y="20" width="600" height="40" as="geometry" />
        </mxCell>
        
        <!-- LEFT: STORAGE WITH HIERARCHY -->
        <mxCell id="hier-storage-title" value="HIERARCHICAL STORAGE" style="text;html=1;strokeColor=#82b366;fillColor=#d5e8d4;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="420" height="40" as="geometry" />
        </mxCell>
        
        <!-- Document Input -->
        <mxCell id="hier-1" value="Document Upload" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="150" width="180" height="50" as="geometry" />
        </mxCell>
        
        <!-- LLM Processing -->
        <mxCell id="hier-2" value="LLM Analysis&#xa;(Extract Structure)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="250" y="150" width="180" height="50" as="geometry" />
        </mxCell>
        
        <!-- Level 0: Summary -->
        <mxCell id="hier-3" value="Level 0: Document Summary&#xa;â€¢ Title&#xa;â€¢ High-level summary&#xa;â€¢ Key points (3-5)&#xa;â€¢ Tags/Keywords" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="40" y="240" width="180" height="100" as="geometry" />
        </mxCell>
        
        <!-- Level 1: Sections -->
        <mxCell id="hier-4" value="Level 1: Sections&#xa;â€¢ Section titles&#xa;â€¢ Section summaries&#xa;â€¢ Key concepts&#xa;â€¢ Links to parent doc" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="40" y="360" width="180" height="100" as="geometry" />
        </mxCell>
        
        <!-- Level 2: Chunks -->
        <mxCell id="hier-5" value="Level 2: Detail Chunks&#xa;â€¢ Granular content&#xa;â€¢ 1200 tokens each&#xa;â€¢ Parent context&#xa;â€¢ Position tracking" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="40" y="480" width="180" height="100" as="geometry" />
        </mxCell>
        
        <!-- Tags Collection -->
        <mxCell id="hier-6" value="Tags &amp; Entities&#xa;â€¢ Domain tags&#xa;â€¢ Named entities&#xa;â€¢ Concepts&#xa;â€¢ Relationships" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;align=left;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="250" y="240" width="180" height="100" as="geometry" />
        </mxCell>
        
        <!-- ChromaDB Collections -->
        <mxCell id="hier-7" value="ChromaDB: 4 Collections" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="115" y="620" width="140" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-8" value="doc_summaries&#xa;doc_sections&#xa;doc_chunks&#xa;doc_tags" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontFamily=Courier New;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="275" y="640" width="100" height="60" as="geometry" />
        </mxCell>
        
        <!-- RIGHT: INTELLIGENT RETRIEVAL -->
        <mxCell id="hier-retrieval-title" value="INTELLIGENT RETRIEVAL" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=14;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="540" y="80" width="580" height="40" as="geometry" />
        </mxCell>
        
        <!-- Query Input -->
        <mxCell id="hier-9" value="User Query" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="740" y="150" width="180" height="50" as="geometry" />
        </mxCell>
        
        <!-- Query Classification -->
        <mxCell id="hier-10" value="Query Classification&#xa;Determine Depth Needed" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="730" y="240" width="200" height="100" as="geometry" />
        </mxCell>
        
        <!-- Summary Query Path -->
        <mxCell id="hier-11" value="SUMMARY Query&#xa;&quot;What is...?&quot;&#xa;&quot;Overview of...?&quot;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;fontColor=#000000;align=left" vertex="1" parent="1">
          <mxGeometry x="540" y="380" width="150" height="70" as="geometry" />
        </mxCell>
        
        <!-- Detailed Query Path -->
        <mxCell id="hier-12" value="DETAILED Query&#xa;&quot;How to...?&quot;&#xa;&quot;Configure...?&quot;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;fontColor=#000000;align=left" vertex="1" parent="1">
          <mxGeometry x="730" y="380" width="150" height="70" as="geometry" />
        </mxCell>
        
        <!-- Deep Query Path -->
        <mxCell id="hier-13" value="DEEP Query&#xa;&quot;Troubleshoot...?&quot;&#xa;&quot;Why error...?&quot;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;fontColor=#000000;align=left" vertex="1" parent="1">
          <mxGeometry x="920" y="380" width="150" height="70" as="geometry" />
        </mxCell>
        
        <!-- Search Level 0 -->
        <mxCell id="hier-14" value="Search Level 0&#xa;(Summaries Only)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="540" y="480" width="150" height="50" as="geometry" />
        </mxCell>
        
        <!-- Search Level 0+1 -->
        <mxCell id="hier-15" value="Search Level 0+1&#xa;(Summary + Sections)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="730" y="480" width="150" height="50" as="geometry" />
        </mxCell>
        
        <!-- Search All Levels -->
        <mxCell id="hier-16" value="Search All Levels&#xa;(Complete Context)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="920" y="480" width="150" height="50" as="geometry" />
        </mxCell>
        
        <!-- Context Assembly -->
        <mxCell id="hier-17" value="Assemble Context&#xa;(Hierarchical Navigation)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="715" y="570" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- LLM Response -->
        <mxCell id="hier-18" value="Generate Response&#xa;(Adaptive Token Usage)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="715" y="660" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- ARROWS - Storage Flow -->
        <mxCell id="hier-arrow-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#6c8ebf" edge="1" parent="1" source="hier-1" target="hier-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#d79b00" edge="1" parent="1" source="hier-2" target="hier-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hier-arrow-2-label" value="Extract" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#000000" vertex="1" connectable="0" parent="hier-arrow-2">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="hier-arrow-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#d6b656" edge="1" parent="1" source="hier-3" target="hier-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#d6b656" edge="1" parent="1" source="hier-4" target="hier-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#9673a6;dashed=1" edge="1" parent="1" source="hier-2" target="hier-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hier-arrow-5-label" value="Extract" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#000000" vertex="1" connectable="0" parent="hier-arrow-5">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="hier-arrow-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;strokeWidth=2;strokeColor=#82b366" edge="1" parent="1" source="hier-5" target="hier-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- ARROWS - Retrieval Flow -->
        <mxCell id="hier-arrow-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#82b366" edge="1" parent="1" source="hier-9" target="hier-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#d79b00" edge="1" parent="1" source="hier-10" target="hier-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hier-arrow-8-label" value="Simple" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#000000" vertex="1" connectable="0" parent="hier-arrow-8">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="hier-arrow-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#d6b656" edge="1" parent="1" source="hier-10" target="hier-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hier-arrow-9-label" value="How-to" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#000000" vertex="1" connectable="0" parent="hier-arrow-9">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="hier-arrow-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#b85450" edge="1" parent="1" source="hier-10" target="hier-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hier-arrow-10-label" value="Complex" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=9;fontColor=#000000" vertex="1" connectable="0" parent="hier-arrow-10">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="hier-arrow-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#d79b00" edge="1" parent="1" source="hier-11" target="hier-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#d6b656" edge="1" parent="1" source="hier-12" target="hier-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#b85450" edge="1" parent="1" source="hier-13" target="hier-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#6c8ebf" edge="1" parent="1" source="hier-14" target="hier-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#6c8ebf" edge="1" parent="1" source="hier-15" target="hier-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#6c8ebf" edge="1" parent="1" source="hier-16" target="hier-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-arrow-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;strokeColor=#b85450" edge="1" parent="1" source="hier-17" target="hier-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- BOTTOM: Benefits -->
        <mxCell id="hier-benefits" value="Key Benefits" style="text;html=1;strokeColor=#82b366;fillColor=#d5e8d4;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=12;fontStyle=1;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="740" width="1080" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-benefit-1" value="âš¡ 3-5x Faster&#xa;Search summaries first" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="40" y="780" width="200" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-benefit-2" value="ðŸ’° 40% Token Savings&#xa;Adaptive context size" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="260" y="780" width="200" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-benefit-3" value="ðŸŽ¯ Better Accuracy&#xa;Context-aware matching" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="480" y="780" width="200" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-benefit-4" value="ðŸ” Smart Navigation&#xa;Drill-down from high-level" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="700" y="780" width="200" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="hier-benefit-5" value="ðŸ“Š Better UX&#xa;Quick answers, optional depth" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;fontColor=#000000" vertex="1" parent="1">
          <mxGeometry x="920" y="780" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- Implementation Info Box -->
        <mxCell id="hier-info" value="PoC v0.2 Implementation&#xa;Timeline: Dec 2024 - Jan 2025&#xa;Cost: $3 initial / $20 annual&#xa;Version: 29.0.3" style="text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=9;fontFamily=Courier New;fontColor=#333333" vertex="1" parent="1">
          <mxGeometry x="1000" y="20" width="160" height="70" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

